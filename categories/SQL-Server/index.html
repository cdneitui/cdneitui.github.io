<!doctype html>
<html lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=11,IE=10,IE=9,IE=8">
    <meta name="baidu-site-verification" content="dIcXMeY8Ya">
    
    <title>`SQL Server`分类下的文章 | 软件开发吧</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
    <meta name="keywords" content="Jelon, 前端, Web, 张德龙, 前端开发">
    <meta name="description" content="Jelon个人前端小站">

    
    <link rel="alternative" href="/atom.xml" title="软件开发吧" type="application/atom+xml">
    
    
    <link rel="shortcut icon" href="/favicon.ico">
    
    <link rel="stylesheet" href="/css/style.css">
    <!--[if lt IE 9]>
    <script src="/js/html5.js"></script>
    <![endif]-->
    
<script>
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "//hm.baidu.com/hm.js?fd459238242776d173cdc64918fb32f2";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>


</head>
</html>
<body class="home">
    <!--[if lt IE 9]>
    <div class="browsehappy">
        当前网页 <strong>不支持</strong>
        你正在使用的浏览器. 为了正常的访问, 请 <a href="http://browsehappy.com/">升级你的浏览器</a>.
    </div>
    <![endif]-->

    <!-- 博客头部 -->
    <header class="header">
    <section class="container header-main">
        <div class="logo">
            <a href="/">
                <div class="cover">
                    <span class="name">软件开发吧</span>
                    <span class="description"></span>
                </div>
            </a>
        </div>
        <div class="dropnav icon-paragraph-justify" id="JELON__btnDropNav"></div>
        <ul class="menu hidden" id="JELON__menu">
            
            <li rel="/categories/SQL-Server/index.html" class="item ">
                <a href="/" title="首页" class="icon-home">&nbsp;首页</a>
            </li>
            
            <li rel="/categories/SQL-Server/index.html" class="item ">
                <a href="/lab/" title="实验室" class="icon-lab">&nbsp;实验室</a>
            </li>
            
            <li rel="/categories/SQL-Server/index.html" class="item ">
                <a href="/about/" title="关于" class="icon-about">&nbsp;关于</a>
            </li>
            
            <li rel="/categories/SQL-Server/index.html" class="item ">
                <a href="/comment/" title="留言" class="icon-comment">&nbsp;留言</a>
            </li>
            
        </ul>
        <div class="profile clearfix">
            <div class="feeds fl">
                
                
                <p class="links">
                    
                        <a href="https://github.com/jangdelong" target="_blank">Github</a>
                        |
                    
                        <a href="https://pages.coding.me" target="_blank">Hosted by Coding Pages</a>
                        
                    
                </p>
                <p class="sns">
                    
                        <a href="http://weibo.com/jangdelong" class="sinaweibo" target="_blank"><b>■</b> 新浪微博</a>
                    
                        <a href="https://www.facebook.com/profile.php?id=100011855760219&amp;ref=bookmarks" class="qqweibo" target="_blank"><b>■</b> Facebook</a>
                    
                    <a href="javascript: void(0);" class="wechat">
                        <b>■</b>
                        公众号
                        <span class="popover">
                            <img src="/img/wechat_mp.jpg" width="120" height="120" alt="我的微信订阅号">
                            <i class="arrow"></i>
                        </span>
                    </a>
                </p>
                
            </div>
            <div class="avatar fr">
                <img src="/img/jelon.jpg" alt="avatar" title="Jelon">
            </div>
        </div>
    </section>
</header>


    <!-- 博客正文 -->
    <div class="container body clearfix">
        <section class="content">
            <div class="content-main widget">
                <!-- 文章分类 -->

    <h3 class="widget-hd">
        <strong>
            
                `SQL Server`分类下的文章
            
        </strong>
    </h3>
    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/SQL-Server/">SQL Server</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2016/02/17/2019030500169/">
    		sqlserver计算时间差DATEDIFF 函数
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2016-02-17T07:32:05.000Z">2016-02-17</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/sqlserver/" title="sqlserver">sqlserver</a> / 
    
        <a href="/tags/DATEDIFF/" title="DATEDIFF">DATEDIFF</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <p>DATEDIFF 函数 [日期和时间] 功能 返回两个日期之间的间隔。 语法 <strong>DATEDIFF ( date-part, date-expression-1, date-expression-2 )</strong> <strong>date-part :</strong> year | quarter | month | week | day | hour | minute | second | millisecond 参数 <strong>date-part</strong> 指定要测量其间隔的日期部分。 有关日期部分的详细信息，请参见日期部分。 <strong>date-expression-1</strong> 某一间隔的起始日期。从 date-expression-2 中减去该值，返回两个参数之间 date-parts 的天数。 <strong>date-expression-2</strong> 某一间隔的结束日期。从该值中减去 Date-expression-1，返回两个参数之间 date-parts 的天数。 用法 此函数计算两个指定日期之间日期部分的数目。结果为日期部分中等于（date2 - date1）的有符号的整数值。 当结果不是日期部分的偶数倍时，DATEDIFF 将被截断而不是被舍入。 当使用 day 作为日期部分时，DATEDIFF 返回两个指定的时间之间（包括第二个日期但不包括第一个日期）的午夜数。 当使用 month 作为日期部分时，DATEDIFF 返回两个日期之间（包括第二个日期但不包括第一个日期）出现的月的第一天的数目。 当使用 week 作为日期部分时，DATEDIFF 返回两个日期（包括第二个日期但不包括第一个日期）之间星期日的数目。 对于更小的时间单位存在溢出值： milliseconds 24 天 seconds 68 年 minutes 4083 年 others 没有溢出限制 如果超出这些限制，此函数将返回溢出错误。 标准和兼容性 SQL/92 Transact-SQL 扩展。 SQL/99 Transact-SQL 扩展。 Sybase 与 Adaptive Server Enterprise 兼容。 下面示例的语句返回 1： SELECT datediff( hour, ‘4:00AM’, ‘5:50AM’ )下面的语句返回 102： SELECT datediff( month, ‘1987/05/02’, ‘1995/11/15’ )下面的语句返回 0： SELECT datediff( day, ‘00:00’, ‘23:59’ )下面的语句返回 4： SELECT datediff( day,’1999/07/19 00:00’,’1999/07/23 23:59’ )下面的语句返回 0： SELECT datediff( month, ‘1999/07/19’, ‘1999/07/23’ )下面的语句返回 1： SELECT datediff( month, ‘1999/07/19’, ‘1999/08/23’ )</p>

            
            <p class="more">
                <a href="/2016/02/17/2019030500169/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2016/02/17/2019030500169/" title="sqlserver计算时间差DATEDIFF 函数">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/7.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/SQL-Server/">SQL Server</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2015/09/16/2019030500032/">
    		数据库连接字符串的困惑
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2015-09-16T07:25:03.000Z">2015-09-16</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/CentOS6-5/" title="CentOS6.5">CentOS6.5</a> / 
    
        <a href="/tags/Hello-World/" title="Hello World">Hello World</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <h1 id="程序员方阵"><a href="#程序员方阵" class="headerlink" title="程序员方阵"></a>程序员方阵</h1><p>说起Hello World，不由得想起最近的抗战胜利70周年阅兵；网络中走来的程序员方阵。 现在向我们走来的是程序员方阵！ 他们穿着拖鞋，披着毛巾， 左手拿着键盘，右手举着鼠标， 腋下夹着USB转换器。 他们因睡眠不足而显得精神不振， 喊着微弱的口号走过主席台。 主席问候：程序员们辛苦了! 程序员方队异口同声地答道：Hello World！ 习大大的讲话很给力：让我们共同铭记历史所启示的伟大真理：正义必胜！和平必胜！人民必胜！</p>
<h1 id="数据库连接字符串的困惑"><a href="#数据库连接字符串的困惑" class="headerlink" title="数据库连接字符串的困惑"></a>数据库连接字符串的困惑</h1><p>通常来说，第一个Hello World程序是无压力的，个别开发环境安装、配置起来可能比较吃力，就像前段时间Visual Studio推出Linux版本，我基于CentOS6.5安装，结果需要升级GCC的版本，研究了半天也没搞定！ 我最初学习的是VB.NET，学习网页后台开发，照着书中的例子学习的也还算顺利；但到学习数据库的时候就卡住了，当时是连接的ACCESS数据库，具体遇到的错误已经不记得了，只大概的记得这问题搞了一两个月也没搞出来！当时是2003年左右，网络上能找到的东西也非常有限，不像现在一搜一大把的资料源码之类的；当时应该有一些知名的论坛了，不过那时候人比较傻，也不知道去找论坛发帖；当时访问Google还不用翻墙呢，不过英文也不好，也没想到去外面看看！ 实在研究不通了，就放下了，先去研究点别的；过了大概一个多月吧，又回过头来研究，结果很快搞通过了，连接数据库成功了，突然觉得豁然开朗！</p>
<h1 id="数据库连接字符串的组成"><a href="#数据库连接字符串的组成" class="headerlink" title="数据库连接字符串的组成"></a>数据库连接字符串的组成</h1><p>连接字符串的是一个以分号为界，划分键值参数对的列表。</p>
<h2 id="驱动程序"><a href="#驱动程序" class="headerlink" title="驱动程序"></a>驱动程序</h2><p>之所以可以通过一个字符串连接并操作数据库，是因为有驱动程序的支持。 <strong>常见的驱动程序如下：</strong></p>
<h3 id="ODBC"><a href="#ODBC" class="headerlink" title="ODBC"></a>ODBC</h3><p>ODBC(Open Database Connectivity，开放数据库互连)是微软公司开放服务结构(WOSA,Windows Open Services Architecture)中有关数据库的一个组成部分，它建立了一组规范，并提供了一组对数据库访问的标准API（应用程序编程接口）。这些API利用SQL来完成其大部分任务。ODBC本身也提供了对SQL语言的支持，用户可以直接将SQL语句送给ODBC。</p>
<h3 id="OLE-DB"><a href="#OLE-DB" class="headerlink" title="OLE DB"></a>OLE DB</h3><p>OLE DB 是 Microsoft 的一个战略性系统级编程接口，用于管理整个组织内的数据。OLE DB 是建立在 ODBC 功能之上的一个开放规范。ODBC 是为访问关系型数据库而专门开发的，OLE DB 则用于访问关系型和非关系型信息源，例如主机 ISAM/VSAM 和层次数据库，电子邮件和文件系统存储，文本、图形和地理数据以及自定义业务对象。OLE DB 定义了一组 COM 接口，对各种数据库管理系统服务进行封装，并允许创建软件组件，实现这些服务。OLE DB 组件包括数据提供程序（包含和表现数据）、数据使用者（使用数据）和服务组件（处理和传送数据，例如，查询处理器和游标引擎）。OLE DB 接口有助于平滑地集成组件，这样，OLE DB 组件厂商就可以快速地向市场提供高质量 OLE DB 组件。此外，OLE DB 包含了一个连接 ODBC 的“桥梁”，对现用的各种 ODBC 关系型数据库驱动程序提供一贯的支持。</p>
<h3 id="JDBC"><a href="#JDBC" class="headerlink" title="JDBC"></a>JDBC</h3><p>JDBC（Java Data Base Connectivity,java数据库连接）是一种用于执行SQL语句的Java API，可以为多种关系数据库提供统一访问，它由一组用Java语言编写的类和接口组成。JDBC提供了一种基准，据此可以构建更高级的工具和接口，使数据库开发人员能够编写数据库应用程序，同时，JDBC也是个商标名。</p>
<h2 id="比较"><a href="#比较" class="headerlink" title="比较"></a>比较</h2><p>目前，Microsoft 的 ODBC API 可能是使用最广的、用于访问关系数据库的编程接口。它能在几乎所有平台上连接几乎所有的数据库。为什么 Java 不使用 ODBC？对这个问题的回答是：Java 可以使用 ODBC，但最好是在 JDBC 的帮助下以JDBC-ODBC桥的形式使用，这一点我们稍后再说。现在的问题已变成：”为什么需要 JDBC”？答案是显然的：ODBC 不适合直接在 Java 中使用，因为它使用 C 语言接口。从Java 调用本地 C代码在安全性、实现、坚固性和程序的自动移植性方面都有许多缺点。从 ODBC C API 到 Java API 的字面翻译是不可取的。例如，Java 没有指针，而 ODBC 却对指针用得很广泛（包括很容易出错的指针”void *”）。您可以将 JDBC 想象成被转换为面向对象接口的 ODBC，而面向对象的接口对 Java程序员来说较易于接受。 ODBC 很难学。它把简单和高级功能混在一起，而且即使对于简单的查询，其选项也极为复杂。相反，JDBC 尽量保证简单功能的简便性，而同时在必要时允许使用高级功能。启用”纯 Java “机制需要象 JDBC 这样的 Java API。如果使用ODBC，就必须手动地将 ODBC 驱动程序管理器和驱动程序安装在每台客户机上。如果完全用 Java 编写 JDBC 驱动程序则 JDBC代码在所有 Java 平台上（从网络计算机到大型机）都可以自 动安装、移植并保证安全性。 总之，JDBC API 对于基本的 SQL 抽象和概念是一种自然的 Java 接口。它建立在 ODBC 上而不是从零开始。因此，熟悉 ODBC 的程序员将发现 JDBC 很容易使用。JDBC 保留了 ODBC 的基本设计特征；事实上，两种接口都基于 X/Open SQL CLI（调用级接口）。它们之间最大的区别在于：JDBC 以 Java 风格与优点为基础并进行优化，因此更加易于使用。 目前，Microsoft 又引进了 ODBC 之外的新 API： RDO、 ADO 和OLE DB。这些设计在许多方面与 JDBC 是相同的，即它们都是面向对象的数据库接口且基于可在 ODBC 上实现的类。但在这些接口中，我们未看见有特别的功能使我们要转而选择它们来替代 ODBC，尤其是在 ODBC 驱动程序已建立起较为完善的市场的情况下。它们最多也就是在 ODBC 上加了一种装饰而已。</p>
<h1 id="数据库链接字符串大全"><a href="#数据库链接字符串大全" class="headerlink" title="数据库链接字符串大全"></a>数据库链接字符串大全</h1><h2 id="SQL-Server-2005"><a href="#SQL-Server-2005" class="headerlink" title="SQL Server 2005"></a>SQL Server 2005</h2><h3 id="SQL-Native-Client-ODBC-Driver"><a href="#SQL-Native-Client-ODBC-Driver" class="headerlink" title="SQL Native Client ODBC Driver"></a>SQL Native Client ODBC Driver</h3><p>标准安全连接 Driver={SQL Native Client};Server=myServerAddress; Database=myDataBase;Uid=myUsername;Pwd=myPassword; 受信的连接 Driver={SQL Native Client}; Server=myServerAddress;Database=myDataBase;Trusted_Connection=yes; “Integrated Security=SSPI” 与 “Trusted_Connection=yes” 是相同的。 连接到一个SQL Server实例 指定服务器实例的表达式和其他SQL Server的连接字符串相同。 Driver={SQL Native Client};Server=myServerName/theInstanceName;Database=myDataBase; Trusted_Connection=yes; 指定用户名和密码 oConn.Properties(“Prompt”) = adPromptAlways Driver={SQL Native Client}; Server=myServerAddress;Database=myDataBase; 使用MARS (multiple active result sets) Driver={SQL Native Client};Server=myServerAddress;Database=myDataBase; Trusted_Connection=yes;MARS_Connection=yes; “MultipleActiveResultSets=true”与MARS_Connection=yes”是相同的。 使用ADO.NET 2.0作为MARS的模块。 MARS不支持ADO.NET 1.0和ADO.NET 1.1。 验证网络数据 Driver={SQL Native Client}; Server=myServerAddress;Database=myDataBase; Trusted_Connection=yes;Encrypt=yes; 使用附加本地数据库文件的方式连接到本地SQL Server Express实例 Driver={SQL Native Client};Server=./SQLExpress; AttachDbFilename=c:/asd/qwe/mydbfile.mdf; Database=dbname;Trusted_Connection=Yes; 为何要使用Database参数？如果同名的数据库已经被附加，那么SQL Server将不会重新附加。 使用附加本地数据文件夹中的数据库文件的方式连接到本地SQL Server Express实例 Driver={SQL Native Client};Server=./SQLExpress; AttachDbFilename=|DataDirectory|mydbfile.mdf; Database=dbname; Trusted_Connection=Yes; 为何要使用Database参数？如果同名的数据库已经被附加，那么SQL Server将不会重新附加。 数据库镜像 Data Source=myServerAddress; Failover Partner=myMirrorServer;Initial Catalog=myDataBase;Integrated Security=True;</p>
<h3 id="SQL-Native-Client-OLE-DB-Provider"><a href="#SQL-Native-Client-OLE-DB-Provider" class="headerlink" title="SQL Native Client OLE DB Provider"></a>SQL Native Client OLE DB Provider</h3><p>标准连接 Provider=SQLNCLI;Server=myServerAddress; Database=myDataBase;Uid=myUsername;Pwd=myPassword; 受信的连接 Provider=SQLNCLI;Server=myServerAddress; Database=myDataBase;Trusted_Connection=yes; 连接到SQL Server实例 指定服务器实例的表达式和其他SQL Server的连接字符串相同。 Provider=SQLNCLI;Server=myServerName/theInstanceName; Database=myDataBase;Trusted_Connection=yes; 使用帐号和密码 oConn.Properties(“Prompt”) = adPromptAlways oConn.Open “Provider=SQLNCLI;Server=myServerAddress;DataBase=myDataBase; 使用MARS (multiple active result sets) Provider=SQLNCLI;Server=myServerAddress;Database=myDataBase;Trusted_Connection=yes;MarsConn=yes; “MultipleActiveResultSets=true”和”MARS_Connection=yes”是相同的。 使用ADO.NET 2.0作为MARS的模块。 MARS不支持ADO.NET 1.0和ADO.NET 1.1。 验证网络数据 Provider=SQLNCLI;Server=myServerAddress; Database=myDataBase;Trusted_Connection=yes;Encrypt=yes; 使用附加本地数据库文件的方式连接到本地SQL Server Express实例 Provider=SQLNCLI;Server=./SQLExpress;AttachDbFilename=c:/asd/qwe/mydbfile.mdf; Database=dbname;Trusted_Connection=Yes; 使用附加本地数据文件夹中的数据库文件的方式连接到本地SQL Server Express实例 Provider=SQLNCLI;Server=./SQLExpress; AttachDbFilename=|DataDirectory|mydbfile.mdf; Database=dbname;Trusted_Connection=Yes; 数据库镜像 Data Source=myServerAddress;Failover Partner=myMirrorServer; Initial Catalog=myDataBase;Integrated Security=True;</p>
<h3 id="SqlConnection-NET"><a href="#SqlConnection-NET" class="headerlink" title="SqlConnection (.NET)"></a>SqlConnection (.NET)</h3><p>标准连接 Data Source=myServerAddress; Initial Catalog=myDataBase;User Id=myUsername;Password=myPassword; Standard Security alternative syntax Server=myServerAddress;Database=myDataBase;User ID=myUsername;Password=myPassword;Trusted_Connection=False; 受信任的连接 Data Source=myServerAddress;Initial Catalog=myDataBase;Integrated Security=SSPI; Trusted Connection alternative syntax Server=myServerAddress;Database=myDataBase;Trusted_Connection=True; 连接到一个SQL Server的实例 指定服务器实例的表达式和其他SQL Server的连接字符串相同。 Server=myServerName/theInstanceName;Database=myDataBase;Trusted_Connection=True; 来自WinCE设备的安全连接 Data Source=myServerAddress; Initial Catalog=myDataBase; Integrated Security=SSPI;User ID=myDomain/myUsername;Password=myPassword; 仅能用于CE设备。 带有IP地址的连接 Data Source=190.190.200.100,1433;Network Library=DBMSSOCN;Initial Catalog=myDataBase;User ID=myUsername;Password=myPassword; 使用MARS (multiple active result sets) Server=myServerAddress;Database=myDataBase;Trusted_Connection=True; MultipleActiveResultSets=true; 使用ADO.NET 2.0作为MARS的模块。 MARS不支持ADO.NET 1.0和ADO.NET 1.1。 使用附加本地数据库文件的方式连接到本地SQL Server Express实例 Server=./SQLExpress;AttachDbFilename=c:/asd/qwe/mydbfile.mdf; Database=dbname;Trusted_Connection=Yes; 使用附加本地数据文件夹中的数据库文件的方式连接到本地SQL Server Express实例 Server=./SQLExpress;AttachDbFilename=|DataDirectory|mydbfile.mdf; Database=dbname;Trusted_Connection=Yes; 使用在SQL Server Express实例上的用户实例 Data Source=./SQLExpress;Integrated Security=true;AttachDbFilename=|DataDirectory|/mydb.mdf;User Instance=true; 数据库镜像 Data Source=myServerAddress;Failover Partner=myMirrorServer;Initial Catalog=myDataBase;Integrated Security=True; Asynchronous processing Server=myServerAddress; Database=myDataBase; Integrated Security=True; Asynchronous Processing=True;</p>
<h2 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h2><h3 id="MyODBC"><a href="#MyODBC" class="headerlink" title="MyODBC"></a>MyODBC</h3><p>MyODBC 2.50 本地数据库 Driver={mySQL};Server=localhost;Option=16834;Database=myDataBase; MyODBC 2.50 远程数据库 Driver={mySQL}; Server=myServerAddress;Port=3306; Option=131072;Stmt=; Database=myDataBase; Uid=myUsername; Pwd=myPassword; MyODBC 3.51 本地数据库 Driver={MySQL ODBC 3.51 Driver};Server=localhost;Database=myDataBase; User=myUsername;Password=myPassword;Option=3; MyODBC 3.51 远程数据库 Driver={MySQL ODBC 3.51 Driver};Server=data.domain.com;Port=3306; Database=myDataBase; User=myUsername; Password=myPassword;Option=3;</p>
<h3 id="OLE-DB-OleDbConnection-NET"><a href="#OLE-DB-OleDbConnection-NET" class="headerlink" title="OLE DB, OleDbConnection (.NET)"></a>OLE DB, OleDbConnection (.NET)</h3><p>标准 Provider=MySQLProv; Data Source=mydb; User Id=myUsername; Password=myPassword; Connector/Net 1.0 (.NET) 标准 Server=myServerAddress; Database=myDataBase; Uid=myUsername;Pwd=myPassword; 默认端口号是3306 指定端口号 Server=myServerAddress; Port=1234;Database=myDataBase; Uid=myUsername; Pwd=myPassword; 命名管道 Server=myServerAddress; Port=-1;Database=myDataBase; Uid=myUsername;Pwd=myPassword; 如果端口是-1，意思是告诉驱动程序使用命名管道网络协议来连接数据库。</p>
<h3 id="MySqlConnection-NET"><a href="#MySqlConnection-NET" class="headerlink" title="MySqlConnection (.NET)"></a>MySqlConnection (.NET)</h3><p>eInfoDesigns.dbProvider Data Source=myServerAddress; Database=myDataBase;User ID=myUsername; Password=myPassword; Command Logging=false; SevenObjects MySqlClient (.NET) 标准 Host=myServerAddress; UserName=myUsername; Password=myPassword; Database=myDataBase; Core Labs MySQLDirect (.NET) 标准 User ID=root;Password=myPassword;Host=localhost;Port=3306;Database=myDataBase; Direct=true;Protocol=TCP;Compress=false;Pooling=true;Min Pool Size=0;Max Pool Size=100;Connection Lifetime=0; MySQLDriverCS (.NET) 标准 Location=myServerAddress; Data Source=myDataBase; UserID=myUsername; Password=myPassword; Port=3306;Extended Properties=”“”“;</p>
<h2 id="Oracle"><a href="#Oracle" class="headerlink" title="Oracle"></a>Oracle</h2><h3 id="ODBC-1"><a href="#ODBC-1" class="headerlink" title="ODBC"></a>ODBC</h3><p>新版本 Driver={Microsoft ODBC for Oracle}; Server=myServerAddress; Uid=myUsername;Pwd=myPassword; 旧版本 Driver={Microsoft ODBC Driver for Oracle}; ConnectString=OracleServer.world; Uid=myUsername; Pwd=myPassword;</p>
<h3 id="OLE-DB-OleDbConnection-NET-1"><a href="#OLE-DB-OleDbConnection-NET-1" class="headerlink" title="OLE DB, OleDbConnection (.NET)"></a>OLE DB, OleDbConnection (.NET)</h3><p>标准连接 此连接字符串适用了微软的驱动。 Provider=msdaora;Data Source=MyOracleDB; User Id=myUsername; Password=myPassword; 受信连接 Provider=msdaora; Data Source=MyOracleDB; Persist Security Info=False; Integrated Security=Yes; 标准连接 由Oracle提供的驱动。 Provider=OraOLEDB. Oracle;Data Source=MyOracleDB; User Id=myUsername; Password=myPassword; 受信连接 Provider=OraOLEDB.Oracle;Data Source=MyOracleDB;OSAuthent=1; Oracle.DataAccess.Client.OracleConnection 标准 Data Source=TORCL;User Id=myUsername; Password=myPassword; 标准安全连接 Data Source=TORCL;Integrated Security=SSPI; 使用ODP.NET而不使用tnsnames.ora Data Source=(DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=MyHost) (PORT=MyPort)))(CONNECT_DATA=(SERVER=DEDICATED)(SERVICE_NAME=MyOracleSID))); User Id=myUsername;Password=myPassword; OracleConnection, Oracle Data Provider, ODP.NET. System.Data.OracleClient.OracleConnection. 标准 用于8i RC3及以后的版本 Data Source=MyOracleDB;Integrated Security=yes; 指定用户名和密码 用于8i RC3及以后的版本 Data Source=MyOracleDB; User Id=myUsername; Password=myPassword; Integrated Security=no; 忽略tnsnames.ora 另一种不需要使用DSN的连接方式 SERVER=(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=MyHost) (PORT=MyPort))(CONNECT_DATA=(SERVICE_NAME=MyOracleSID))); uid=myUsername;pwd=myPassword; 使用上面的连接字符串可能会导致Visual Studio报告错误。 如果您在使用中出现了这些问题，请使用下面的这种连接方式。 Data Source=(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=MyHost)(PORT=MyPort)) (CONNECT_DATA=(SERVICE_NAME=MyOracleSID))); User Id=myUsername; Password=myPassword; 使用连接池 如果连接池服务程序找不到已经存在的连接池，它将根据连接字符串创建一个新的池。 否则将循环使用池中已存在的连接。 Data Source=myOracleDB; User Id=myUsername; Password=myPassword;Min Pool Size=10;Connection Lifetime=120; Connection Timeout=60;Incr Pool Size=5;Decr Pool Size=2; Windows身份验证 Data Source=myOracleDB;User Id=/; 特权连接 使用SYSDBA Data Source=myOracleDB;User Id=SYS;Password=SYS; DBA Privilege=SYSDBA; 特权连接 使用SYSOPER Data Source=myOracleDB;User Id=SYS;Password=SYS;DBA Privilege=SYSOPER; 密码过期处理过程 当使用一个连接字符串连接数据库后，出现”密码已过期”的错误时。 请执行OpenWithNewPassword命令来提供新密码。 Data Source=myOracleDB;User Id=myUsername;Password=myPassword; oConn.OpenWithNewPassword(sTheNewPassword); Proxy验证 Data Source=myOracleDB; User Id=myUsername; Password=myPassword;Proxy User Id=pUserId; Proxy Password=pPassword; Core Labs OraDirect (.NET) Standard User ID=myUsername; Password=myPassword; Host=ora;Pooling=true; Min Pool Size=0;Max Pool Size=100;Connection Lifetime=0; Data Shape MS Data Shape Provider=MSDataShape.1;Persist Security Info=False;Data Provider=MSDAORA; Data Source=orac;User Id=myUsername; Password=myPassword;</p>
<h2 id="AS-400-iSeries"><a href="#AS-400-iSeries" class="headerlink" title="AS/400 (iSeries)"></a>AS/400 (iSeries)</h2><p>IBM .Net Data Provider 您需要使用 IBM.Data.DB2.iSeries 命名空间 DataSource=myServerAddress;UserID=myUsername; Password=myPassword;DataCompression=True; OLE DB, OleDbConnection (.NET) IBM Client Access OLE DB 适配器 Provider=IBMDA400;Data Source=MY_SYSTEM_NAME;User Id=myUsername; Password=myPassword; MY_SYSTEM_NAME是在OperationsNavigator中的系统连接名称。 IBM Client Access OLE DB 适配器 Provider=IBMDA400;Data Source=MY_SYSTEM_NAME;User Id=myUsername; Password=myPassword;Default Collection=MY_LIBRARY; MY_SYSTEM_NAME是系统连接的名称，MY_LIBRARY是iSeries Navigator中library的名称。 ODBC IBM Client Access ODBC 驱动 Driver={Client Access ODBC Driver (32-bit)};System=my_system_name; Uid=myUsername; Pwd=myPassword; IBM iSeries Access ODBC 驱动 这个驱动需要比IBM Client Access ODBC的驱动更新。 Driver={iSeries Access ODBC Driver};System=my_system_name; Uid=myUsername; Pwd=myPassword;</p>
<h2 id="Cache"><a href="#Cache" class="headerlink" title="Caché"></a>Caché</h2><p>ODBC 标准 DRIVER={InterSystems ODBC};SERVER=myServerAddress; DATABASE=myDataBase; UID=myUsername;PWD=myPassword; 特定端口 DRIVER={InterSystems ODBC};SERVER=myServerAddress;PORT=12345; DATABASE=myDataBase; UID=myUsername;PWD=myPassword; 特定协议 DRIVER={InterSystems ODBC};SERVER=myServerAddress;PORT=12345; DATABASE=myDataBase; PROTOCOL=TCP;STATIC CURSORS=1;UID=myUsername;PWD=myPassword;</p>
<h2 id="IBM-DB2"><a href="#IBM-DB2" class="headerlink" title="IBM DB2"></a>IBM DB2</h2><p>OLE DB, OleDbConnection (.NET) TCP/IP Provider=DB2OLEDB;Network Transport Library=TCPIP;Network Address=XXX.XXX.XXX.XXX; Initial Catalog=MyCtlg;Package Collection=MyPkgCol;Default Schema=Schema;User ID=myUsername; Password=myPassword; APPC Provider=DB2OLEDB;APPC Local LU Alias=MyAlias;APPC Remote LU Alias=MyRemote; Initial Catalog=MyCtlg;Package Collection=MyPkgCol; Default Schema=Schema;User ID=myUsername;Password=myPassword; IBM提供的OLE DB适配器 TCP/IP Provider=IBMDADB2;Database=myDataBase; Hostname=myServerAddress; Protocol=TCPIP;Port=50000; Uid=myUsername;Pwd=myPassword; ODBC 标准 Driver={IBM DB2 ODBC DRIVER}; Database=myDataBase;Hostname=myServerAddress; Port=1234;Protocol=TCPIP;Uid=myUsername;Pwd=myPassword;</p>
<h2 id="Firebird"><a href="#Firebird" class="headerlink" title="Firebird"></a>Firebird</h2><p>ODBC - IBPhoenix Open Source 标准 Driver=Firebird/InterBase(r) driver;Uid=SYSDBA; Pwd=masterkey; DbName=D:/FIREBIRD/examples/TEST.FDB; .NET - Firebird .Net Data Provider 标准 User=SYSDBA;Password=masterkey;Database=SampleDatabase.fdb; DataSource=localhost;Port=3050;Dialect=3; Charset=NONE;Role=; Connection lifetime=15;Pooling=true;MinPoolSize=0;MaxPoolSize=50;Packet Size=8192;ServerType=0;</p>
<h2 id="Informix"><a href="#Informix" class="headerlink" title="Informix"></a>Informix</h2><p>ODBC Informix 3.30 Dsn=;Driver={INFORMIX 3.30 32 BIT};Host=hostname;Server=myServerAddress; Service=service-name; Protocol=olsoctcp; Database=myDataBase;Uid=myUsername;Pwd=myPassword; Informix-CLI 2.5: Driver={Informix-CLI 2.5 (32 Bit)};Server=myServerAddress; Database=myDataBase; Uid=myUsername;Pwd=myPassword; OLE DB IBM Informix OLE DB Provider Provider=Ifxoledbc.2;Password=myPassword; User ID=myUsername; Data Source=dbName@serverName;Persist Security Info=true; IBM Informix .NET Provider IBM.Data.Informix.IfxConnection(命名空间) Database=myDataBase;Host=192.168.10.10; Server=db_engine_tcp; Service=1492; Protocol=onsoctcp;UID=myUsername;Password=myPassword; ##Ingres ODBC DSN-less Provider=MSDASQL.1;DRIVER=Ingres;SRVR=xxxxx;DB=xxxxx;Persist SecurityInfo=False;Uid=myUsername;Pwd=myPassword; SELECTLOOPS=N; ExtendedProperties=”SERVER=xxxxx;DATABASE=xxxxx;SERVERTYPE=INGRES”;</p>
<h2 id="Interbase"><a href="#Interbase" class="headerlink" title="Interbase"></a>Interbase</h2><p>ODBC, Easysoft 本地计算机 Driver={Easysoft IB6 ODBC}; Server=localhost ;Database=localhost:C:/mydatabase.gdb; Uid=myUsername; Pwd=myPassword; 远程计算机 Driver={Easysoft IB6 ODBC}; Server=myServerAddress; Database=ComputerName: C:/mydatabase.gdb; Uid=myUsername;Pwd=myPassword; ODBC, Intersolv 本地计算机 Driver={INTERSOLV InterBase ODBC Driver (<em>.gdb)}; Server=localhost; Database=localhost: C:/mydatabase.gdb; Uid=myUsername; Pwd=myPassword; 远程计算机 Driver={INTERSOLV InterBase ODBC Driver (</em>.gdb)}; Server=myServerAddress; Database=ComputerName: C:/mydatabase.gdb;Uid=myUsername; Pwd=myPassword; OLE DB, SIBPROvider 标准 provider=sibprovider;location=localhost:;data source=c:/databases/gdbs/mygdb.gdb; user id=SYSDBA; Password=masterkey; 版本 2.x Provider=SIBPROvider.2; Data Source=localhost:c:/databases/gdbs/mygdb.gdb; Persist Security Info=False; 指定字符集 provider=sibprovider;location=localhost:;data source=c:/databases/gdbs/mygdb.gdb; user id=SYSDBA; Password=masterkey; character set=ISO8859_1; 指定角色 provider=sibprovider;location=localhost:; data source=c:/databases/gdbs/mygdb.gdb;user id=SYSDBA; Password=masterkey; role=DIGITADORES; Lightbase 标准连接 标准 User=myUsername;Password=myPassword;UDB=USERBASE;Server=myServerAddress; Paradox ODBC 5.X Driver={Microsoft Paradox Driver (*.db )}; DriverID=538;Fil=Paradox 5.X; DefaultDir=c:/pathToDb/;Dbq=c:/pathToDb/;CollatingSequence=ASCII; 7.X Provider=MSDASQL.1;Persist Security Info=False; Mode=Read;Extended Properties=DSN=Paradox; DBQ=C:/myDb;DefaultDir=C:/myDb;DriverId=538; FIL=Paradox 7.X; MaxBufferSize=2048;PageTimeout=600;;Initial Catalog=C:/myDb; 请注意：以上的方法仅能从数据库获取数据。 Intersolv 3.11 ODBC Driver 7.X DSN=MyDSN;AUT=1;CT=7;DQ=0;FOC=0;IS=1; PW=myPassword;USF=1;ULQ=1; 并不是所有参数都是必填的。大多数参数都能够在DSN中进行设置。 Parameters definition AUT - ApplicationUsingThreads CT - CreateType DB - Database DSN - DataSourceName DQ - DeferQueryEvaluation FOC - FileOpenCache IS - IntlSort ND - NetDir PW - Passwords USF - UltraSafeCommit ULQ - UseLongQualifiers OleDbConnection (.NET) 标准 Provider=Microsoft.Jet.OLEDB.4.0;Data Source=c:/myDb;Extended Properties=Paradox 5.x; 注意：您仅需要指定数据库存放的地址而无需指定数据库的名称。</p>
<h2 id="SQLBase"><a href="#SQLBase" class="headerlink" title="SQLBase"></a>SQLBase</h2><p>OLE DB 标准 Provider=SQLBaseOLEDB;Data source=myServerAddress; Location=myDataBase; User Id=myUsername; Password=myPassword; SQLBase .NET Data Provider 标准SQLBase连接 DataSource=myServerAddress; UserId=myUsername; Password=myPassword;Poolsize=5;Connection Lifetime=60; “Poolsize” 表示多少SQLBase连接被打开，不论它们是否被立即使用。默认值是5。 “Connection Lifetime” 表示连接存在多长时间(单位：秒)。默认是60秒。</p>
<h2 id="SQL-Serve"><a href="#SQL-Serve" class="headerlink" title="SQL Serve"></a>SQL Serve</h2><p>ODBC 标准连接 Driver={SQL Server};Server=myServerAddress; Database=myDataBase;Uid=myUsername;Pwd=myPassword; 受信的连接 Driver={SQL Server};Server=myServerAddress; Database=myDataBase;Trusted_Connection=Yes; 指定帐号和密码 oConn.Properties(“Prompt”) = adPromptAlways Driver={SQL Server}; Server=myServerAddress;Database=myDataBase; OLE DB, OleDbConnection (.NET) 标准连接 Provider=sqloledb;Data Source=myServerAddress;Initial Catalog=myDataBase;User Id=myUsername;Password=myPassword; 受信的连接 Provider=sqloledb;Data Source=myServerAddress;Initial Catalog=myDataBase;Integrated Security=SSPI; 使用serverName/instanceName作为数据源可以指定SQL Server实例。 连接到一个SQL Server的实例 指定服务器实例的表达式和其他SQL Server的连接字符串相同。 Provider=sqloledb; Data Source=myServerName/theInstanceName; Initial Catalog=myDataBase;Integrated Security=SSPI; 指定帐户和密码 oConn.Provider = “sqloledb” oConn.Properties(“Prompt”) = adPromptAlways Data Source=myServerAddress;Initial Catalog=myDataBase; 使用IP地址的连接 Provider=sqloledb;Data Source=190.190.200.100,1433; Network Library=DBMSSOCN;Initial Catalog=myDataBase; User ID=myUsername; Password=myPassword; SqlConnection (.NET) 标准连接 Data Source=myServerAddress;Initial Catalog=myDataBase; User Id=myUsername;Password=myPassword; Standard Security alternative syntax Server=myServerAddress;Database=myDataBase;User ID=myUsername;Password=myPassword;Trusted_Connection=False; 受信任的连接 Data Source=myServerAddress;Initial Catalog=myDataBase;Integrated Security=SSPI; Trusted Connection alternative syntax Server=myServerAddress;Database=myDataBase;Trusted_Connection=True; 连接到SQL Server实例 指定服务器实例的表达式和其他SQL Server的连接字符串相同。 Server=myServerName/theInstanceName;Database=myDataBase; Trusted_Connection=True; 仅能用于CE设备。 Data Source=myServerAddress;Initial Catalog=myDataBase;Integrated Security=SSPI;User ID=myDomain/myUsername;Password=myPassword; 带有IP地址的连接 Data Source=190.190.200.100,1433;Network Library=DBMSSOCN;Initial Catalog=myDataBase; User ID=myUsername;Password=myPassword; 指定包的大小 Server=myServerAddress;Database=myDataBase;User ID=myUsername;Password=myPassword; Trusted_Connection=False;Packet Size=4096; 默认的包大小为8192字节。 Data Shape MS Data Shape Provider=MSDataShape;Data Provider=SQLOLEDB;Data Source=myServerAddress; Initial Catalog=myDataBase;User ID=myUsername;Password=myPassword;</p>

            
            <p class="more">
                <a href="/2015/09/16/2019030500032/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2015/09/16/2019030500032/" title="数据库连接字符串的困惑">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/6.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/SQL-Server/">SQL Server</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2015/09/07/2019030500021/">
    		报表性能优化方案之单数据集分页SQL实现层式报表
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2015-09-07T04:36:01.000Z">2015-09-07</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/SQL/" title="SQL">SQL</a> / 
    
        <a href="/tags/FineReport/" title="FineReport">FineReport</a> / 
    
        <a href="/tags/报表/" title="报表">报表</a> / 
    
        <a href="/tags/数据集/" title="数据集">数据集</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <p><strong>1、概述</strong></p>
<p>我们知道，行式引擎按页取数只适用于Oracle,mysql,hsql和sqlserver2008及以上数据库，其他数据库，如access，sqlserver2005，sqlite等必须编写分页SQL。</p>
<p>下面以Access数据库为例介绍需要写分页SQL的数据库怎样利用行式的引擎实现层式报表。</p>
<p>解决方案提供工具：报表开发工具FineReport</p>
<p><strong>2、解决思路</strong></p>
<p>对于mysql这类可以直接使用行式的引擎实现层式报表的数据库来说，如果勾选了行式引擎，程序会自动生成分页sql，如，我新建了一个数据集ds1，来源于mysql数据库，基本sql语句为：</p>
<p><strong>SELECT * FROM 订单明细</strong></p>
<p>如果不定义分页sql，勾选行式引擎选项，预览报表时，程序会将上面的sql语句转化为下面的语句来取一页的数据：</p>
<p><strong>SELECT COUNT(<em>)AS totalRowCount FROM (SELECT </em> FROM 订单明细) t</strong></p>
<p>如果数据库是上面所说的access一类的无法直接生成分页sql的数据库，那么就需要编写分页SQL。</p>
<p><strong>3、操作步骤</strong></p>
<p>以FRDemo内置的sqlite为例，说明sqlite如何写分页查询。</p>
<p>注：sqlserver2005和sqlite操作步骤一样。</p>
<p><strong>3.1新建数据集</strong></p>
<p>新建数据集ds1：<strong>SELECT * FROM 订单明细</strong>。</p>
<p><strong>3.2添加分页查询SQL语句</strong></p>
<p>在数据查询面板中点击<strong>分页查询</strong>按钮，编辑分页SQL语句，如下图：</p>
<p><img src="http://img.blog.csdn.net/20150907100054679" alt></p>
<p>完整的sql语句如下：</p>
<p><strong>[sql]</strong></p>
<ol>
<li>SELECT *</li>
<li>FROM (</li>
<li>SELECT  *</li>
<li>FROM(</li>
<li>SELECT *</li>
<li>FROM 订单明细 ORDER BY 订单ID ASC limit ${fr_pagesize*fr_pagenumber}</li>
<li>) AS e1 ORDER BY 订单ID DESC limit ${</li>
<li>if(fr_pagenumber == int((((fr_rowcount-1)/fr_pagesize)+1)),fr_rowcount - (fr_pagesize*(fr_pagenumber-1)),fr_pagesize)</li>
<li>}</li>
<li>) AS e2 ORDER BY 订单ID ASC</li>
</ol>
<p>注：上述代码放置在分页sql面板中时，要删除后面的注释语句，并且语句中的三次ORDER BY 一定不能丢。</p>
<p>·        <strong>分页sql语句注释</strong></p>
<p><strong>${if(fr_pagenumber==int( (((fr_rowcount-1)/fr_pagesize)+1)),fr_rowcount -(fr_pagesize*(fr_pagenumber-1)),fr_pagesize)}</strong>意思是：</p>
<p>假如是最后一页的话，就取最后一页剩余的行数，假如不是最后一页就取每页需要显示的行数，示例中每页需要显示的行数为30行。</p>
<p><strong>fr_pagenumber</strong>：当前浏览的页数，如果预览第2页，则fr_pagenumber=2；</p>
<p><strong>fr_rowcount</strong>：当前数据集的总数据条数；</p>
<p><strong>fr_pagesize</strong>：表示设置行式引擎时，每页需显示的行数，该示例中fr_pagesize=30.</p>
<p>在预览时，设定的分页查询根据3个变量的值，会生成数据库查询，如fr_pagenumber=2，fr_pagesize=30时，即在web端预览报表，预览至第2页时，上面的sql语句会转化为：</p>
<p><strong>SELECT <em> FROM (SELECT </em> FROM ( SELECT * FROM 订单明细 ORDER BY 订单ID ASC limit 60 )AS e1 ORDER BY 订单ID DESClimit30 ) AS e2 ORDER BY 订单ID ASC</strong></p>
<p>预览至第3页时，fr_pagenumber=3，sql语句就转化为：</p>
<p><strong>SELECT <em> FROM (SELECT </em> FROM ( SELECT * FROM 订单明细 ORDER BY 订单ID ASC limit 90 )AS e1 ORDER BY 订单ID DESClimit30) AS e2 ORDER BY 订单ID ASC</strong></p>
<p>预览至最后一页时，所剩下的数据可能不足30行，那么sql语句又会转化成什么样呢？</p>
<p>如果fr_rowcount=100，fr_pagesize=30，即数据总行数为100行，每页显示30行，预览至最后一页，也就是第4页时，fr_pagenumber=4，sql语句将转换为：</p>
<p><strong>SELECT <em> FROM (SELECT </em> FROM ( SELECT * FROM 订单明细 ORDER BY 订单ID ASC limit 90)AS e1 ORDER BY 订单ID DESClimit10 ) AS e2 ORDER BY 订单ID ASC</strong></p>
<p><strong>3.3报表主体设计</strong></p>
<p>将数据集中的数据列拖曳至单元格中。</p>
<p><strong>3.4行式引擎设置</strong></p>
<p>同上一节的设置方法，这里不再赘述。</p>
<p><strong>3.5效果查看</strong></p>
<p>点击分页预览，效果图如下：</p>
<p>已完成模板请参照：<strong>%FR_HOME%\WebReport\WEB-INF\reportlets\doc\Advanced\PagingSql.cpt</strong></p>
<p><strong>3.6数据库的分页SQL语句</strong></p>
<p><strong>[sql]</strong></p>
<ol>
<li>SELECT *</li>
<li>FROM (</li>
<li>SELECT TOP ${</li>
<li>if(fr_pagenumber == int((((fr_rowcount-1)/fr_pagesize)+1)),fr_rowcount - (fr_pagesize*(fr_pagenumber-1)),fr_pagesize)</li>
<li>} *</li>
<li>FROM(</li>
<li>SELECT TOP ${fr_pagesize*fr_pagenumber} *</li>
<li>FROM 订单明细 ORDER BY 订单ID ASC</li>
<li>) AS e1 ORDER BY 订单ID DESC</li>
<li>) AS e2 ORDER BY 订单ID ASC</li>
</ol>

            
            <p class="more">
                <a href="/2015/09/07/2019030500021/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2015/09/07/2019030500021/" title="报表性能优化方案之单数据集分页SQL实现层式报表">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/7.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/SQL-Server/">SQL Server</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2015/09/01/2019030500162/">
    		SQL Server 2012 未将对象引用设置到对象的实例。
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2015-09-01T07:54:53.000Z">2015-09-01</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/SQL-Server/" title="SQL Server">SQL Server</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <blockquote>
<p>1、错误描述 <img src="http://img.blog.csdn.net/20150831214339516?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt> <img src="http://img.blog.csdn.net/20150831214354172?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt> 2、错误原因 创建了student数据库后，使用数据库时出现语法错误 use student; 3、解决办法 （1）重装SQL Server 2012</p>
</blockquote>

            
            <p class="more">
                <a href="/2015/09/01/2019030500162/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2015/09/01/2019030500162/" title="SQL Server 2012 未将对象引用设置到对象的实例。">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/1.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/SQL-Server/">SQL Server</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2015/08/31/2019030500165/">
    		SQL Server2012无法连接到2015-0831-1223
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2015-08-31T08:54:46.000Z">2015-08-31</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/SQL-Server/" title="SQL Server">SQL Server</a> / 
    
        <a href="/tags/MSSQLSERVER/" title="MSSQLSERVER">MSSQLSERVER</a> / 
    
        <a href="/tags/SQL-Server2012/" title="SQL Server2012">SQL Server2012</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <p>1、错误描述 <img src="http://img.blog.csdn.net/20150831140850940?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt> <img src="http://img.blog.csdn.net/20150831140904891?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt> 2、错误原因 SQL Server(MSSQLSERVER)和SQL Server Analysis Services(MSSQLSERVER)服务没有启动 3、解决办法 管理工具-服务，启动两个服务 <img src="http://img.blog.csdn.net/20150831141939971?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt></p>

            
            <p class="more">
                <a href="/2015/08/31/2019030500165/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2015/08/31/2019030500165/" title="SQL Server2012无法连接到2015-0831-1223">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/1.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/SQL-Server/">SQL Server</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2015/07/08/2019030500164/">
    		Sql Server 查询一段日期内的所有礼拜天
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2015-07-08T06:37:34.000Z">2015-07-08</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/SQL-Server/" title="SQL Server">SQL Server</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <ol>
<li>/*</li>
<li>查询一段日期内的所有礼拜天</li>
<li>@startdate 开始日期</li>
<li>@enddate 结束日期</li>
<li><p>*/</p>
</li>
<li><p>declare @startDate datetime</p>
</li>
<li>declare @endDate datetime</li>
<li>declare @week varchar(20)</li>
<li>set @startDate = ‘20150101’</li>
<li>set @endDate = ‘20151231’</li>
<li>while @startDate &lt;= @endDate</li>
<li>begin</li>
<li>set @week = DATENAME(weekday, @startDate);</li>
<li>if (@week = ‘星期六’ or @week = ‘星期日’)</li>
<li>begin</li>
<li>select DATENAME(YEAR, @startDate) as “year”, @startDate as “day”</li>
<li><p>end</p>
</li>
<li><p>set @startDate = @startDate + 1;</p>
</li>
<li>end</li>
</ol>

            
            <p class="more">
                <a href="/2015/07/08/2019030500164/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2015/07/08/2019030500164/" title="Sql Server 查询一段日期内的所有礼拜天">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/8.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/SQL-Server/">SQL Server</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2015/07/06/2019030500168/">
    		SqlServer 批处理（Batch Requests/sec）过高追踪处理
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2015-07-06T05:15:30.000Z">2015-07-06</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/sqlserver/" title="sqlserver">sqlserver</a> / 
    
        <a href="/tags/Requests/" title="Requests">Requests</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <blockquote>
<p>近一段时间观察，监控发现一数据库的 每秒批处理请求数（Batch Requests/sec）经常升高持续较长时间，比平时高出几百，如下图： <img src="http://img.blog.csdn.net/20150706115817476?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt> 由于一直比较高，以为是正常现象，没有注意。最近我们老大要求查看原因，所以跟踪查看，确实是数据库的非正常请求引起！ 先了解 批处理（Batch Requestsc）， 批处理简单理解为同时执行的一批SQL处理语句，一个批处理中可能有多个DML、多个存储过程等等。如在SSMS操作，每个’GO’执行前都属于一个批处理。 开始处理，用最笨的方法，打开SQL Server profiler  监控 SQL:BatchCompleted （sql批处理完成记录），但发现不是很多，每秒300左右，看起来正常，所以用 SQL Server profiler 不可行。 既然是批处理过多，批处理跟事务相关，可以打开性能监视器监控以下两个计数器： Batch Requests/sec Tranactions/sec(_Total) 发现 Tranactions/sec(_Total) 与 Batch Requests/sec 几乎是一致的，在继续查看Tranactions/sec ，把每个数据库都详细监控，确定只有 Tranactions/sec(master)  是最大的。与 master 连接相关的，如果不是系统的作业引起，可能就是连接引起，连接又有可能是内部的报表连接引起。排除除了SqlServer作业，再监控以下计数器： Connection Reset/sec Logins/sec Logout/sec 只有 Connection Reset/sec 是最频繁的，Logins/sec 和 Logout/sec 平均都在3左右。Connection Reset/sec 就是连接池连接过来的。 <strong>[plain]</strong></p>
<ol>
<li>“The sp_reset_connection stored procedure is used by SQL</li>
<li>Server to support remote stored procedure calls in a transaction. This stored</li>
<li>procedure also causes Audit Login and Audit Logout events to fire when a</li>
<li>connection is reused from a connection pool.”</li>
</ol>
<p>此时可以用 SQL Server profiler  监控以下事件： Audit Login Audit Logout <img src="http://img.blog.csdn.net/20150706110355594?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt> 这时监控出来的数据就比较多了！~这个用户 <strong>cdwbcb</strong> 不断从连接池地连接和断开！非常频繁，可以确定是该用户引起的！ 接下来就好办了，打开SSMS连接到该数据库，执行以下语句。</p>
<p><strong>[sql]</strong></p>
<ol>
<li>select p.*,s.text</li>
<li>from master.dbo.sysprocesses p</li>
<li>cross apply sys.dm_exec_sql_text(p.sql_handle) s</li>
<li>where nt_username=’cdwbcb’</li>
</ol>
<p>找到相关数据：<img src="http://img.blog.csdn.net/20150706112721177?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt> 数据库中保持了该用户的6个连接会话。奇怪的是，这些session的事务已经关闭（open_tran=0），处于空闲状态（status=sleeping），但是仍有命令等待执行（cmd=AWAITING COMMAND）！如果 open_tran=1 还可以理解，这个就无法解释了。但是产生这种情况，应该就是应用层方面的逻辑没处理好了。 暂时的解决方法：kill 该账户的几个会话。执行后很快降下来！ <img src="http://img.blog.csdn.net/20150706115607371?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt></p>
</blockquote>

            
            <p class="more">
                <a href="/2015/07/06/2019030500168/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2015/07/06/2019030500168/" title="SqlServer 批处理（Batch Requests/sec）过高追踪处理">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/6.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/SQL-Server/">SQL Server</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2015/06/25/2019030500163/">
    		SQL Server &#39;已超过了锁请求超时时段&#39; 问题解决方法
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2015-06-25T09:24:25.000Z">2015-06-25</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/SQL-Server/" title="SQL Server">SQL Server</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <p>SQL 有时遇到 <strong>已超过了锁请求超时时段。 (Microsoft SQL Server，错误: 1222)</strong> 这个错误，刷新以后，右击某张表或者库，发现里面的表全部消失了 或者查询不到。 这是因为 sql进程死锁，资源被抢占，要解决这个问题，得杀死关闭 死锁的进程，下面介绍解决方案：</p>
<hr>
<p>杀死进程的前提是找到 那个死锁的进程 ，</p>
<pre><code>SELECT blocking_session_id &apos;阻塞进程的ID&apos;, wait_duration_ms &apos;等待时间(毫秒)&apos;, session_id &apos;(会话ID)&apos; FROM sys.dm_os_waiting_tasks
</code></pre><p>这句sql就可以查询到当前阻塞进程的ID 下面只要杀死这些进程就可以了 kill spid(进程ID) 或者 exec(‘kill’ ‘spid’) 这样就可以了 重新刷新下 库 一切正常了 顺便介绍下相关内容的另外两个sql：</p>
<pre><code>--查询当前活动的锁管理器资源的信息  
SELECT resource_type &apos;资源类型&apos;,request_mode &apos;请求模式&apos;,request_type &apos;请求类型&apos;,request_status &apos;请求状态&apos;,request_session_id &apos;会话ID&apos; FROM sys.dm_tran_locks

--查询数据库进程（where 筛选库）
select spId  from master..SysProcesses
where db_Name(dbID) = &apos;text&apos; and spId &lt;&gt; @@SpId and dbID &lt;&gt; 0
</code></pre>
            
            <p class="more">
                <a href="/2015/06/25/2019030500163/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2015/06/25/2019030500163/" title="SQL Server &#39;已超过了锁请求超时时段&#39; 问题解决方法">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/5.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/SQL-Server/">SQL Server</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2015/06/24/2019030500155/">
    		SQL 2008 R2数据库变为REPLICATION，日志不断增长而且不能截断和收缩的解决方案
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2015-06-24T04:23:12.000Z">2015-06-24</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/REPLICATION/" title="REPLICATION">REPLICATION</a> / 
    
        <a href="/tags/server2003/" title="server2003">server2003</a> / 
    
        <a href="/tags/server2008/" title="server2008">server2008</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <p><strong>运行环境：windows server2003，sql server2008 R2，数据库上布置CDC</strong>  用户反应系统报错是日志已满，系统不能运行。查看日志文件时，发现日志文件已经达到15G，后来为了解决问题，干脆把数据库移到另一个F盘，D盘专门放日志文件，空间有80G。当时想这80G至少保证系统运行一周吧！谁知道系统刚运行两天，日志文件已爆涨到80G，D盘空间仅剩余10MB，数据库做任何动作都不可以。又一次为了应急把日志文件直接删除（先停掉服务，删除日所文件，再通过DBCC CheckDB()命令检查数据库一致性问题），系统恢复了正常。</p>
<p>这时空间是有了，但是问题依旧没有解决，但是日志文件依然猛涨，以前用的截断和收缩日志方法完全不起作用？</p>
<p><strong>解决方法：</strong></p>
<p><strong>步骤一：</strong></p>
<p>查看日志信息，在查询分析器中执行如下代码来查看日志信息：</p>
<p>DBCC LOGINFO(‘数据库名称’)</p>
<p>可以看到status=0的日志，代表已经备份到磁盘的日志文件；而status=2的日志还没有备份。当收缩日志文件时，收缩掉的空间其实就是 status=0的空间，如果日志物理文件无法减小，这里一定能看到非常多status=2的记录。</p>
<p><strong>步骤二：</strong></p>
<p>查看日志不能截断原因</p>
<p>活跃(active)的日志无法通过收缩来截断，有各种原因会使日志截断延迟，具体表现就是事务日志的物理文件无法通过截断、收缩来减小，通过下面的代码可以看到实例上每个数据库的日志截断延迟原因：</p>
<p>usemaster</p>
<p>go</p>
<p>select* from sys.databases 发现当前数据库的log_reuse_wait_desc的值为REPLICATION，其他数据库的log_reuse_wait_desc值为LOG_BACKUP、NOTHING…  </p>
<p>log_reuse_wait_desc值的各种原因及解释如下：</p>
<p><strong>NOTHING</strong></p>
<p>当前有一个或多个可重复使用的虚拟日志文件。</p>
<p><strong>CHECKPOINT</strong></p>
<p>自上次日志截断之后，尚未出现检查点，或者日志头部尚未跨一个虚拟日志文件移动（所有恢复模式）。这是日志截断延迟的常见原因。</p>
<p><strong>LOG_BACKUP</strong></p>
<p>需要日志备份，以将日志的头部前移（仅适用于完整恢复模式或大容量日志恢复模式）。</p>
<p>注意：日志备份不会妨碍截断。</p>
<p>完成日志备份后，日志的头部将前移，一些日志空间可能变为可重复使用。</p>
<p><strong>ACTIVE_BACKUP_OR_RESTORE</strong></p>
<p>数据备份或还原正在进行（所有恢复模式）。</p>
<p>数据备份与活动事务的运行方式相同。数据备份在运行时，将阻止截断。</p>
<p><strong>ACTIVE_TRANSACTION</strong></p>
<p>事务处于活动状态（所有恢复模式）。一个长时间运行的事务可能存在于日志备份的开头。在这种情况下，可能需要进行另一个日志备份才能释放空间。</p>
<p>事务被延迟（仅适用于 SQL Server 2005 Enterprise Edition及更高版本）。“延迟的事务” 是有效的活动事务，因为某些资源不可用，其回滚受阻。</p>
<p><strong>DATABASE_MIRRORING</strong></p>
<p>数据库镜像暂停，或者在高性能模式下，镜像数据库明显滞后于主体数据库（仅限于完整恢复模式）。</p>
<p><strong>REPLICATION</strong></p>
<p>在事务复制过程中，与发布相关的事务仍未传递到分发数据库（仅限于完整恢复模式）。</p>
<p><strong>DATABASE_SNAPSHOT_CREATION</strong></p>
<p>正在创建数据库快照（所有恢复模式）。</p>
<p>这是日志截断延迟的常见原因，通常也是主要原因。</p>
<p><strong>LOG_SCAN</strong></p>
<p>正在进行日志扫描（所有恢复模式）。</p>
<p>这是日志截断延迟的常见原因，通常也是主要原因。</p>
<p>针对延迟日志截断原因的部分解决方案，</p>
<p>LOG_BACKUP</p>
<p>备份日志后再执行收缩即可。</p>
<p><strong>REPLICATION</strong></p>
<p>这是我遇到的情况，但我根本没有启用过REPLICATION，是已离职同事原来创建一个复制数据库，后来没有删除干净而导致。还有另一说法，这好像是SQLSERVER2008的一个BUG，解决方法是给标有“REPLICATION”的数据库任意一个表创建数据库事务复制（TRANSACTIONREPLICATION），然后再删除，执行数据库与日志备份后，就可以收缩了。</p>
<p><strong>注明：</strong>在创建数据库复制时，我也遇到了一个大麻烦，提示：在执行 xp_cmdshell 的过程中出错。调用 ‘CreateProcess’ 失败，错误代码: ‘5’。使用了各种方法，均无效果。后来在网上找一个帖子说有可能是系统安装360的原因而导致，我就把把360先停掉，结果真的解决问题了。</p>

            
            <p class="more">
                <a href="/2015/06/24/2019030500155/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2015/06/24/2019030500155/" title="SQL 2008 R2数据库变为REPLICATION，日志不断增长而且不能截断和收缩的解决方案">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/4.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/SQL-Server/">SQL Server</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2015/06/16/2019030500046/">
    		Execl数据导入SQL Server
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2015-06-16T05:29:17.000Z">2015-06-16</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/Execl/" title="Execl">Execl</a> / 
    
        <a href="/tags/SQL-Server/" title="SQL Server">SQL Server</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <p>将execl表格 数据导入进数据库 可以指定列 也可以 * <strong>注意：</strong>该语句只能在本地数据库执行 如果连接的是远程服务器 应到该服务器上执行语句 设置服务器全局配置 启用Ad Hoc Distributed Queries 该组件存在 安全隐患 所以默认是关闭</p>
<pre><code>exec sp_configure &apos;show advanced options&apos;,1
reconfigure
exec sp_configure &apos;Ad Hoc Distributed Queries&apos;,1
reconfigure
</code></pre><p>可以导入execl表格中指定列 到指定表中指定列</p>
<pre><code>insert into 表名(字段名)     
select  字段名（跟上面对应）
from OpenDataSource(&apos;Microsoft.Ace.OLEDB.12.0&apos;,&apos;Data Source=&quot;c:\文档名.xls&quot;;Extended properties=&quot;Excel 12.0;HDR=Yes&quot;&apos;)...[文档表名$]  go 
</code></pre><p>设置服务器全局配置 关闭Ad Hoc Distributed Queries</p>
<pre><code>exec sp_configure &apos;Ad Hoc Distributed Queries&apos;,0
reconfigure
exec sp_configure &apos;show advanced options&apos;,0
reconfigure
</code></pre>
            
            <p class="more">
                <a href="/2015/06/16/2019030500046/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2015/06/16/2019030500046/" title="Execl数据导入SQL Server">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/6.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    

    
    <nav class="page-navigator">
        <span class="page-number current">1</span><a class="page-number" href="/categories/SQL-Server/page/2/">2</a><a class="extend next" rel="next" href="/categories/SQL-Server/page/2/">后一页</a>
    </nav>
    


            </div>

        </section>
        <!-- 侧栏部分 -->
<aside class="sidebar">
    <section class="widget">
        <h3 class="widget-hd"><strong>文章分类</strong></h3>
        <!-- 文章分类 -->
<ul class="widget-bd">
    
    <li>
        <a href="/categories/MySQL/">MySQL</a>
        <span class="badge">(92)</span>
    </li>
    
    <li>
        <a href="/categories/Oracle/">Oracle</a>
        <span class="badge">(40)</span>
    </li>
    
    <li>
        <a href="/categories/NOSQL/">NOSQL</a>
        <span class="badge">(17)</span>
    </li>
    
    <li>
        <a href="/categories/开发语言/">开发语言</a>
        <span class="badge">(7)</span>
    </li>
    
    <li>
        <a href="/categories/SQL-Server/">SQL Server</a>
        <span class="badge">(13)</span>
    </li>
    
    <li>
        <a href="/categories/其他数据库/">其他数据库</a>
        <span class="badge">(4)</span>
    </li>
    
    <li>
        <a href="/categories/MySQL/Oracle/">Oracle</a>
        <span class="badge">(3)</span>
    </li>
    
    <li>
        <a href="/categories/MySQL/Oracle/SQL-Server/">SQL Server</a>
        <span class="badge">(1)</span>
    </li>
    
    <li>
        <a href="/categories/NOSQL/开发语言/">开发语言</a>
        <span class="badge">(1)</span>
    </li>
    
</ul>
    </section>

    
    <section class="widget">
        <h3 class="widget-hd"><strong>热门标签</strong></h3>
        <!-- 文章标签 -->
<div class="widget-bd tag-wrap">
  
    <a class="tag-item" href="/tags/MySQL/" title="MySQL">MySQL (71)</a>
  
    <a class="tag-item" href="/tags/位运算/" title="位运算">位运算 (0)</a>
  
    <a class="tag-item" href="/tags/sqlplus/" title="sqlplus">sqlplus (1)</a>
  
    <a class="tag-item" href="/tags/PL-SQL/" title="PL/SQL">PL/SQL (5)</a>
  
    <a class="tag-item" href="/tags/数据库/" title="数据库">数据库 (7)</a>
  
    <a class="tag-item" href="/tags/视图/" title="视图">视图 (1)</a>
  
    <a class="tag-item" href="/tags/B-Tree/" title="B+Tree">B+Tree (1)</a>
  
    <a class="tag-item" href="/tags/索引/" title="索引">索引 (1)</a>
  
    <a class="tag-item" href="/tags/redis/" title="redis">redis (6)</a>
  
    <a class="tag-item" href="/tags/SSDB/" title="SSDB">SSDB (1)</a>
  
    <a class="tag-item" href="/tags/SQL/" title="SQL">SQL (17)</a>
  
    <a class="tag-item" href="/tags/ORA-00600/" title="ORA-00600">ORA-00600 (1)</a>
  
    <a class="tag-item" href="/tags/存储过程/" title="存储过程">存储过程 (3)</a>
  
    <a class="tag-item" href="/tags/CentOS/" title="CentOS">CentOS (2)</a>
  
    <a class="tag-item" href="/tags/allow/" title="allow">allow (1)</a>
  
    <a class="tag-item" href="/tags/Apache/" title="Apache">Apache (1)</a>
  
    <a class="tag-item" href="/tags/deny/" title="deny">deny (1)</a>
  
    <a class="tag-item" href="/tags/druid/" title="druid">druid (1)</a>
  
    <a class="tag-item" href="/tags/心跳/" title="心跳">心跳 (1)</a>
  
    <a class="tag-item" href="/tags/事务/" title="事务">事务 (5)</a>
  
    <a class="tag-item" href="/tags/分布式/" title="分布式">分布式 (1)</a>
  
    <a class="tag-item" href="/tags/消息/" title="消息">消息 (1)</a>
  
    <a class="tag-item" href="/tags/KeepAlived/" title="KeepAlived">KeepAlived (1)</a>
  
    <a class="tag-item" href="/tags/Oracle/" title="Oracle">Oracle (30)</a>
  
    <a class="tag-item" href="/tags/schedule-job/" title="schedule job">schedule job (1)</a>
  
    <a class="tag-item" href="/tags/分库/" title="分库">分库 (1)</a>
  
    <a class="tag-item" href="/tags/分库分表/" title="分库分表">分库分表 (1)</a>
  
    <a class="tag-item" href="/tags/分表/" title="分表">分表 (1)</a>
  
    <a class="tag-item" href="/tags/结构同步/" title="结构同步">结构同步 (1)</a>
  
    <a class="tag-item" href="/tags/批量/" title="批量">批量 (1)</a>
  
    <a class="tag-item" href="/tags/truncate/" title="truncate">truncate (1)</a>
  
    <a class="tag-item" href="/tags/Hash索引/" title="Hash索引">Hash索引 (1)</a>
  
    <a class="tag-item" href="/tags/InnoDB/" title="InnoDB">InnoDB (3)</a>
  
    <a class="tag-item" href="/tags/MyISAM/" title="MyISAM">MyISAM (3)</a>
  
    <a class="tag-item" href="/tags/索引优化/" title="索引优化">索引优化 (1)</a>
  
    <a class="tag-item" href="/tags/FineReport/" title="FineReport">FineReport (1)</a>
  
    <a class="tag-item" href="/tags/报表/" title="报表">报表 (1)</a>
  
    <a class="tag-item" href="/tags/数据集/" title="数据集">数据集 (1)</a>
  
    <a class="tag-item" href="/tags/Excel/" title="Excel">Excel (1)</a>
  
</div>
    </section>
    

    

    
    <!-- 友情链接 -->
    <section class="widget">
        <h3 class="widget-hd"><strong>友情链接</strong></h3>
        <!-- 文章分类 -->
<ul class="widget-bd">
    
        <li>
            <a href="https://jelon.top" target="_blank" title="Jelon个人前端小站">前端博客小站</a>
        </li>
    
        <li>
            <a href="https://www.baidu.com" target="_blank" title="百度搜索">百度</a>
        </li>
    
</ul>
    </section>
    
</aside>
<!-- / 侧栏部分 -->
    </div>

    <!-- 博客底部 -->
    <footer class="footer">
    &copy;
    
        2016-2019
    

    <a href="/">Jelon Loves You</a>
</footer>
<div class="back-to-top" id="JELON__backToTop" title="返回顶部">返回顶部</div>

    <!--博客js脚本 -->
    <!-- 这里放网站js脚本 -->
<script src="/js/main.js"></script>
</body>
</html>