<!doctype html>
<html lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=11,IE=10,IE=9,IE=8">
    <meta name="baidu-site-verification" content="dIcXMeY8Ya">
    
    <title>`MySQL`分类下的文章 | 软件开发吧</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
    <meta name="keywords" content="Jelon, 前端, Web, 张德龙, 前端开发">
    <meta name="description" content="Jelon个人前端小站">

    
    <link rel="alternative" href="/atom.xml" title="软件开发吧" type="application/atom+xml">
    
    
    <link rel="shortcut icon" href="/favicon.ico">
    
    <link rel="stylesheet" href="/css/style.css">
    <!--[if lt IE 9]>
    <script src="/js/html5.js"></script>
    <![endif]-->
    
<script>
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "//hm.baidu.com/hm.js?fd459238242776d173cdc64918fb32f2";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>


</head>
</html>
<body class="home">
    <!--[if lt IE 9]>
    <div class="browsehappy">
        当前网页 <strong>不支持</strong>
        你正在使用的浏览器. 为了正常的访问, 请 <a href="http://browsehappy.com/">升级你的浏览器</a>.
    </div>
    <![endif]-->

    <!-- 博客头部 -->
    <header class="header">
    <section class="container header-main">
        <div class="logo">
            <a href="/">
                <div class="cover">
                    <span class="name">软件开发吧</span>
                    <span class="description"></span>
                </div>
            </a>
        </div>
        <div class="dropnav icon-paragraph-justify" id="JELON__btnDropNav"></div>
        <ul class="menu hidden" id="JELON__menu">
            
            <li rel="/categories/MySQL/page/9/index.html" class="item ">
                <a href="/" title="首页" class="icon-home">&nbsp;首页</a>
            </li>
            
            <li rel="/categories/MySQL/page/9/index.html" class="item ">
                <a href="/lab/" title="实验室" class="icon-lab">&nbsp;实验室</a>
            </li>
            
            <li rel="/categories/MySQL/page/9/index.html" class="item ">
                <a href="/about/" title="关于" class="icon-about">&nbsp;关于</a>
            </li>
            
            <li rel="/categories/MySQL/page/9/index.html" class="item ">
                <a href="/comment/" title="留言" class="icon-comment">&nbsp;留言</a>
            </li>
            
        </ul>
        <div class="profile clearfix">
            <div class="feeds fl">
                
                
                <p class="links">
                    
                        <a href="https://github.com/jangdelong" target="_blank">Github</a>
                        |
                    
                        <a href="https://pages.coding.me" target="_blank">Hosted by Coding Pages</a>
                        
                    
                </p>
                <p class="sns">
                    
                        <a href="http://weibo.com/jangdelong" class="sinaweibo" target="_blank"><b>■</b> 新浪微博</a>
                    
                        <a href="https://www.facebook.com/profile.php?id=100011855760219&amp;ref=bookmarks" class="qqweibo" target="_blank"><b>■</b> Facebook</a>
                    
                    <a href="javascript: void(0);" class="wechat">
                        <b>■</b>
                        公众号
                        <span class="popover">
                            <img src="/img/wechat_mp.jpg" width="120" height="120" alt="我的微信订阅号">
                            <i class="arrow"></i>
                        </span>
                    </a>
                </p>
                
            </div>
            <div class="avatar fr">
                <img src="/img/jelon.jpg" alt="avatar" title="Jelon">
            </div>
        </div>
    </section>
</header>


    <!-- 博客正文 -->
    <div class="container body clearfix">
        <section class="content">
            <div class="content-main widget">
                <!-- 文章分类 -->

    <h3 class="widget-hd">
        <strong>
            
                `MySQL`分类下的文章
            
        </strong>
    </h3>
    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/MySQL/">MySQL</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2015/06/08/2019030500028/">
    		数据库中为什么需要Implict Commit（隐式提交事务）
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2015-06-08T08:55:11.000Z">2015-06-08</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/Commit/" title="Commit">Commit</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <blockquote>
<p>先看一段SQL，最后一条SQL的输出你认为是什么？</p>
<ol>
<li>SET AUTOCOMMIT = 1;</li>
<li>BEGIN;</li>
<li>INSERT INTO t1 VALUES (1);</li>
<li>CREATE TABLE t2 (pk int primary key);</li>
<li>INSERT INTO t2 VALUES (2);</li>
<li>ROLLBACK;</li>
<li>SHOW TABLES;</li>
</ol>
<p>答案是：t1, t2都存在！</p>
<ol>
<li>mysql&gt; show tables;</li>
<li>+—————-+</li>
<li>| Tables_in_test |</li>
<li>+—————-+</li>
<li>| t1             |</li>
<li>| t2             |</li>
<li>+—————-+</li>
<li>2 rows in set (0.00 sec)</li>
</ol>
<p>更奇怪的是：t1中的1也插入成功了！</p>
<ol>
<li>mysql&gt; select * from t1;</li>
<li>+—-+</li>
<li>| pk |</li>
<li>+—-+</li>
<li>|  1 |</li>
<li>+—-+</li>
<li>1 row in set (0.00 sec)</li>
</ol>
<p>为什么ROLLBACK没有生效呢？答案是：<strong>Implict Commit</strong> 执行CREATE TABLE语句前，之前的事务被隐式提交。因为AUTOCOMMIT=1，所以提交后也不会自动新创建任何事务，INSERT语句执行后立即提交，ROLLBACK不会作用在任何事务上，所以得到了我们最后看到的结果。稍微改一下，让AUTOCOMMIT=0，会怎样呢？</p>
<ol>
<li>SET AUTOCOMMIT = 0;</li>
<li>BEGIN;</li>
<li>INSERT INTO t1 VALUES (1);</li>
<li>CREATE TABLE t2 (pk int primary key);</li>
<li>INSERT INTO t2 VALUES (2);</li>
<li>ROLLBACK;</li>
<li>SHOW TABLES;</li>
</ol>
<p>答案是：t1, t2都存在！插入到t1中的1被提交（插入成功）但插入到t2中得2被回滚（没有插入成功）。之所以t1中的1被提交，是因为CREATE TABLE导致Implict<strong>COMMIT（注意，是COMMIT，不是ROLLBACK哦！)，执行INSERT的时候，会自动开启一个新事务（AUTOCOMMIT=0的语义要求的行为）。所以t2中的2被ROLLBACK回滚。</strong> <strong>为什么部分操作会导致Implict Commit？为什么这样设计？ 为了保证直观上的原子性。假设不做Implict Commit，看看上面的语句会怎样：用户的心理预期是回滚t1的INSERT操作，以及t2的CREATE操作，INSERT操作。如果我们有能力做到这样，那的确是很完美的。但实际上我们很难做到，特别是在分布式系统中更难！因为CREATE TABLE操作背后涉及到了大量的操作，不仅仅包括对核心表的操作，还包括大量内存数据结构的更新（如Schema），以及存储系统的变更（如创建相应的数据块），工程上很难把这些操作做成原子的。</strong> <strong>那么，应该如何做呢？比较折中的方式就是跟用户做一个约定：CREATE TABLE操作总默认COMMIT它之前的事务，这就是implict commit。</strong> 从MySQL文档看，他们做这一块的时候遇到了很多问题，至少在这里踩过两个坑。并且，随着版本的进化，他们还不断的让更多语句能引发implict commit。到底哪些语句会引发implict commit，请参考MySQL文档： <a href="http://dev.mysql.com/doc/refman/5.1/en/implicit-commit.html" target="_blank" rel="noopener">http://dev.mysql.com/doc/refman/5.1/en/implicit-commit.html</a></p>
</blockquote>

            
            <p class="more">
                <a href="/2015/06/08/2019030500028/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2015/06/08/2019030500028/" title="数据库中为什么需要Implict Commit（隐式提交事务）">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/8.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/MySQL/">MySQL</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2015/06/08/2019030500005/">
    		centos6.5安装mysql5.6
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2015-06-08T08:35:13.000Z">2015-06-08</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/MySQL/" title="MySQL">MySQL</a> / 
    
        <a href="/tags/CentOS/" title="CentOS">CentOS</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <h4 id="1-先查看版本号"><a href="#1-先查看版本号" class="headerlink" title="1. 先查看版本号"></a>1. 先查看版本号</h4><pre><code># uname -a
</code></pre><h4 id="2-下载并安装Mysql的yum仓库"><a href="#2-下载并安装Mysql的yum仓库" class="headerlink" title="2. 下载并安装Mysql的yum仓库"></a>2. 下载并安装Mysql的yum仓库</h4><p>下载Mysql的yum仓库 <a href="http://dev.mysql.com/downloads/repo/yum/" target="_blank" rel="noopener">http://dev.mysql.com/downloads/repo/yum/</a> 然后安装一下这个仓库列表</p>
<pre><code>$ sudo yum localinstall mysql-community-release-el6-5.noarch.rpm 
</code></pre><h4 id="3-搜索可安装的mysql版本"><a href="#3-搜索可安装的mysql版本" class="headerlink" title="3. 搜索可安装的mysql版本"></a>3. 搜索可安装的mysql版本</h4><p>执行这个命令后就能看到可安装的mysql：</p>
<pre><code># yum repolist enabled | grep &quot;mysql.*-community.*&quot;
</code></pre><p>如果我们是要安装最新的版本，那么可以直接执行</p>
<pre><code># sudo yum install mysql-community-server
</code></pre><p>如果我们要选择版本，可以先执行下面这个命令查看一下有哪些版本：</p>
<pre><code># yum repolist all | grep mysql
</code></pre><p>如果要选择版本的话，有两种方式，一种是使用命令来</p>
<pre><code>$ sudo yum-config-manager --disable mysql56-community
$ sudo yum-config-manager --enable mysql57-community-dmr
</code></pre><p>这个命令就是在仓库中启用5.7版本的，禁用5.6版本子仓库 或者编辑/etc/yum.repos.d/mysql-community.repo文件</p>
<pre><code># Enable to use MySQL 5.6
[mysql56-community]
name=MySQL 5.6 Community Server
baseurl=//repo.mysql.com/yum/mysql-5.6-community/el/5/$basearch/
enabled=1
gpgcheck=1
gpgkey=file:/etc/pki/rpm-gpg/RPM-GPG-KEY-mysql 
</code></pre><p>enabled=0表示禁用 比如要安装5.7版本的mysql，要确定5.6的enabled=0，5.7的enabled=1，一次保证只启用一个子仓库</p>
<pre><code># Note: MySQL 5.7 is currently in development. For use at your own risk.
# Please read with sub pages: https://dev.mysql.com/doc/relnotes/mysql/5.7/en/
[mysql57-community-dmr]
name=MySQL 5.7 Community Server Development Milestone Release
baseurl=http://repo.mysql.com/yum/mysql-5.7-community/el/6/$basearch/
enabled=1
gpgcheck=1
gpgkey=file:/etc/pki/rpm-gpg/RPM-GPG-KEY-mysql
</code></pre><p>然后我们又可以愉快的安装mysql了</p>
<pre><code>$ sudo yum install mysql-community-server
</code></pre><p>安装完成后我们启动mysql</p>
<pre><code>$ sudo service mysqld start
</code></pre><p>查看mysql状态</p>
<pre><code>$ sudo service mysqld status
</code></pre><p>启动mysql服务并初始化：</p>
<pre><code># /etc/init.d/mysqld start
Initializing MySQL database: 
PLEASE REMEMBER TO SET A PASSWORD FOR THE MySQL root USER !
To do so, start the server, then issue the following commands:

/usr/bin/mysqladmin -u root password &apos;new-password&apos;
/usr/bin/mysqladmin -u root -h iZ94vana2fdZ password &apos;new-password&apos;

Alternatively you can run:
/usr/bin/mysql_secure_installation

which will also give you the option of removing the test
databases and anonymous user created by default. This is
strongly recommended for production servers.

See the manual for more instructions.

Please report any problems at http://bugs.mysql.com/

[ OK ]
Starting mysqld: [ OK ]
</code></pre><h4 id="4-相关命令"><a href="#4-相关命令" class="headerlink" title="4. 相关命令"></a>4. 相关命令</h4><p>启动mysql服务</p>
<pre><code># service mysqld start
</code></pre><p>重启mysql服务</p>
<pre><code># service mysqld restart
</code></pre><p>停止mysql服务</p>
<pre><code># service mysqld stop
</code></pre>
            
            <p class="more">
                <a href="/2015/06/08/2019030500005/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2015/06/08/2019030500005/" title="centos6.5安装mysql5.6">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/8.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/MySQL/">MySQL</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2015/06/04/2019030500040/">
    		简单查询部分sql练习题
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2015-06-04T05:30:59.000Z">2015-06-04</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/SQL/" title="SQL">SQL</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <p>简单查询部分sql练习题:</p>
<ol>
<li>– 选择部门30中的所有职工</li>
<li><p>select * from emp where deptno = 30;</p>
</li>
<li><p>– 列出所有业务员(CLERK)的姓名，编号，和部门编号</p>
</li>
<li><p>select e.ename, e.empno, e.deptno from emp e where e.job = ‘CLERK’;</p>
</li>
<li><p>– 找出奖金高于薪金的员工</p>
</li>
<li><p>select * from emp where comm &gt; sal;</p>
</li>
<li><p>– 找出奖金高于薪金的60%的员工</p>
</li>
<li><p>select <em> from emp where comm &gt; sal </em> 0.6;</p>
</li>
<li><p>– 找出部门10中所有经理(MANAGER)和部门20中所有业务员(CLERK)的详细资料</p>
</li>
<li>select * from emp e</li>
<li>where e.deptno = 10 and e.job = ‘MANAGER’</li>
<li><p>or e.deptno = 20 and e.job = ‘CLERK’;</p>
</li>
<li><p>select * from emp e</p>
</li>
<li>where (e.deptno = 10 and e.job = ‘MANAGER’)</li>
<li><p>or (e.deptno = 20 and e.job = ‘CLERK’);</p>
</li>
<li><p>select * from emp e where e.deptno = 10 and e.job = ‘MANAGER’</p>
</li>
<li>union</li>
<li><p>select * from emp e where e.deptno = 20 and e.job = ‘CLERK’;</p>
</li>
<li><p>– 找出部门10中所有经理(MANAGER),部门20中所有业务员(CLERK),既不是经理又不是业务员但其薪水大于等于2000的所有员工的详细资料</p>
</li>
<li>select * from emp e where e.deptno = 10 and e.job = ‘MANAGER’</li>
<li>union</li>
<li>select * from emp e where e.deptno = 20 and e.job = ‘CLERK’</li>
<li>union</li>
<li><p>select * from emp e where e.sal &gt; 2000 and e.job not in(‘MANAGER’, ‘CLERK’);</p>
</li>
<li><p>– 找出收取奖金的员工的不同工作</p>
</li>
<li><p>select distinct e.job from emp e;</p>
</li>
<li><p>– 找出不收取奖金或收取的奖金低于100的员工</p>
</li>
<li><p>select * from emp e where e.comm is null or e.comm &lt; 100;</p>
</li>
<li><p>– 找出各月倒数第3天受雇的所有员工</p>
</li>
<li><p>select * from emp e where e.hiredate between last_day(hiredate)-3 and last_day(hiredate);</p>
</li>
<li><p>– 找出早于30年前受雇的员工</p>
</li>
<li><p>select * from emp e where (sysdate - e.hiredate)/365 &gt; 30;</p>
</li>
<li><p>– 以首字母大写的方式显示所有员工的姓名</p>
</li>
<li><p>select initcap(ename) from emp;</p>
</li>
<li><p>– 显示正好为5个字符的员工姓名</p>
</li>
<li><p>select * from emp where length(ename) = 5;</p>
</li>
<li><p>– 显示不带有”R”的员工姓名</p>
</li>
<li><p>select * from emp where ename not like ‘%K%’;</p>
</li>
<li><p>– 显示所有员工姓名的前三个字符</p>
</li>
<li><p>select substr(ename, 0, 3) from emp;</p>
</li>
<li><p>– 显示所有员工的姓名，并用’a’替换所有’A’</p>
</li>
<li><p>select replace(ename, ‘A’, ‘a’) from emp;</p>
</li>
<li><p>– 显示满30年服务年限的员工姓名和受雇日期</p>
</li>
<li><p>select * from emp where (sysdate - hiredate)/365 &gt; 30;</p>
</li>
<li><p>– 显示员工的详细资料，按姓名由大到小排序</p>
</li>
<li><p>select * from emp order by ename desc;</p>
</li>
<li><p>– 显示员工的姓名和受雇日期，根据其服务年限，将最老的员工排在最前面</p>
</li>
<li><p>select ename, hiredate from emp order by hiredate asc;</p>
</li>
<li><p>– 显示所有员工的姓名，工作和薪金，按工作降序排列，若工作相同则按薪金升序排序</p>
</li>
<li>select ename, job, sal from emp order by job desc, sal asc;</li>
<li><p>select ename, job, sal from emp order by 2 desc, 3;</p>
</li>
<li><p>– 显示所有员工的姓名，加入公司的年份和月份，按受雇日期所在的月排序，若月份相同，则将最早年份排在最前面</p>
</li>
<li><p>select ename, to_number(to_char(hiredate, ‘yyyy’)) Year, to_number(to_char(hiredate, ‘mm’)) from emp order by 3 desc, 2 asc;</p>
</li>
<li><p>– 显示一个月为30天的情况所员工的日薪金，忽略余数</p>
</li>
<li><p>select round(sal/30) 日薪 from emp;</p>
</li>
<li><p>– 找出在(任何年份)2月受聘的所有员工</p>
</li>
<li><p>select * from emp where to_number(to_char(hiredate, ‘mm’)）= 2;</p>
</li>
<li><p>– 对每个员工，显示其加入公司的天数</p>
</li>
<li><p>select ename, round(sysdate - hiredate) Days from emp;</p>
</li>
<li><p>– 显示姓名中任意位置包含“A”的所有员工姓名</p>
</li>
<li><p>select * from emp where upper(ename) like ‘%A%’;</p>
</li>
<li><p>– 以年月日方式显示所有员工的服务年限</p>
</li>
<li>select ename, hiredate,</li>
<li>trunc(months_between(sysdate, hiredate) /12)  year  ,</li>
<li>trunc(mod(months_between(sysdate, hiredate) ,  12 ) ) months  ,</li>
<li>trunc(sysdate - add_months(hiredate,months_between(sysdate, hiredate))) day</li>
<li>from emp ;</li>
</ol>

            
            <p class="more">
                <a href="/2015/06/04/2019030500040/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2015/06/04/2019030500040/" title="简单查询部分sql练习题">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/4.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/MySQL/">MySQL</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2015/06/02/2019030500173/">
    		win7 64位安装mysql
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2015-06-02T07:37:32.000Z">2015-06-02</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/MySQL/" title="MySQL">MySQL</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <blockquote>
<p>版本：mysql官网，下载win7-64位的mysql服务端安装包。 解压：C:\Program Files\mysql\mysql-5.6.25-winx64。 配置环境变量：MYSQL_HOME=C:\Program Files\mysql\mysql-5.6.25-winx64，添加到Path中：%MYSQL_HOME%/bin 配置：更改my-default.ini文件名为my.ini，在[mysqld]下面添加一行编码：character-set-server = gbk 添加3个服务启动参数： basedir = C:/Program Files/mysql/mysql-5.6.25-winx64/ datadir = C:/Program Files/mysql/mysql-5.6.25-winx64/data/ tmpdir = C:/Program Files/mysql/mysql-5.6.25-winx64/temp/ user=mysql 此时安装mysql，命令：mysqld –install MySQL –defaults-file=”my.ini” 启动mysql，命令：net start MySQL 会发现报错“无法启动 发生系统错误2”，是因为免安装，系统不知道配置文件加载路径，系统默认加载了一个不存在的路径， 所以需要更改路径，进到注册表： HKEY_LOCAL_MACHINE-SYSTEM-CurrentControlSet-services-mysql(服务名)-ImagePath 讲值改为：”C:\Program Files\mysql\mysql-5.6.25-winx64\bin\mysqld” –defaults-file=”C:\Program Files\mysql\mysql-5.6.25-winx64\my.ini” MySQL 再次执行命令：net start MySQL，如果参数都配置正确，切tmpdir路径已经存在，则启动成功； 反之报错，修改参数，重新启动即可。 注意：datadir位安装包解压出来的data目录，tmpdir目录必须存在，mysql启动时会检查目录是否存在，不会自动创建。</p>
<h3 id="MySQL服务的启动、停止与卸载"><a href="#MySQL服务的启动、停止与卸载" class="headerlink" title="MySQL服务的启动、停止与卸载"></a>MySQL服务的启动、停止与卸载</h3><p>在 Windows 命令提示符下运行: <strong>启动:</strong> net start MySQL <strong>停止:</strong> net stop MySQL <strong>卸载:</strong> sc delete MySQL</p>
</blockquote>

            
            <p class="more">
                <a href="/2015/06/02/2019030500173/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2015/06/02/2019030500173/" title="win7 64位安装mysql">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/2.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/MySQL/">MySQL</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2015/06/02/2019030500079/">
    		mysql存储过程事务回滚
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2015-06-02T04:58:26.000Z">2015-06-02</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/MySQL/" title="MySQL">MySQL</a> / 
    
        <a href="/tags/存储过程/" title="存储过程">存储过程</a> / 
    
        <a href="/tags/事务/" title="事务">事务</a> / 
    
        <a href="/tags/回滚/" title="回滚">回滚</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <blockquote>
<p>SQL过程代码：</p>
<p><strong>[sql]</strong></p>
<ol>
<li><p>DELIMITER $$</p>
</li>
<li><p>CREATE DEFINER=`root`@`localhost` PROCEDURE `test_procedure`()</p>
</li>
<li>BEGIN</li>
<li>DECLARE errno int;</li>
<li>declare continue HANDLER for sqlexception</li>
<li>begin</li>
<li>rollback;</li>
<li>set errno=1;</li>
<li>end;</li>
<li>start transaction;</li>
<li>set errno=0;</li>
<li>insert into test(name) values (‘kaka’);</li>
<li>insert into test(id, name) values(1,’papa’);</li>
<li>commit;</li>
<li>select errno;</li>
<li>END</li>
</ol>
<p>过程说明： 1、首先表中已经存在一条记录(1,’baby’)； 2、调用测试存储过程； 3、该过程首先声明error变量，和一个SQL异常处理handler，该handler触发时会回滚事务，并将error置为1； 事务开始，将error置为0，插入一条数据name为‘kaka’，再插入一条数据(1,’papa’)，然后提交； 但第二次插入数据时，主键id已存在，此处会报异常触发我们的SQL异常处理handler。实现回滚并将error置为1； 查看error值； 4、调用存储过程之后查看测试表中的数据是否回滚； 调用前： <img src="http://img.blog.csdn.net/20150601213911848?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc29tZV90aW1lcw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt> 调用中: <img src="http://img.blog.csdn.net/20150601213920210?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc29tZV90aW1lcw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt> 调用后： <img src="http://img.blog.csdn.net/20150601213927885?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc29tZV90aW1lcw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt> 建库SQL：</p>
<p><strong>[sql]</strong></p>
<ol>
<li>CREATE DATABASE  IF NOT EXISTS `test`;</li>
<li>USE `test`;</li>
<li>DROP TABLE IF EXISTS `test`;</li>
<li>CREATE TABLE `test` (</li>
<li>`id` int(11) NOT NULL AUTO_INCREMENT,</li>
<li><code>name</code> varchar(45) DEFAULT NULL,</li>
<li>PRIMARY KEY (`id`)</li>
<li>) ENGINE=InnoDB AUTO_INCREMENT=5 DEFAULT CHARSET=utf8;</li>
</ol>
<p>综上，可以通过在存储过程中声明异常处理handler使得我们的事物达到回滚效果。</p>
</blockquote>

            
            <p class="more">
                <a href="/2015/06/02/2019030500079/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2015/06/02/2019030500079/" title="mysql存储过程事务回滚">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/2.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/MySQL/">MySQL</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2015/05/28/2019030500001/">
    		50条SQL查询技巧
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2015-05-28T07:03:17.000Z">2015-05-28</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/SQL/" title="SQL">SQL</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <ol>
<li>Student(S#,Sname,Sage,Ssex) 学生表</li>
<li>Course(C#,Cname,T#) 课程表</li>
<li>SC(S#,C#,score) 成绩表</li>
<li><p>Teacher(T#,Tname) 教师表</p>
</li>
<li><p>问题：</p>
</li>
<li>1、查询“001”课程比“002”课程成绩高的所有学生的学号；</li>
<li>select a.S# from (select s#,score from SC where C#=’001’) a,(select s#,score</li>
<li>from SC where C#=’002’) b</li>
<li>where a.score&gt;b.score and a.s#=b.s#;</li>
<li>2、查询平均成绩大于60分的同学的学号和平均成绩；</li>
<li>select S#,avg(score)</li>
<li>from sc</li>
<li>group by S# having avg(score) &gt;60;</li>
<li>3、查询所有同学的学号、姓名、选课数、总成绩；</li>
<li>select Student.S#,Student.Sname,count(SC.C#),sum(score)</li>
<li>from Student left Outer join SC on Student.S#=SC.S#</li>
<li>group by Student.S#,Sname</li>
<li>4、查询姓“李”的老师的个数；</li>
<li>select count(distinct(Tname))</li>
<li>from Teacher</li>
<li>where Tname like ‘李%’;</li>
<li>5、查询没学过“叶平”老师课的同学的学号、姓名；</li>
<li>select Student.S#,Student.Sname</li>
<li>from Student</li>
<li>where S# not in (select distinct( SC.S#) from SC,Course,Teacher where SC.C#=Course.C# and Teacher.T#=Course.T# and Teacher.Tname=’叶平’);</li>
<li>6、查询学过“001”并且也学过编号“002”课程的同学的学号、姓名；</li>
<li>select Student.S#,Student.Sname from Student,SC where Student.S#=SC.S# and SC.C#=’001’and exists( Select * from SC as SC_2 where SC_2.S#=SC.S# and SC_2.C#=’002’);</li>
<li>7、查询学过“叶平”老师所教的所有课的同学的学号、姓名；</li>
<li>select S#,Sname</li>
<li>from Student</li>
<li>where S# in (select S# from SC ,Course ,Teacher where SC.C#=Course.C# and Teacher.T#=Course.T# and Teacher.Tname=’叶平’ group by S# having count(SC.C#)=(select count(C#) from Course,Teacher where Teacher.T#=Course.T# and Tname=’叶平’));</li>
<li>8、查询课程编号“002”的成绩比课程编号“001”课程低的所有同学的学号、姓名；</li>
<li>Select S#,Sname from (select Student.S#,Student.Sname,score ,(select score from SC SC_2 where SC_2.S#=Student.S# and SC_2.C#=’002’) score2</li>
<li>from Student,SC where Student.S#=SC.S# and C#=’001’) S_2 where score2 &lt;score;</li>
<li>9、查询所有课程成绩小于60分的同学的学号、姓名；</li>
<li>select S#,Sname</li>
<li>from Student</li>
<li>where S# not in (select Student.S# from Student,SC where S.S#=SC.S# and score&gt;60);</li>
<li>10、查询没有学全所有课的同学的学号、姓名；</li>
<li>select Student.S#,Student.Sname</li>
<li>from Student,SC</li>
<li><p>where Student.S#=SC.S# group by Student.S#,Student.Sname having count(C#) &lt;(select count(C#) from Course);</p>
</li>
<li><p>11、查询至少有一门课与学号为“1001”的同学所学相同的同学的学号和姓名；</p>
</li>
<li>select S#,Sname from Student,SC where Student.S#=SC.S# and C# in select C# from SC where S#=’1001’;</li>
<li>12、查询至少学过学号为“001”同学所有一门课的其他同学学号和姓名；</li>
<li>select distinct SC.S#,Sname</li>
<li>from Student,SC</li>
<li>where Student.S#=SC.S# and C# in (select C# from SC where S#=’001’);</li>
<li>13、把“SC”表中“叶平”老师教的课的成绩都更改为此课程的平均成绩；</li>
<li>update SC set score=(select avg(SC_2.score)</li>
<li>from SC SC_2</li>
<li>where SC_2.C#=SC.C# ) from Course,Teacher where Course.C#=SC.C# and Course.T#=Teacher.T# and Teacher.Tname=’叶平’);</li>
<li>14、查询和“1002”号的同学学习的课程完全相同的其他同学学号和姓名；</li>
<li>select S# from SC where C# in (select C# from SC where S#=’1002’)</li>
<li>group by S# having count(<em>)=(select count(</em>) from SC where S#=’1002’);</li>
<li>15、删除学习“叶平”老师课的SC表记录；</li>
<li>Delect SC</li>
<li>from course ,Teacher</li>
<li>where Course.C#=SC.C# and Course.T#= Teacher.T# and Tname=’叶平’;</li>
<li>16、向SC表中插入一些记录，这些记录要求符合以下条件：没有上过编号“003”课程的同学学号、2、</li>
<li>号课的平均成绩；</li>
<li>Insert SC select S#,’002’,(Select avg(score)</li>
<li>from SC where C#=’002’) from Student where S# not in (Select S# from SC where C#=’002’);</li>
<li>17、按平均成绩从高到低显示所有学生的“数据库”、“企业管理”、“英语”三门的课程成绩，按如下形式显示： 学生ID,,数据库,企业管理,英语,有效课程数,有效平均分</li>
<li>SELECT S# as 学生ID</li>
<li>,(SELECT score FROM SC WHERE SC.S#=t.S# AND C#=’004’) AS 数据库</li>
<li>,(SELECT score FROM SC WHERE SC.S#=t.S# AND C#=’001’) AS 企业管理</li>
<li>,(SELECT score FROM SC WHERE SC.S#=t.S# AND C#=’006’) AS 英语</li>
<li>,COUNT(*) AS 有效课程数, AVG(t.score) AS 平均成绩</li>
<li>FROM SC AS t</li>
<li>GROUP BY S#</li>
<li>ORDER BY avg(t.score)</li>
<li>18、查询各科成绩最高和最低的分：以如下形式显示：课程ID，最高分，最低分</li>
<li>SELECT L.C# As 课程ID,L.score AS 最高分,R.score AS 最低分</li>
<li>FROM SC L ,SC AS R</li>
<li>WHERE L.C# = R.C# and</li>
<li>L.score = (SELECT MAX(IL.score)</li>
<li>FROM SC AS IL,Student AS IM</li>
<li>WHERE L.C# = IL.C# and IM.S#=IL.S#</li>
<li>GROUP BY IL.C#)</li>
<li>AND</li>
<li>R.Score = (SELECT MIN(IR.score)</li>
<li>FROM SC AS IR</li>
<li>WHERE R.C# = IR.C#</li>
<li>GROUP BY IR.C#</li>
<li>);</li>
<li>19、按各科平均成绩从低到高和及格率的百分数从高到低顺序</li>
<li>SELECT t.C# AS 课程号,max(course.Cname)AS 课程名,isnull(AVG(score),0) AS 平均成绩</li>
<li>,100 <em> SUM(CASE WHEN isnull(score,0)&gt;=60 THEN 1 ELSE 0 END)/COUNT(</em>) AS 及格百分数</li>
<li>FROM SC T,Course</li>
<li>where t.C#=course.C#</li>
<li>GROUP BY t.C#</li>
<li>ORDER BY 100 <em> SUM(CASE WHEN isnull(score,0)&gt;=60 THEN 1 ELSE 0 END)/COUNT(</em>) DESC</li>
<li>20、查询如下课程平均成绩和及格率的百分数(用”1行”显示): 企业管理（001），马克思（002），OO&amp;UML （003），数据库（004）</li>
<li>SELECT SUM(CASE WHEN C# =’001’ THEN score ELSE 0 END)/SUM(CASE C# WHEN ‘001’ THEN 1 ELSE 0 END) AS 企业管理平均分</li>
<li>,100 * SUM(CASE WHEN C# = ‘001’ AND score &gt;= 60 THEN 1 ELSE 0 END)/SUM(CASE WHEN C# = ‘001’ THEN 1 ELSE 0 END) AS 企业管理及格百分数</li>
<li>,SUM(CASE WHEN C# = ‘002’ THEN score ELSE 0 END)/SUM(CASE C# WHEN ‘002’ THEN 1 ELSE 0 END) AS 马克思平均分</li>
<li>,100 * SUM(CASE WHEN C# = ‘002’ AND score &gt;= 60 THEN 1 ELSE 0 END)/SUM(CASE WHEN C# = ‘002’ THEN 1 ELSE 0 END) AS 马克思及格百分数</li>
<li>,SUM(CASE WHEN C# = ‘003’ THEN score ELSE 0 END)/SUM(CASE C# WHEN ‘003’ THEN 1 ELSE 0 END) AS UML平均分</li>
<li>,100 * SUM(CASE WHEN C# = ‘003’ AND score &gt;= 60 THEN 1 ELSE 0 END)/SUM(CASE WHEN C# = ‘003’ THEN 1 ELSE 0 END) AS UML及格百分数</li>
<li>,SUM(CASE WHEN C# = ‘004’ THEN score ELSE 0 END)/SUM(CASE C# WHEN ‘004’ THEN 1 ELSE 0 END) AS 数据库平均分</li>
<li>,100 * SUM(CASE WHEN C# = ‘004’ AND score &gt;= 60 THEN 1 ELSE 0 END)/SUM(CASE WHEN C# = ‘004’ THEN 1 ELSE 0 END) AS 数据库及格百分数</li>
<li><p>FROM SC</p>
</li>
<li><p>21、查询不同老师所教不同课程平均分从高到低显示</p>
</li>
<li>SELECT max(Z.T#) AS 教师ID,MAX(Z.Tname) AS 教师姓名,C.C# AS 课程ＩＤ,MAX(C.Cname) AS 课程名称,AVG(Score) AS 平均成绩</li>
<li>FROM SC AS T,Course AS C ,Teacher AS Z</li>
<li>where T.C#=C.C# and C.T#=Z.T#</li>
<li>GROUP BY C.C#</li>
<li>ORDER BY AVG(Score) DESC</li>
<li>22、查询如下课程成绩第 3 名到第 6 名的学生成绩单：企业管理（001），马克思（002），UML （003），数据库（004）</li>
<li>[学生ID],[学生姓名],企业管理,马克思,UML,数据库,平均成绩</li>
<li>SELECT DISTINCT top 3</li>
<li>SC.S# As 学生学号,</li>
<li>Student.Sname AS 学生姓名 ,</li>
<li>T1.score AS 企业管理,</li>
<li>T2.score AS 马克思,</li>
<li>T3.score AS UML,</li>
<li>T4.score AS 数据库,</li>
<li>ISNULL(T1.score,0) + ISNULL(T2.score,0) + ISNULL(T3.score,0) + ISNULL(T4.score,0) as 总分</li>
<li>FROM Student,SC LEFT JOIN SC AS T1</li>
<li>ON SC.S# = T1.S# AND T1.C# = ‘001’</li>
<li>LEFT JOIN SC AS T2</li>
<li>ON SC.S# = T2.S# AND T2.C# = ‘002’</li>
<li>LEFT JOIN SC AS T3</li>
<li>ON SC.S# = T3.S# AND T3.C# = ‘003’</li>
<li>LEFT JOIN SC AS T4</li>
<li>ON SC.S# = T4.S# AND T4.C# = ‘004’</li>
<li>WHERE student.S#=SC.S# and</li>
<li>ISNULL(T1.score,0) + ISNULL(T2.score,0) + ISNULL(T3.score,0) + ISNULL(T4.score,0)</li>
<li>NOT IN</li>
<li>(SELECT</li>
<li>DISTINCT</li>
<li>TOP 15 WITH TIES</li>
<li>ISNULL(T1.score,0) + ISNULL(T2.score,0) + ISNULL(T3.score,0) + ISNULL(T4.score,0)</li>
<li>FROM sc</li>
<li>LEFT JOIN sc AS T1</li>
<li>ON sc.S# = T1.S# AND T1.C# = ‘k1’</li>
<li>LEFT JOIN sc AS T2</li>
<li>ON sc.S# = T2.S# AND T2.C# = ‘k2’</li>
<li>LEFT JOIN sc AS T3</li>
<li>ON sc.S# = T3.S# AND T3.C# = ‘k3’</li>
<li>LEFT JOIN sc AS T4</li>
<li>ON sc.S# = T4.S# AND T4.C# = ‘k4’</li>
<li><p>ORDER BY ISNULL(T1.score,0) + ISNULL(T2.score,0) + ISNULL(T3.score,0) + ISNULL(T4.score,0) DESC);</p>
</li>
<li><p>23、统计列印各科成绩,各分数段人数:课程ID,课程名称,[100-85],[85-70],[70-60],[ &lt;60]</p>
</li>
<li>SELECT SC.C# as 课程ID, Cname as 课程名称</li>
<li>,SUM(CASE WHEN score BETWEEN 85 AND 100 THEN 1 ELSE 0 END) AS [100 - 85]</li>
<li>,SUM(CASE WHEN score BETWEEN 70 AND 85 THEN 1 ELSE 0 END) AS [85 - 70]</li>
<li>,SUM(CASE WHEN score BETWEEN 60 AND 70 THEN 1 ELSE 0 END) AS [70 - 60]</li>
<li>,SUM(CASE WHEN score &lt; 60 THEN 1 ELSE 0 END) AS [60 -]</li>
<li>FROM SC,Course</li>
<li>where SC.C#=Course.C#</li>
<li><p>GROUP BY SC.C#,Cname;</p>
</li>
<li><p>24、查询学生平均成绩及其名次</p>
</li>
<li>SELECT 1+(SELECT COUNT( distinct 平均成绩)</li>
<li>FROM (SELECT S#,AVG(score) AS 平均成绩</li>
<li>FROM SC</li>
<li>GROUP BY S#</li>
<li>) AS T1</li>
<li>WHERE 平均成绩 &gt; T2.平均成绩) as 名次,</li>
<li>S# as 学生学号,平均成绩</li>
<li>FROM (SELECT S#,AVG(score) 平均成绩</li>
<li>FROM SC</li>
<li>GROUP BY S#</li>
<li>) AS T2</li>
<li><p>ORDER BY 平均成绩 desc;</p>
</li>
<li><p>25、查询各科成绩前三名的记录:(不考虑成绩并列情况)</p>
</li>
<li>SELECT t1.S# as 学生ID,t1.C# as 课程ID,Score as 分数</li>
<li>FROM SC t1</li>
<li>WHERE score IN (SELECT TOP 3 score</li>
<li>FROM SC</li>
<li>WHERE t1.C#= C#</li>
<li>ORDER BY score DESC</li>
<li>)</li>
<li>ORDER BY t1.C#;</li>
<li>26、查询每门课程被选修的学生数</li>
<li>select c#,count(S#) from sc group by C#;</li>
<li>27、查询出只选修了一门课程的全部学生的学号和姓名</li>
<li>select SC.S#,Student.Sname,count(C#) AS 选课数</li>
<li>from SC ,Student</li>
<li>where SC.S#=Student.S# group by SC.S# ,Student.Sname having count(C#)=1;</li>
<li>28、查询男生、女生人数</li>
<li>Select count(Ssex) as 男生人数 from Student group by Ssex having Ssex=’男’;</li>
<li>Select count(Ssex) as 女生人数 from Student group by Ssex having Ssex=’女’；</li>
<li>29、查询姓“张”的学生名单</li>
<li>SELECT Sname FROM Student WHERE Sname like ‘张%’;</li>
<li>30、查询同名同性学生名单，并统计同名人数</li>
<li>select Sname,count(<em>) from Student group by Sname having count(</em>)&gt;1;</li>
<li>31、1981年出生的学生名单(注：Student表中Sage列的类型是datetime)</li>
<li>select Sname, CONVERT(char (11),DATEPART(year,Sage)) as age</li>
<li>from student</li>
<li>where CONVERT(char(11),DATEPART(year,Sage))=’1981’;</li>
<li>32、查询每门课程的平均成绩，结果按平均成绩升序排列，平均成绩相同时，按课程号降序排列</li>
<li>Select C#,Avg(score) from SC group by C# order by Avg(score),C# DESC ;</li>
<li>33、查询平均成绩大于85的所有学生的学号、姓名和平均成绩</li>
<li>select Sname,SC.S# ,avg(score)</li>
<li>from Student,SC</li>
<li>where Student.S#=SC.S# group by SC.S#,Sname having avg(score)&gt;85;</li>
<li>34、查询课程名称为“数据库”，且分数低于60的学生姓名和分数</li>
<li>Select Sname,isnull(score,0)</li>
<li>from Student,SC,Course</li>
<li>where SC.S#=Student.S# and SC.C#=Course.C# and Course.Cname=’数据库’and score &lt;60;</li>
<li>35、查询所有学生的选课情况；</li>
<li>SELECT SC.S#,SC.C#,Sname,Cname</li>
<li>FROM SC,Student,Course</li>
<li>where SC.S#=Student.S# and SC.C#=Course.C# ;</li>
<li>36、查询任何一门课程成绩在70分以上的姓名、课程名称和分数；</li>
<li>SELECT distinct student.S#,student.Sname,SC.C#,SC.score</li>
<li>FROM student,Sc</li>
<li>WHERE SC.score&gt;=70 AND SC.S#=student.S#;</li>
<li>37、查询不及格的课程，并按课程号从大到小排列</li>
<li>select c# from sc where scor e &lt;60 order by C# ;</li>
<li>38、查询课程编号为003且课程成绩在80分以上的学生的学号和姓名；</li>
<li>select SC.S#,Student.Sname from SC,Student where SC.S#=Student.S# and Score&gt;80 and C#=’003’;</li>
<li>39、求选了课程的学生人数</li>
<li>select count(*) from sc;</li>
<li>40、查询选修“叶平”老师所授课程的学生中，成绩最高的学生姓名及其成绩</li>
<li>select Student.Sname,score</li>
<li>from Student,SC,Course C,Teacher</li>
<li>where Student.S#=SC.S# and SC.C#=C.C# and C.T#=Teacher.T# and Teacher.Tname=’叶平’ and SC.score=(select max(score)from SC where C#=C.C# );</li>
<li>41、查询各个课程及相应的选修人数</li>
<li>select count(*) from sc group by C#;</li>
<li>42、查询不同课程成绩相同的学生的学号、课程号、学生成绩</li>
<li>select distinct A.S#,B.score from SC A ,SC B where A.Score=B.Score and A.C# &lt;&gt;B.C# ;</li>
<li>43、查询每门功成绩最好的前两名</li>
<li>SELECT t1.S# as 学生ID,t1.C# as 课程ID,Score as 分数</li>
<li>FROM SC t1</li>
<li>WHERE score IN (SELECT TOP 2 score</li>
<li>FROM SC</li>
<li>WHERE t1.C#= C#</li>
<li>ORDER BY score DESC</li>
<li>)</li>
<li>ORDER BY t1.C#;</li>
<li>44、统计每门课程的学生选修人数（超过10人的课程才统计）。要求输出课程号和选修人数，查询结果按人数降序排列，查询结果按人数降序排列，若人数相同，按课程号升序排列</li>
<li>select C# as 课程号,count(*) as 人数</li>
<li>from sc</li>
<li>group by C#</li>
<li>order by count(*) desc,c#</li>
<li>45、检索至少选修两门课程的学生学号</li>
<li>select S#</li>
<li>from sc</li>
<li>group by s#</li>
<li>having count(*) &gt; = 2</li>
<li>46、查询全部学生都选修的课程的课程号和课程名</li>
<li>select C#,Cname</li>
<li>from Course</li>
<li>where C# in (select c# from sc group by c#)</li>
<li>47、查询没学过“叶平”老师讲授的任一门课程的学生姓名</li>
<li>select Sname from Student where S# not in (select S# from Course,Teacher,SC where Course.T#=Teacher.T# and SC.C#=course.C# and Tname=’叶平’);</li>
<li>48、查询两门以上不及格课程的同学的学号及其平均成绩</li>
<li>select S#,avg(isnull(score,0)) from SC where S# in (select S# from SC where score <60 group by s# having count(*)>2)group by S#;</60></li>
<li>49、检索“004”课程分数小于60，按分数降序排列的同学学号</li>
<li>select S# from SC where C#=’004’and score &lt;60 order by score desc;</li>
<li>50、删除“002”同学的“001”课程的成绩</li>
<li>delete from Sc where S#=’001’and C#=’001’;</li>
</ol>

            
            <p class="more">
                <a href="/2015/05/28/2019030500001/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2015/05/28/2019030500001/" title="50条SQL查询技巧">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/8.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/MySQL/">MySQL</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2015/05/27/2019030500015/">
    		利用Navicat工具实现MySQL数据库结构同步
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2015-05-27T06:34:25.000Z">2015-05-27</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/MySQL/" title="MySQL">MySQL</a> / 
    
        <a href="/tags/数据库/" title="数据库">数据库</a> / 
    
        <a href="/tags/结构同步/" title="结构同步">结构同步</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <blockquote>
<p>Navicat 是一套快速、可靠并价格相宜的数据库管理工具，专为简化数据库的管理及降低系统管理成本而设。Navicat提供多达 7 种语言供客户选择，被公认为全球最受欢迎的数据库前端用户界面工具。 Navicat旗下有多个产品成员 ，可以用来对本机或远程的 MySQL、SQL Server、SQLite、Oracle 及 PostgreSQL 数据库进行管理及开发。因为文中介绍的是MySQL数据库，因此我们要用到的是Navicat旗下的Navicat For MySQL工具。Navicat For MySQL下载链接。 我们在开发项目时一般会用到一个开发版和一个正式版的数据库，在开发版中修改了数据库表结构如何才能快速同步到正式版呢？如果自己手动一个个字段或属性去修改，实在是太麻烦，而且容易遗漏，有了Navicat 工具，就能快速实现数据库直接的同步，包括结构同步，数据同步等。下面介绍如何利用Navicat For MySQL实现MySQL数据库间结构同步。</p>
<h4 id="1-打开Navicat-For-MySQL"><a href="#1-打开Navicat-For-MySQL" class="headerlink" title="1.打开Navicat For MySQL"></a>1.打开Navicat For MySQL</h4><h4 id="2-创建数据库连接，可连接本地数据库服务器，也可远程连接。如图所示创建一个本地连接。"><a href="#2-创建数据库连接，可连接本地数据库服务器，也可远程连接。如图所示创建一个本地连接。" class="headerlink" title="2.创建数据库连接，可连接本地数据库服务器，也可远程连接。如图所示创建一个本地连接。"></a>2.创建数据库连接，可连接本地数据库服务器，也可远程连接。如图所示创建一个本地连接。</h4><p><img src="http://img.blog.csdn.net/20150527110818261" alt="这里写图片描述"> 连接名可自己任意命名，方便自己识别就行。填好地址用户名密码等之后，可点击测试连接，看能够创建连接，若成功则会弹窗提示。 <img src="http://img.blog.csdn.net/20150527111134502" alt="这里写图片描述"></p>
<h4 id="3-连接成功后，选中工具→结构同步，便可对该连接下的数据库进行同步操作了。"><a href="#3-连接成功后，选中工具→结构同步，便可对该连接下的数据库进行同步操作了。" class="headerlink" title="3.连接成功后，选中工具→结构同步，便可对该连接下的数据库进行同步操作了。"></a>3.连接成功后，选中工具→结构同步，便可对该连接下的数据库进行同步操作了。</h4><p><img src="http://img.blog.csdn.net/20150527111311753" alt="这里写图片描述"></p>
<h4 id="4-选中要同步的数据的源和目标，源便是结构同步的参考数据库，目标则是要修改结构进行同步的那个数据库。并选择要对比的项。你可以选择仅同步表，或仅同步视图或存储过程等。都设置好后点击比对按钮即可对比这两个数据库的结构，找出其中的不同。"><a href="#4-选中要同步的数据的源和目标，源便是结构同步的参考数据库，目标则是要修改结构进行同步的那个数据库。并选择要对比的项。你可以选择仅同步表，或仅同步视图或存储过程等。都设置好后点击比对按钮即可对比这两个数据库的结构，找出其中的不同。" class="headerlink" title="4.选中要同步的数据的源和目标，源便是结构同步的参考数据库，目标则是要修改结构进行同步的那个数据库。并选择要对比的项。你可以选择仅同步表，或仅同步视图或存储过程等。都设置好后点击比对按钮即可对比这两个数据库的结构，找出其中的不同。"></a>4.选中要同步的数据的源和目标，源便是结构同步的参考数据库，目标则是要修改结构进行同步的那个数据库。并选择要对比的项。你可以选择仅同步表，或仅同步视图或存储过程等。都设置好后点击比对按钮即可对比这两个数据库的结构，找出其中的不同。</h4><p><img src="http://img.blog.csdn.net/20150527111308842" alt="这里写图片描述"></p>
<h4 id="5-比对结果如下图所示，可以在上面的源对象和目标对象列表中看出哪些表或视图或函数等结构有不同，具体的不同则可以通过下面的查询语句来看。选中要执行的查询语句点击运行便可进行同步修改。"><a href="#5-比对结果如下图所示，可以在上面的源对象和目标对象列表中看出哪些表或视图或函数等结构有不同，具体的不同则可以通过下面的查询语句来看。选中要执行的查询语句点击运行便可进行同步修改。" class="headerlink" title="5.比对结果如下图所示，可以在上面的源对象和目标对象列表中看出哪些表或视图或函数等结构有不同，具体的不同则可以通过下面的查询语句来看。选中要执行的查询语句点击运行便可进行同步修改。"></a>5.比对结果如下图所示，可以在上面的源对象和目标对象列表中看出哪些表或视图或函数等结构有不同，具体的不同则可以通过下面的查询语句来看。选中要执行的查询语句点击运行便可进行同步修改。</h4><p><img src="http://img.blog.csdn.net/20150527111642032" alt="这里写图片描述"></p>
<h4 id="6-运行结果将在信息日志中显示，如果出现执行不成功的查询，则会以红色字体显示，可自己再手动进行修改。若无错误，则结构同步完成。可到数据库中查看，两个表要同步的部分是否结构已经一致。"><a href="#6-运行结果将在信息日志中显示，如果出现执行不成功的查询，则会以红色字体显示，可自己再手动进行修改。若无错误，则结构同步完成。可到数据库中查看，两个表要同步的部分是否结构已经一致。" class="headerlink" title="6.运行结果将在信息日志中显示，如果出现执行不成功的查询，则会以红色字体显示，可自己再手动进行修改。若无错误，则结构同步完成。可到数据库中查看，两个表要同步的部分是否结构已经一致。"></a>6.运行结果将在信息日志中显示，如果出现执行不成功的查询，则会以红色字体显示，可自己再手动进行修改。若无错误，则结构同步完成。可到数据库中查看，两个表要同步的部分是否结构已经一致。</h4><p><img src="http://img.blog.csdn.net/20150527112235429" alt="这里写图片描述"></p>
</blockquote>

            
            <p class="more">
                <a href="/2015/05/27/2019030500015/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2015/05/27/2019030500015/" title="利用Navicat工具实现MySQL数据库结构同步">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/7.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/MySQL/">MySQL</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2015/05/27/2019030500035/">
    		新安装的MySQL必须调整的10项配置
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2015-05-27T05:57:07.000Z">2015-05-27</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/MySQL/" title="MySQL">MySQL</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <blockquote>
<p><img src="http://img.blog.csdn.net/20150527122226062?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2Vic2l0ZXM=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt> 还在为新安装的mysql服务，不知道修改哪些默认配置而发愁吗？mysql可调整参数有100多个，到底要立即！马上！调整哪些最重要的参数？ 网络神贴答复你： 这篇文章主要介绍了MySQL优化必须调整的10项配置,使用这些方法可以让你快速地获得一个稳健的MySQL配置,需要的朋友可以参考下： 当我们被人雇来监测MySQL性能时，人们希望我们能够检视一下MySQL配置然后给出一些提高建议。许多人在事后都非常惊讶，因为我们建议他们仅仅改动几个设置，即使是这里有好几百个配置项。这篇文章的目的在于给你一份非常重要的配置项清单。 我们曾在几年前在博客里给出了这样的建议，但是MySQL的世界变化实在太快了！ 写在开始前… 即使是经验老道的人也会犯错，会引起很多麻烦。所以在盲目的运用这些推荐之前，请记住下面的内容： 一次只改变一个设置！这是测试改变是否有益的唯一方法。 大多数配置能在运行时使用SET GLOBAL改变。这是非常便捷的方法它能使你在出问题后快速撤销变更。但是，要永久生效你需要在配置文件里做出改动。 一个变更即使重启了MySQL也没起作用？ 请确定你使用了正确的配置文件。请确定你把配置放在了正确的区域内(所有这篇文章提到的配置都属于 [mysqld]) 服务器在改动一个配置后启不来了：请确定你使用了正确的单位。 例如，innodb_buffer_pool_size的单位是MB而max_connection是没有单位的。 不要在一个配置文件里出现重复的配置项。如果你想追踪改动，请使用版本控制。 不要用天真的计算方法，例如”现在我的服务器的内存是之前的2倍，所以我得把所有数值都改成之前的2倍“。 ‍<strong>基本配置</strong> 你需要经常察看以下3个配置项。不然，可能很快就会出问题。 innodb_buffer_pool_size: 这是你安装完InnoDB后第一个应该设置的选项。 缓冲池是数据和索引缓存的地方：这个值越大越好，这能保证你在大多数的读取操作时使用的是内存而不是硬盘。典型的值是5-6GB(8GB内存)，20-25GB(32GB内存)，100-120GB(128GB内存)。 innodb_log_file_size： 这是redo日志的大小。redo日志被用于确保写操作快速而可靠并且在崩溃时恢复。 一直到MySQL 5.1，它都难于调整，因为一方面你想让它更大来提高性能，另一方面你想让它更小来使得崩溃后更快恢复。幸运的是从MySQL 5.5之后，崩溃恢复的性能的到了很大提升，这样你就可以同时拥有较高的写入性能和崩溃恢复性能了。一直到MySQL 5.5，redo日志的总尺寸被限定在4GB(默认可以有2个log文件)。这在MySQL 5.6里被提高。 一开始就把innodb_log_file_size设置成512M(这样有1GB的redo日志)会使你有充裕的写操作空间。如果你知道你的应用程序需要频繁的写入数据并且你使用的时MySQL 5.6，你可以一开始就把它这是成4G。 max_connections: 如果你经常看到‘Too many connections’错误，是因为max_connections的值太低了。这非常常见因为应用程序没有正确的关闭数据库连接，你需要比默认的151连接数更大的值。max_connection值被设高了(例如1000或更高)之后一个主要缺陷是当服务器运行1000个或更高的活动事务时会变的没有响应。在应用程序里使用连接池或者在MySQL里使用进程池有助于解决这一问题。 <strong>InnoDB配置</strong> 从MySQL 5.5版本开始，InnoDB就是默认的存储引擎并且它比任何其他存储引擎的使用都要多得多。那也是为什么它需要小心配置的原因。 innodb_file_per_table： 这项设置告知InnoDB是否需要将所有表的数据和索引存放在共享表空间里（innodb_file_per_table = OFF） 或者为每张表的数据单独放在一个.ibd文件（innodb_file_per_table = ON）。每张表一个文件允许你在drop、truncate或者rebuild表时回收磁盘空间。这对于一些高级特性也是有必要的，比如数据压缩。但是它不会带来任何性能收益。你不想让每张表一个文件的主要场景是：有非常多的表（比如10k+）。 MySQL 5.6中，这个属性默认值是ON，因此大部分情况下你什么都不需要做。对于之前的版本你必需在加载数据之前将这个属性设置为ON，因为它只对新创建的表有影响。 innodb_flush_log_at_trx_commit： 默认值为1，表示InnoDB完全支持ACID特性。当你的主要关注点是数据安全的时候这个值是最合适的，比如在一个主节点上。但是对于磁盘（读写）速度较慢的系统，它会带来很巨大的开销，因为每次将改变flush到redo日志都需要额外的fsyncs。将它的值设置为2会导致不太可靠（reliable）因为提交的事务仅仅每秒才flush一次到redo日志，但对于一些场景是可以接受的，比如对于主节点的备份节点这个值是可以接受的。如果值为0速度就更快了，但在系统崩溃时可能丢失一些数据：只适用于备份节点。 innodb_flush_method: 这项配置决定了数据和日志写入硬盘的方式。一般来说，如果你有硬件RAID控制器，并且其独立缓存采用write-back机制，并有着电池断电保护，那么应该设置配置为O_DIRECT；否则，大多数情况下应将其设为fdatasync（默认值）。sysbench是一个可以帮助你决定这个选项的好工具。 innodb_log_buffer_size: 这项配置决定了为尚未执行的事务分配的缓存。其默认值（1MB）一般来说已经够用了，但是如果你的事务中包含有二进制大对象或者大文本字段的话，这点缓存很快就会被填满并触发额外的I/O操作。看看Innodb_log_waits状态变量，如果它不是0，增加innodb_log_buffer_size。 <strong>其他设置</strong> query_cache_size: query cache（查询缓存）是一个众所周知的瓶颈，甚至在并发并不多的时候也是如此。 最佳选项是将其从一开始就停用，设置query_cache_size = 0（现在MySQL 5.6的默认值）并利用其他方法加速查询：优化索引、增加拷贝分散负载或者启用额外的缓存（比如memcache或redis）。如果你已经为你的应用启用了query cache并且还没有发现任何问题，query cache可能对你有用。这是如果你想停用它，那就得小心了。 log_bin： 如果你想让数据库服务器充当主节点的备份节点，那么开启二进制日志是必须的。如果这么做了之后，还别忘了设置server_id为一个唯一的值。就算只有一个服务器，如果你想做基于时间点的数据恢复，这（开启二进制日志）也是很有用的：从你最近的备份中恢复（全量备份），并应用二进制日志中的修改（增量备份）。二进制日志一旦创建就将永久保存。所以如果你不想让磁盘空间耗尽，你可以用 PURGE BINARY LOGS 来清除旧文件，或者设置 expire_logs_days 来指定过多少天日志将被自动清除。 记录二进制日志不是没有开销的，所以如果你在一个非主节点的复制节点上不需要它的话，那么建议关闭这个选项。 skip_name_resolve： 当客户端连接数据库服务器时，服务器会进行主机名解析，并且当DNS很慢时，建立连接也会很慢。因此建议在启动服务器时关闭skip_name_resolve选项而不进行DNS查找。唯一的局限是之后GRANT语句中只能使用IP地址了，因此在添加这项设置到一个已有系统中必须格外小心。 <strong>总结</strong> 当然还有其他的设置可以起作用，取决于你的负载或硬件：在慢内存和快磁盘、高并发和写密集型负载情况下，你将需要特殊的调整。然而这里的目标是使得你可以快速地获得一个稳健的MySQL配置，而不用花费太多时间在调整一些无关紧要的MySQL设置或读文档找出哪些设置对你来说很重要上。</p>
</blockquote>

            
            <p class="more">
                <a href="/2015/05/27/2019030500035/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2015/05/27/2019030500035/" title="新安装的MySQL必须调整的10项配置">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/7.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/MySQL/">MySQL</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2015/05/26/2019030500097/">
    		MySQL数据库插入速度调整
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2015-05-26T03:32:35.000Z">2015-05-26</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/MySQL/" title="MySQL">MySQL</a> / 
    
        <a href="/tags/CentOS/" title="CentOS">CentOS</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <p>环境介绍： CentOS 6.5 MySQL 5.5.40 硬件：4核，4GB 参考链接： <a href="http://dev.mysql.com/doc/refman/5.5/en/insert-speed.html" target="_blank" rel="noopener">http://dev.mysql.com/doc/refman/5.5/en/insert-speed.html</a> <a href="http://dev.mysql.com/doc/refman/5.5/en/server-system-variables.html" target="_blank" rel="noopener">http://dev.mysql.com/doc/refman/5.5/en/server-system-variables.html</a> 由于业务量迅速扩展，对写入速度需求越来越高，现预估需要将数据插入速度由每分钟2000条，调整为每秒100条即每分钟6000条； <strong>解决办法：</strong> 1.优化数据库主机IO； 2.调整MySQL对应参数。 开始处理： 1.主机IO优化 a.将数据库设置为独立表空间，并且将每个表空间放在不同的硬盘上； b.关闭主机其他影响IO的进程。 2. 调整my.cnf参数，提升MySQL写速度 innodb_autoextend_increment =128M innodb_log_buffer_size =32M innodb_log_file_size=128M 以上3个参数是逐步变更到对应大小的</p>

            
            <p class="more">
                <a href="/2015/05/26/2019030500097/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2015/05/26/2019030500097/" title="MySQL数据库插入速度调整">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/6.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/MySQL/">MySQL</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2015/05/25/2019030500099/">
    		mysql数据库的连接以及增删改查Java代码实现（Statement版）
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2015-05-25T06:52:54.000Z">2015-05-25</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/MySQL/" title="MySQL">MySQL</a> / 
    
        <a href="/tags/Java/" title="Java">Java</a> / 
    
        <a href="/tags/Statement/" title="Statement">Statement</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <blockquote>
<p>数据库：</p>
<p><strong>[sql]</strong></p>
<ol>
<li><p>create table t1(id int primary key not null auto_increment,name varchar(32),password varchar(32));</p>
</li>
<li><p>insert into t1(name,password) values(‘admin’,’123’);</p>
</li>
<li>insert into t1(name,password) values(‘zhangsan’,’123’);</li>
<li>insert into t1(name,password) values(‘lisi’,’123’);</li>
</ol>
<p>Java代码： mysqlDao.java：</p>
<p><strong>[java]</strong></p>
<ol>
<li><p>package com.dao;</p>
</li>
<li><p>import java.sql.Connection;</p>
</li>
<li>import java.sql.DriverManager;</li>
<li>import java.sql.ResultSet;</li>
<li>import java.sql.SQLException;</li>
<li><p>import java.sql.Statement;</p>
</li>
<li><p>import org.junit.Test;</p>
</li>
<li><p>public class mysqlDao {</p>
</li>
<li><p>private static String driver=”com.mysql.jdbc.Driver”;     //驱动</p>
</li>
<li>private String url=”jdbc:mysql://localhost:3306/test”;    //数据库连接地址</li>
<li>private String user=”root”;     //数据库账户</li>
<li><p>private String password=”11”;      //数据库密码</p>
</li>
<li><p>private Connection connection=null;      //连接</p>
</li>
<li>private Statement stmt=null;      //声明</li>
<li><p>private ResultSet rs=null;     //结果集</p>
</li>
<li><p>private int i=-1;</p>
</li>
<li><p>/*</p>
</li>
<li><ul>
<li>创建驱动</li>
</ul>
</li>
<li><ul>
<li>*/</li>
</ul>
</li>
<li>static{</li>
<li>try {</li>
<li>Class.forName(driver);</li>
<li>} catch (ClassNotFoundException e) {</li>
<li>// TODO Auto-generated catch block</li>
<li>e.printStackTrace();</li>
<li>}</li>
<li><p>}</p>
</li>
<li><p>/*</p>
</li>
<li><ul>
<li>加载驱动</li>
</ul>
</li>
<li><ul>
<li>*/</li>
</ul>
</li>
<li>@Test</li>
<li>public void connect() {</li>
<li>// TODO Auto-generated method stub</li>
<li><p>try {</p>
</li>
<li><p>connection=DriverManager.getConnection(url, user, password);</p>
</li>
<li><p>if(connection!=null){</p>
</li>
<li>System.out.println(“数据库连接成功！”);</li>
<li>}else{</li>
<li>System.out.println(“数据库连接失败！”);</li>
<li><p>}</p>
</li>
<li><p>} catch (SQLException e) {</p>
</li>
<li>// TODO Auto-generated catch block</li>
<li>e.printStackTrace();</li>
<li>}</li>
<li><p>}</p>
</li>
<li><p>/*</p>
</li>
<li><ul>
<li>执行sql语句</li>
</ul>
</li>
<li><ul>
<li>*/</li>
</ul>
</li>
<li>public void doSql(String sql) {</li>
<li><p>// TODO Auto-generated method stub</p>
</li>
<li><p>System.out.println(“This Is mysqlDao.doSql() Method!”);</p>
</li>
<li><p>if(sql!=null){</p>
</li>
<li><p>connect();</p>
</li>
<li><p>try {</p>
</li>
<li><p>stmt=connection.createStatement();</p>
</li>
<li><p>stmt.execute(sql);</p>
</li>
<li><p>} catch (SQLException e) {</p>
</li>
<li>// TODO Auto-generated catch block</li>
<li>e.printStackTrace();</li>
<li><p>}</p>
</li>
<li><p>}</p>
</li>
<li><p>}</p>
</li>
<li><p>/*</p>
</li>
<li><ul>
<li>获取影响行数</li>
</ul>
</li>
<li><ul>
<li>*/</li>
</ul>
</li>
<li>public int getUpCount() {</li>
<li><p>// TODO Auto-generated method stub</p>
</li>
<li><p>try {</p>
</li>
<li>i=stmt.getUpdateCount();</li>
<li>} catch (SQLException e) {</li>
<li>// TODO Auto-generated catch block</li>
<li>e.printStackTrace();</li>
<li><p>}</p>
</li>
<li><p>return i;</p>
</li>
<li><p>}</p>
</li>
<li><p>/*</p>
</li>
<li><ul>
<li>获取结果集</li>
</ul>
</li>
<li><ul>
<li>*/</li>
</ul>
</li>
<li><p>public ResultSet getRs() {</p>
</li>
<li><p>try {</p>
</li>
<li>rs=stmt.getResultSet();</li>
<li>} catch (SQLException e) {</li>
<li>// TODO Auto-generated catch block</li>
<li>e.printStackTrace();</li>
<li><p>}</p>
</li>
<li><p>return rs;</p>
</li>
<li><p>}</p>
</li>
<li><p>/*</p>
</li>
<li><ul>
<li>执行关闭方法</li>
</ul>
</li>
<li><ul>
<li>*/</li>
</ul>
</li>
<li>public void close() {</li>
<li><p>// TODO Auto-generated method stub</p>
</li>
<li><p>try {</p>
</li>
<li>if(rs!=null){</li>
<li>rs.close();</li>
<li>}</li>
<li>} catch (SQLException e) {</li>
<li>// TODO Auto-generated catch block</li>
<li>e.printStackTrace();</li>
<li><p>}finally{</p>
</li>
<li><p>try {</p>
</li>
<li><p>if(stmt!=null){</p>
</li>
<li>stmt.close();</li>
<li>}</li>
<li>} catch (SQLException e) {</li>
<li>// TODO Auto-generated catch block</li>
<li>e.printStackTrace();</li>
<li>}finally{</li>
<li>if(connection!=null){</li>
<li>try {</li>
<li>connection.close();</li>
<li>} catch (SQLException e) {</li>
<li>// TODO Auto-generated catch block</li>
<li>e.printStackTrace();</li>
<li>}</li>
<li>}</li>
<li>}</li>
<li><p>}</p>
</li>
<li><p>}</p>
</li>
<li><p>}</p>
</li>
</ol>
<p>createSql.java</p>
<p><strong>[java]</strong></p>
<ol>
<li><p>package com.dao;</p>
</li>
<li><p>import java.sql.ResultSet;</p>
</li>
<li><p>import java.sql.SQLException;</p>
</li>
<li><p>import org.junit.Test;</p>
</li>
<li><p>public class createSql {</p>
</li>
<li><p>mysqlDao mysqldao=new mysqlDao();</p>
</li>
<li><p>private String sql;</p>
</li>
<li><p>private int i=-1;</p>
</li>
<li><p>private ResultSet rs=null;</p>
</li>
<li><p>/*</p>
</li>
<li><ul>
<li>插入数据</li>
</ul>
</li>
<li><ul>
<li>*/</li>
</ul>
</li>
<li>@Test</li>
<li>public void insert() {</li>
<li><p>// TODO Auto-generated method stub</p>
</li>
<li><p>sql=”insert into t1(name,password) values(‘lisi’,’1234’)”;    //创建sql语句</p>
</li>
<li>mysqldao.doSql(sql);    //执行sql语句</li>
<li>i=mysqldao.getUpCount();     //获取影响行数</li>
<li>if(i!=-1){</li>
<li>System.out.println(“数据插入成功！”);</li>
<li>}else{</li>
<li>System.out.println(“数据插入失败！”);</li>
<li>}</li>
<li><p>mysqldao.close();      //关闭连接</p>
</li>
<li><p>}</p>
</li>
<li><p>/*</p>
</li>
<li><ul>
<li>删除数据</li>
</ul>
</li>
<li><ul>
<li>*/</li>
</ul>
</li>
<li>@Test</li>
<li>public void delete() {</li>
<li>// TODO Auto-generated method stub</li>
<li>sql=”delete from t1 where id=6”;</li>
<li>mysqldao.doSql(sql);</li>
<li>i=mysqldao.getUpCount();</li>
<li>if(i!=-1){</li>
<li>System.out.println(“数据删除成功！”);</li>
<li>}else{</li>
<li>System.out.println(“数据删除失败！”);</li>
<li>}</li>
<li>mysqldao.close();</li>
<li><p>}</p>
</li>
<li><p>/*</p>
</li>
<li><ul>
<li>修改数据</li>
</ul>
</li>
<li><ul>
<li>*/</li>
</ul>
</li>
<li>@Test</li>
<li>public void update() {</li>
<li>// TODO Auto-generated method stub</li>
<li>sql=”update t1 set name=’wangwu’ where id=1”;</li>
<li>mysqldao.doSql(sql);</li>
<li>i=mysqldao.getUpCount();</li>
<li>if(i!=-1){</li>
<li>System.out.println(“数据更新成功！”);</li>
<li>}else{</li>
<li>System.out.println(“数据更新失败！”);</li>
<li>}</li>
<li>mysqldao.close();</li>
<li><p>}</p>
</li>
<li><p>/*</p>
</li>
<li><ul>
<li>遍历数据</li>
</ul>
</li>
<li><ul>
<li>*/</li>
</ul>
</li>
<li>@Test</li>
<li>public void select() throws SQLException {</li>
<li><p>// TODO Auto-generated method stub</p>
</li>
<li><p>sql=”select * from t1”;</p>
</li>
<li><p>mysqldao.doSql(sql);</p>
</li>
<li><p>rs=mysqldao.getRs();</p>
</li>
<li><p>if(rs!=null){</p>
</li>
<li>rs.last();</li>
<li><p>i=rs.getRow();</p>
</li>
<li><p>if(i&gt;0){</p>
</li>
<li>rs.beforeFirst();</li>
<li><p>while(rs.next()){</p>
</li>
<li><p>String id=rs.getString(“id”);</p>
</li>
<li>String name=rs.getString(“name”);</li>
<li>String password=rs.getString(“password”);</li>
<li>System.out.println(“id:”+id+”  “+”name:”+name+”  password:”+password);</li>
<li>}</li>
<li>}else{</li>
<li>System.out.println(“对不起，没有您要查询的信息！”);</li>
<li><p>}</p>
</li>
<li><p>}else{</p>
</li>
<li>System.out.println(“异常………..”);</li>
<li>}</li>
<li><p>mysqldao.close();</p>
</li>
<li><p>}</p>
</li>
<li><p>}</p>
</li>
</ol>
</blockquote>

            
            <p class="more">
                <a href="/2015/05/25/2019030500099/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2015/05/25/2019030500099/" title="mysql数据库的连接以及增删改查Java代码实现（Statement版）">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/5.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    

    
    <nav class="page-navigator">
        <a class="extend prev" rel="prev" href="/categories/MySQL/page/8/">前一页</a><a class="page-number" href="/categories/MySQL/">1</a><span class="space">&hellip;</span><a class="page-number" href="/categories/MySQL/page/7/">7</a><a class="page-number" href="/categories/MySQL/page/8/">8</a><span class="page-number current">9</span><a class="page-number" href="/categories/MySQL/page/10/">10</a><a class="extend next" rel="next" href="/categories/MySQL/page/10/">后一页</a>
    </nav>
    


            </div>

        </section>
        <!-- 侧栏部分 -->
<aside class="sidebar">
    <section class="widget">
        <h3 class="widget-hd"><strong>文章分类</strong></h3>
        <!-- 文章分类 -->
<ul class="widget-bd">
    
    <li>
        <a href="/categories/MySQL/">MySQL</a>
        <span class="badge">(92)</span>
    </li>
    
    <li>
        <a href="/categories/Oracle/">Oracle</a>
        <span class="badge">(40)</span>
    </li>
    
    <li>
        <a href="/categories/NOSQL/">NOSQL</a>
        <span class="badge">(17)</span>
    </li>
    
    <li>
        <a href="/categories/开发语言/">开发语言</a>
        <span class="badge">(7)</span>
    </li>
    
    <li>
        <a href="/categories/SQL-Server/">SQL Server</a>
        <span class="badge">(13)</span>
    </li>
    
    <li>
        <a href="/categories/其他数据库/">其他数据库</a>
        <span class="badge">(4)</span>
    </li>
    
    <li>
        <a href="/categories/MySQL/Oracle/">Oracle</a>
        <span class="badge">(3)</span>
    </li>
    
    <li>
        <a href="/categories/MySQL/Oracle/SQL-Server/">SQL Server</a>
        <span class="badge">(1)</span>
    </li>
    
    <li>
        <a href="/categories/NOSQL/开发语言/">开发语言</a>
        <span class="badge">(1)</span>
    </li>
    
</ul>
    </section>

    
    <section class="widget">
        <h3 class="widget-hd"><strong>热门标签</strong></h3>
        <!-- 文章标签 -->
<div class="widget-bd tag-wrap">
  
    <a class="tag-item" href="/tags/MySQL/" title="MySQL">MySQL (71)</a>
  
    <a class="tag-item" href="/tags/位运算/" title="位运算">位运算 (0)</a>
  
    <a class="tag-item" href="/tags/sqlplus/" title="sqlplus">sqlplus (1)</a>
  
    <a class="tag-item" href="/tags/PL-SQL/" title="PL/SQL">PL/SQL (5)</a>
  
    <a class="tag-item" href="/tags/数据库/" title="数据库">数据库 (7)</a>
  
    <a class="tag-item" href="/tags/视图/" title="视图">视图 (1)</a>
  
    <a class="tag-item" href="/tags/B-Tree/" title="B+Tree">B+Tree (1)</a>
  
    <a class="tag-item" href="/tags/索引/" title="索引">索引 (1)</a>
  
    <a class="tag-item" href="/tags/redis/" title="redis">redis (6)</a>
  
    <a class="tag-item" href="/tags/SSDB/" title="SSDB">SSDB (1)</a>
  
    <a class="tag-item" href="/tags/SQL/" title="SQL">SQL (17)</a>
  
    <a class="tag-item" href="/tags/ORA-00600/" title="ORA-00600">ORA-00600 (1)</a>
  
    <a class="tag-item" href="/tags/存储过程/" title="存储过程">存储过程 (3)</a>
  
    <a class="tag-item" href="/tags/CentOS/" title="CentOS">CentOS (2)</a>
  
    <a class="tag-item" href="/tags/allow/" title="allow">allow (1)</a>
  
    <a class="tag-item" href="/tags/Apache/" title="Apache">Apache (1)</a>
  
    <a class="tag-item" href="/tags/deny/" title="deny">deny (1)</a>
  
    <a class="tag-item" href="/tags/druid/" title="druid">druid (1)</a>
  
    <a class="tag-item" href="/tags/心跳/" title="心跳">心跳 (1)</a>
  
    <a class="tag-item" href="/tags/事务/" title="事务">事务 (5)</a>
  
    <a class="tag-item" href="/tags/分布式/" title="分布式">分布式 (1)</a>
  
    <a class="tag-item" href="/tags/消息/" title="消息">消息 (1)</a>
  
    <a class="tag-item" href="/tags/KeepAlived/" title="KeepAlived">KeepAlived (1)</a>
  
    <a class="tag-item" href="/tags/Oracle/" title="Oracle">Oracle (30)</a>
  
    <a class="tag-item" href="/tags/schedule-job/" title="schedule job">schedule job (1)</a>
  
    <a class="tag-item" href="/tags/分库/" title="分库">分库 (1)</a>
  
    <a class="tag-item" href="/tags/分库分表/" title="分库分表">分库分表 (1)</a>
  
    <a class="tag-item" href="/tags/分表/" title="分表">分表 (1)</a>
  
    <a class="tag-item" href="/tags/结构同步/" title="结构同步">结构同步 (1)</a>
  
    <a class="tag-item" href="/tags/批量/" title="批量">批量 (1)</a>
  
    <a class="tag-item" href="/tags/truncate/" title="truncate">truncate (1)</a>
  
    <a class="tag-item" href="/tags/Hash索引/" title="Hash索引">Hash索引 (1)</a>
  
    <a class="tag-item" href="/tags/InnoDB/" title="InnoDB">InnoDB (3)</a>
  
    <a class="tag-item" href="/tags/MyISAM/" title="MyISAM">MyISAM (3)</a>
  
    <a class="tag-item" href="/tags/索引优化/" title="索引优化">索引优化 (1)</a>
  
    <a class="tag-item" href="/tags/FineReport/" title="FineReport">FineReport (1)</a>
  
    <a class="tag-item" href="/tags/报表/" title="报表">报表 (1)</a>
  
    <a class="tag-item" href="/tags/数据集/" title="数据集">数据集 (1)</a>
  
    <a class="tag-item" href="/tags/Excel/" title="Excel">Excel (1)</a>
  
</div>
    </section>
    

    

    
    <!-- 友情链接 -->
    <section class="widget">
        <h3 class="widget-hd"><strong>友情链接</strong></h3>
        <!-- 文章分类 -->
<ul class="widget-bd">
    
        <li>
            <a href="https://jelon.top" target="_blank" title="Jelon个人前端小站">前端博客小站</a>
        </li>
    
        <li>
            <a href="https://www.baidu.com" target="_blank" title="百度搜索">百度</a>
        </li>
    
</ul>
    </section>
    
</aside>
<!-- / 侧栏部分 -->
    </div>

    <!-- 博客底部 -->
    <footer class="footer">
    &copy;
    
        2016-2019
    

    <a href="/">Jelon Loves You</a>
</footer>
<div class="back-to-top" id="JELON__backToTop" title="返回顶部">返回顶部</div>

    <!--博客js脚本 -->
    <!-- 这里放网站js脚本 -->
<script src="/js/main.js"></script>
</body>
</html>