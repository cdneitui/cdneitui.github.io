<!doctype html>
<html lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=11,IE=10,IE=9,IE=8">
    <meta name="baidu-site-verification" content="dIcXMeY8Ya">
    
    <title>文章归档: 2015 | 软件开发吧</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
    <meta name="keywords" content="SQL云,SQL云开发,SQL笔记,SQL开发,云开发,MySQL,Oralce,数据库,数据库云,数据库开发,数据库云开发,SQL教程,数据库教程,开发笔记,MySQL笔记,MySQL教程">
    <meta name="description" content="为满足广大程序猿兄弟对日常工作中学习数据库、使用使用数据库资料查询需求，SQL云开发免费将自己整理的各种数据库技术资料分享出来，并希望与广大猿兄一起讨论学习与进步,致力于一起更方便、快捷资料学习查询,实现更安全、高效的数据存储.">

    
    <link rel="alternative" href="/atom.xml" title="软件开发吧" type="application/atom+xml">
    
    
    <link rel="shortcut icon" href="/favicon.ico">
    
    <link rel="stylesheet" href="/css/style.css">
    <!--[if lt IE 9]>
    <script src="/js/html5.js"></script>
    <![endif]-->
    
<script>
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "//hm.baidu.com/hm.js?fd459238242776d173cdc64918fb32f2";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>


</head>
</html>
<body class="home">
    <!--[if lt IE 9]>
    <div class="browsehappy">
        当前网页 <strong>不支持</strong>
        你正在使用的浏览器. 为了正常的访问, 请 <a href="http://browsehappy.com/">升级你的浏览器</a>.
    </div>
    <![endif]-->

    <!-- 博客头部 -->
    <header class="header">
    <section class="container header-main">
        <div class="logo">
            <a href="/">
                <div class="cover">
                    <span class="name">软件开发吧</span>
                    <span class="description"></span>
                </div>
            </a>
        </div>
        <div class="dropnav icon-paragraph-justify" id="JELON__btnDropNav"></div>
        <ul class="menu hidden" id="JELON__menu">
            
            <li rel="/archives/2015/page/12/index.html" class="item ">
                <a href="/" title="首页" class="icon-home">&nbsp;首页</a>
            </li>
            
            <li rel="/archives/2015/page/12/index.html" class="item ">
                <a href="/lab/" title="实验室" class="icon-lab">&nbsp;实验室</a>
            </li>
            
            <li rel="/archives/2015/page/12/index.html" class="item ">
                <a href="/about/" title="关于" class="icon-about">&nbsp;关于</a>
            </li>
            
            <li rel="/archives/2015/page/12/index.html" class="item ">
                <a href="/comment/" title="留言" class="icon-comment">&nbsp;留言</a>
            </li>
            
        </ul>
        <div class="profile clearfix">
            <div class="feeds fl">
                
                
                <p class="links">
                    
                        <a href="https://github.com/cdneitui" target="_blank">Github</a>
                        |
                    
                        <a href="https://pages.github.com/" target="_blank">Hosted by GitHub Pages</a>
                        
                    
                </p>
                <p class="sns">
                    
                    <a href="javascript: void(0);" class="wechat">
                        <b>■</b>
                        公众号
                        <span class="popover">
                            <img src="/img/wechat_mp.jpg" width="120" height="120" alt="我的微信订阅号">
                            <i class="arrow"></i>
                        </span>
                    </a>
                </p>
                
            </div>
            <div class="avatar fr">
                <img src="/img/jelon.jpg" alt="avatar" title="Jelon">
            </div>
        </div>
    </section>
</header>


    <!-- 博客正文 -->
    <div class="container body clearfix">
        <section class="content">
            <div class="content-main widget">
                <!-- 文章归档 -->

    <h3 class="widget-hd">
        <strong>
            
                文章归档
                <!-- 文章归档，可以根据日期分类 -->
            
        </strong>
    </h3>
    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/NOSQL/">NOSQL</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2015/06/09/2019030500036/">
    		方法说---mac下安装homebrew与mongodb
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2015-06-09T06:03:41.000Z">2015-06-09</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/homebrew/" title="homebrew">homebrew</a> / 
    
        <a href="/tags/mac/" title="mac">mac</a> / 
    
        <a href="/tags/MongoDB/" title="MongoDB">MongoDB</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <blockquote>
<p>由于mac是类unix系统，unix下的神器基本都可以使用。 在mac中 homebrew 就类似于linux的 apt-get install  或 yum 等工具 ，一行命令完成你所需要的工具安装。 就两个字 简单！ 所以 尽管 打开你的 mac终端吧 然后去homebrew的官网 与 mongodb的官网粘贴几条命令搞定吧！</p>
<p><img src="http://img.blog.csdn.net/20150609133327030?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZmFudjIwMTE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt></p>
</blockquote>

            
            <p class="more">
                <a href="/2015/06/09/2019030500036/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2015/06/09/2019030500036/" title="方法说---mac下安装homebrew与mongodb">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/9.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/Oracle/">Oracle</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2015/06/09/2019030500017/">
    		存在外键关联的主表truncate如何做
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2015-06-09T04:32:58.000Z">2015-06-09</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/truncate/" title="truncate">truncate</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <p>主外键是数据库提供的一种两表之间强制关联的方法，也可以从应用层实现。</p>
<p>优点</p>
<p>缺点</p>
<p>数据库实现的主外键</p>
<p>由数据库层机制保证，无需应用额外实现</p>
<p>强关联，不易扩展变更</p>
<p>应用实现的主外键</p>
<p>易扩展变更</p>
<p>完全由应用控制，要求较高</p>
<p>我认为需要根据实际情况进行取舍，例如表不复杂，可以由应用实现，若表之间关联较多且复杂，那么交由数据库处理，至少保证不会错。 存在主外键关联的主表，由于存在外键关联关系，因此有些操作就会禁止，例如truncate。 实验 1. 创建测试表</p>
<p><strong>[sql]</strong></p>
<ol>
<li>SQL&gt; create table tbl_a(id number, remark varchar2(1));</li>
<li><p>Table created.</p>
</li>
<li><p>SQL&gt; create table tbl_b(id number, a_id number, remark varchar2(1));</p>
</li>
<li><p>Table created.</p>
</li>
<li><p>SQL&gt; alter table tbl_a add constraint pk_tbl_a primary key(id);</p>
</li>
<li><p>Table altered.</p>
</li>
<li><p>SQL&gt; alter table tbl_b add constraint pk_tbl_b primary key(id);</p>
</li>
<li><p>Table altered.</p>
</li>
<li><p>SQL&gt; alter table tbl_b add constraint fk_tbl_b_a foreign key(a_id) references tbl_a(id);</p>
</li>
<li>Table altered.</li>
</ol>
<p>tbl_a是主表，tbl_b是子表，关联tbl_a。 <strong>2. 现在主表和子表没有任何数据，此时执行truncate主表</strong></p>
<p><strong>[sql]</strong></p>
<ol>
<li><span style="font-size:14px;">SQL&gt; truncate table tbl_a;</span></li>
<li>Table truncated.</li>
</ol>
<p>可以执行。 3. 向主表插入一条记录，再次执行truncate</p>
<p><strong>[sql]</strong></p>
<ol>
<li>SQL&gt; insert into tbl_a values(1, ‘a’);</li>
<li><p>1 row created.</p>
</li>
<li><p>SQL&gt; commit;</p>
</li>
<li><p>Commit complete.</p>
</li>
<li><p>SQL&gt; truncate table tbl_a;</p>
</li>
<li>truncate table tbl_a</li>
<li>*</li>
<li>ERROR at line 1:</li>
<li>ORA-02266: unique/primary keys in table referenced by enabled foreign keys</li>
</ol>
<p>此时提示了ORA-02266：唯一/主键被启用的外键引用 看看ORA-02266的解释： 02266, 00000, “unique/primary keys in table referenced by enabled foreign keys” // *Cause: An attempt was made to truncate a table with unique or //         primary keys referenced by foreign keys enabled in another table. //         Other operations not allowed are dropping/truncating a partition of a //         partitioned table or an ALTER TABLE EXCHANGE PARTITION. // *Action: Before performing the above operations the table, disable the //          foreign key constraints in other tables. You can see what //          constraints are referencing a table by issuing the following //          command: //          SELECT * FROM USER_CONSTRAINTS WHERE TABLE_NAME = “tabnam”; 比较清楚地说明了问题，以及解决方法：可以在执行前，先禁用外键约束，执行truncate后再恢复外键约束。 4. 禁用外键约束，删除后执行恢复操作 看到外键约束名称：FK_TBL_B_A：</p>
<p><strong>[sql]</strong></p>
<ol>
<li><p>SQL&gt; select constraint_name, constraint_type, status from user_constraints where table_name=’TBL_B’;</p>
</li>
<li><p>CONSTRAINT_NAME                C STATUS</p>
</li>
<li><hr>
</li>
<li>PK_TBL_B                       P ENABLED</li>
<li>FK_TBL_B_A                     R ENABLED</li>
</ol>
<p>禁止外键约束：</p>
<p><strong>[sql]</strong></p>
<ol>
<li><p>SQL&gt; alter table tbl_b disable constraint FK_TBL_B_A;</p>
</li>
<li><p>Table altered.</p>
</li>
<li><p>SQL&gt; select constraint_name, constraint_type, status from user_constraints where table_name=’TBL_B’;</p>
</li>
<li><p>CONSTRAINT_NAME                C STATUS</p>
</li>
<li><hr>
</li>
<li>PK_TBL_B                       P ENABLED</li>
<li>FK_TBL_B_A                     R DISABLED</li>
</ol>
<p>STATUS状态变为DISABLED了。 truncate表：</p>
<p><strong>[sql]</strong></p>
<ol>
<li><p>SQL&gt; truncate table tbl_a;</p>
</li>
<li><p>Table truncated.</p>
</li>
</ol>
<p>恢复约束：</p>
<p><strong>[sql]</strong></p>
<ol>
<li><p>SQL&gt; alter table tbl_b enable constraint FK_TBL_B_A;</p>
</li>
<li><p>Table altered.</p>
</li>
<li><p>SQL&gt; select constraint_name, constraint_type, status from user_constraints where table_name=’TBL_B’;</p>
</li>
<li><p>CONSTRAINT_NAME                C STATUS</p>
</li>
<li><hr>
</li>
<li>PK_TBL_B                       P ENABLED</li>
<li><p>FK_TBL_B_A                     R ENABLED</p>
<p>总结： 1. 主外键是数据库提供的强约束，可以帮助我们控制主子表之间的关系，但同时还是一把双刃剑，当然，我们认为既然定义了主外键，就是需要这种强制关系，但有时可能就会有一些变更，因此，如何取舍，需要根据实际情况来决策。 2. 主外键关联中的主表，如果有数据，则不能直接用truncate方式删除，因为会认为有外键和其关联，不能直接截断主表，若需要做，可以先禁止外键约束，主表变成一个独立的表，这样就可以执行truncate了。</p>
</li>
</ol>

            
            <p class="more">
                <a href="/2015/06/09/2019030500017/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2015/06/09/2019030500017/" title="存在外键关联的主表truncate如何做">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/9.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/MySQL/">MySQL</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2015/06/08/2019030500028/">
    		数据库中为什么需要Implict Commit（隐式提交事务）
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2015-06-08T08:55:11.000Z">2015-06-08</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/Commit/" title="Commit">Commit</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <blockquote>
<p>先看一段SQL，最后一条SQL的输出你认为是什么？</p>
<ol>
<li>SET AUTOCOMMIT = 1;</li>
<li>BEGIN;</li>
<li>INSERT INTO t1 VALUES (1);</li>
<li>CREATE TABLE t2 (pk int primary key);</li>
<li>INSERT INTO t2 VALUES (2);</li>
<li>ROLLBACK;</li>
<li>SHOW TABLES;</li>
</ol>
<p>答案是：t1, t2都存在！</p>
<ol>
<li>mysql&gt; show tables;</li>
<li>+—————-+</li>
<li>| Tables_in_test |</li>
<li>+—————-+</li>
<li>| t1             |</li>
<li>| t2             |</li>
<li>+—————-+</li>
<li>2 rows in set (0.00 sec)</li>
</ol>
<p>更奇怪的是：t1中的1也插入成功了！</p>
<ol>
<li>mysql&gt; select * from t1;</li>
<li>+—-+</li>
<li>| pk |</li>
<li>+—-+</li>
<li>|  1 |</li>
<li>+—-+</li>
<li>1 row in set (0.00 sec)</li>
</ol>
<p>为什么ROLLBACK没有生效呢？答案是：<strong>Implict Commit</strong> 执行CREATE TABLE语句前，之前的事务被隐式提交。因为AUTOCOMMIT=1，所以提交后也不会自动新创建任何事务，INSERT语句执行后立即提交，ROLLBACK不会作用在任何事务上，所以得到了我们最后看到的结果。稍微改一下，让AUTOCOMMIT=0，会怎样呢？</p>
<ol>
<li>SET AUTOCOMMIT = 0;</li>
<li>BEGIN;</li>
<li>INSERT INTO t1 VALUES (1);</li>
<li>CREATE TABLE t2 (pk int primary key);</li>
<li>INSERT INTO t2 VALUES (2);</li>
<li>ROLLBACK;</li>
<li>SHOW TABLES;</li>
</ol>
<p>答案是：t1, t2都存在！插入到t1中的1被提交（插入成功）但插入到t2中得2被回滚（没有插入成功）。之所以t1中的1被提交，是因为CREATE TABLE导致Implict<strong>COMMIT（注意，是COMMIT，不是ROLLBACK哦！)，执行INSERT的时候，会自动开启一个新事务（AUTOCOMMIT=0的语义要求的行为）。所以t2中的2被ROLLBACK回滚。</strong> <strong>为什么部分操作会导致Implict Commit？为什么这样设计？ 为了保证直观上的原子性。假设不做Implict Commit，看看上面的语句会怎样：用户的心理预期是回滚t1的INSERT操作，以及t2的CREATE操作，INSERT操作。如果我们有能力做到这样，那的确是很完美的。但实际上我们很难做到，特别是在分布式系统中更难！因为CREATE TABLE操作背后涉及到了大量的操作，不仅仅包括对核心表的操作，还包括大量内存数据结构的更新（如Schema），以及存储系统的变更（如创建相应的数据块），工程上很难把这些操作做成原子的。</strong> <strong>那么，应该如何做呢？比较折中的方式就是跟用户做一个约定：CREATE TABLE操作总默认COMMIT它之前的事务，这就是implict commit。</strong> 从MySQL文档看，他们做这一块的时候遇到了很多问题，至少在这里踩过两个坑。并且，随着版本的进化，他们还不断的让更多语句能引发implict commit。到底哪些语句会引发implict commit，请参考MySQL文档： <a href="http://dev.mysql.com/doc/refman/5.1/en/implicit-commit.html" target="_blank" rel="noopener">http://dev.mysql.com/doc/refman/5.1/en/implicit-commit.html</a></p>
</blockquote>

            
            <p class="more">
                <a href="/2015/06/08/2019030500028/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2015/06/08/2019030500028/" title="数据库中为什么需要Implict Commit（隐式提交事务）">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/8.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/MySQL/">MySQL</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2015/06/08/2019030500005/">
    		centos6.5安装mysql5.6
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2015-06-08T08:35:13.000Z">2015-06-08</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/MySQL/" title="MySQL">MySQL</a> / 
    
        <a href="/tags/CentOS/" title="CentOS">CentOS</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <h4 id="1-先查看版本号"><a href="#1-先查看版本号" class="headerlink" title="1. 先查看版本号"></a>1. 先查看版本号</h4><pre><code># uname -a
</code></pre><h4 id="2-下载并安装Mysql的yum仓库"><a href="#2-下载并安装Mysql的yum仓库" class="headerlink" title="2. 下载并安装Mysql的yum仓库"></a>2. 下载并安装Mysql的yum仓库</h4><p>下载Mysql的yum仓库 <a href="http://dev.mysql.com/downloads/repo/yum/" target="_blank" rel="noopener">http://dev.mysql.com/downloads/repo/yum/</a> 然后安装一下这个仓库列表</p>
<pre><code>$ sudo yum localinstall mysql-community-release-el6-5.noarch.rpm 
</code></pre><h4 id="3-搜索可安装的mysql版本"><a href="#3-搜索可安装的mysql版本" class="headerlink" title="3. 搜索可安装的mysql版本"></a>3. 搜索可安装的mysql版本</h4><p>执行这个命令后就能看到可安装的mysql：</p>
<pre><code># yum repolist enabled | grep &quot;mysql.*-community.*&quot;
</code></pre><p>如果我们是要安装最新的版本，那么可以直接执行</p>
<pre><code># sudo yum install mysql-community-server
</code></pre><p>如果我们要选择版本，可以先执行下面这个命令查看一下有哪些版本：</p>
<pre><code># yum repolist all | grep mysql
</code></pre><p>如果要选择版本的话，有两种方式，一种是使用命令来</p>
<pre><code>$ sudo yum-config-manager --disable mysql56-community
$ sudo yum-config-manager --enable mysql57-community-dmr
</code></pre><p>这个命令就是在仓库中启用5.7版本的，禁用5.6版本子仓库 或者编辑/etc/yum.repos.d/mysql-community.repo文件</p>
<pre><code># Enable to use MySQL 5.6
[mysql56-community]
name=MySQL 5.6 Community Server
baseurl=//repo.mysql.com/yum/mysql-5.6-community/el/5/$basearch/
enabled=1
gpgcheck=1
gpgkey=file:/etc/pki/rpm-gpg/RPM-GPG-KEY-mysql 
</code></pre><p>enabled=0表示禁用 比如要安装5.7版本的mysql，要确定5.6的enabled=0，5.7的enabled=1，一次保证只启用一个子仓库</p>
<pre><code># Note: MySQL 5.7 is currently in development. For use at your own risk.
# Please read with sub pages: https://dev.mysql.com/doc/relnotes/mysql/5.7/en/
[mysql57-community-dmr]
name=MySQL 5.7 Community Server Development Milestone Release
baseurl=http://repo.mysql.com/yum/mysql-5.7-community/el/6/$basearch/
enabled=1
gpgcheck=1
gpgkey=file:/etc/pki/rpm-gpg/RPM-GPG-KEY-mysql
</code></pre><p>然后我们又可以愉快的安装mysql了</p>
<pre><code>$ sudo yum install mysql-community-server
</code></pre><p>安装完成后我们启动mysql</p>
<pre><code>$ sudo service mysqld start
</code></pre><p>查看mysql状态</p>
<pre><code>$ sudo service mysqld status
</code></pre><p>启动mysql服务并初始化：</p>
<pre><code># /etc/init.d/mysqld start
Initializing MySQL database: 
PLEASE REMEMBER TO SET A PASSWORD FOR THE MySQL root USER !
To do so, start the server, then issue the following commands:

/usr/bin/mysqladmin -u root password &apos;new-password&apos;
/usr/bin/mysqladmin -u root -h iZ94vana2fdZ password &apos;new-password&apos;

Alternatively you can run:
/usr/bin/mysql_secure_installation

which will also give you the option of removing the test
databases and anonymous user created by default. This is
strongly recommended for production servers.

See the manual for more instructions.

Please report any problems at http://bugs.mysql.com/

[ OK ]
Starting mysqld: [ OK ]
</code></pre><h4 id="4-相关命令"><a href="#4-相关命令" class="headerlink" title="4. 相关命令"></a>4. 相关命令</h4><p>启动mysql服务</p>
<pre><code># service mysqld start
</code></pre><p>重启mysql服务</p>
<pre><code># service mysqld restart
</code></pre><p>停止mysql服务</p>
<pre><code># service mysqld stop
</code></pre>
            
            <p class="more">
                <a href="/2015/06/08/2019030500005/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2015/06/08/2019030500005/" title="centos6.5安装mysql5.6">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/8.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/Oracle/">Oracle</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2015/06/04/2019030500143/">
    		Oracle问题--远程登录失败原因分析
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2015-06-04T07:23:25.000Z">2015-06-04</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/Oracle/" title="Oracle">Oracle</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <p>远程机：        安装 Oracle 的计算机； 本地机：        访问远程机上 Oracle 数据库的计算机。 一、问题描述     在远程计算机安装 Oracle 数据库。     在本地机上，配置 InstantClient 后，        使用 PLSql Developer 远程登录 Oracle 数据库，报 Oracle 错误。   二、解决思路     根据 Oracle 错误代码分析原因，如ORA-1455。   三、原因分析     常常是远程或本地计算机配置错误。   四、解决方案 (1)、先确保能在远程计算机上，使用 PLSql 访问远程机上的 Oracle 数据库。         若不能访问，重新配置远程计算机上的 Oracle 数据库； (2)、安装 Oracle 数据库后，数据库的连接配置是针对数据库所在机器。     因此在其他计算机上，无法登录另一台机器上的 Oracle 数据库。     此时需要更改远程计算机（安装 Oracle 的计算机）上的配置文件； (3)、修改两个文件：listener.ora和tnsnames.ora     可从Oracle安装目录检索到。     –所有的 SID_NAME、SID 的值，           改为与 InstantClient 中 tnsnames.ora 中 SERVICE_NAME 相同的值；     –所有HOST的值，改为 Oracle 数据库所在计算机的 IP 地址； (4)、重启远程机上的 Oracle 数据库，     在本地机上启动 PLSql Developer，     即可成功登录到远程机上的  Oracle 数据库。   <strong>环境：</strong>  –远程机环境：</p>
<blockquote>
<p>Win7 SP1</p>
</blockquote>
<blockquote>
<p>Oracle 11g</p>
</blockquote>
<pre><code>--本地机环境：
</code></pre><blockquote>
<p>Win7 SP1</p>
</blockquote>
<blockquote>
<p>PLSql Developer 8.0.4.1514</p>
</blockquote>
<blockquote>
<p> InstantClient 11.2</p>
</blockquote>

            
            <p class="more">
                <a href="/2015/06/04/2019030500143/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2015/06/04/2019030500143/" title="Oracle问题--远程登录失败原因分析">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/4.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/MySQL/">MySQL</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2015/06/04/2019030500040/">
    		简单查询部分sql练习题
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2015-06-04T05:30:59.000Z">2015-06-04</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/SQL/" title="SQL">SQL</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <p>简单查询部分sql练习题:</p>
<ol>
<li>– 选择部门30中的所有职工</li>
<li><p>select * from emp where deptno = 30;</p>
</li>
<li><p>– 列出所有业务员(CLERK)的姓名，编号，和部门编号</p>
</li>
<li><p>select e.ename, e.empno, e.deptno from emp e where e.job = ‘CLERK’;</p>
</li>
<li><p>– 找出奖金高于薪金的员工</p>
</li>
<li><p>select * from emp where comm &gt; sal;</p>
</li>
<li><p>– 找出奖金高于薪金的60%的员工</p>
</li>
<li><p>select <em> from emp where comm &gt; sal </em> 0.6;</p>
</li>
<li><p>– 找出部门10中所有经理(MANAGER)和部门20中所有业务员(CLERK)的详细资料</p>
</li>
<li>select * from emp e</li>
<li>where e.deptno = 10 and e.job = ‘MANAGER’</li>
<li><p>or e.deptno = 20 and e.job = ‘CLERK’;</p>
</li>
<li><p>select * from emp e</p>
</li>
<li>where (e.deptno = 10 and e.job = ‘MANAGER’)</li>
<li><p>or (e.deptno = 20 and e.job = ‘CLERK’);</p>
</li>
<li><p>select * from emp e where e.deptno = 10 and e.job = ‘MANAGER’</p>
</li>
<li>union</li>
<li><p>select * from emp e where e.deptno = 20 and e.job = ‘CLERK’;</p>
</li>
<li><p>– 找出部门10中所有经理(MANAGER),部门20中所有业务员(CLERK),既不是经理又不是业务员但其薪水大于等于2000的所有员工的详细资料</p>
</li>
<li>select * from emp e where e.deptno = 10 and e.job = ‘MANAGER’</li>
<li>union</li>
<li>select * from emp e where e.deptno = 20 and e.job = ‘CLERK’</li>
<li>union</li>
<li><p>select * from emp e where e.sal &gt; 2000 and e.job not in(‘MANAGER’, ‘CLERK’);</p>
</li>
<li><p>– 找出收取奖金的员工的不同工作</p>
</li>
<li><p>select distinct e.job from emp e;</p>
</li>
<li><p>– 找出不收取奖金或收取的奖金低于100的员工</p>
</li>
<li><p>select * from emp e where e.comm is null or e.comm &lt; 100;</p>
</li>
<li><p>– 找出各月倒数第3天受雇的所有员工</p>
</li>
<li><p>select * from emp e where e.hiredate between last_day(hiredate)-3 and last_day(hiredate);</p>
</li>
<li><p>– 找出早于30年前受雇的员工</p>
</li>
<li><p>select * from emp e where (sysdate - e.hiredate)/365 &gt; 30;</p>
</li>
<li><p>– 以首字母大写的方式显示所有员工的姓名</p>
</li>
<li><p>select initcap(ename) from emp;</p>
</li>
<li><p>– 显示正好为5个字符的员工姓名</p>
</li>
<li><p>select * from emp where length(ename) = 5;</p>
</li>
<li><p>– 显示不带有”R”的员工姓名</p>
</li>
<li><p>select * from emp where ename not like ‘%K%’;</p>
</li>
<li><p>– 显示所有员工姓名的前三个字符</p>
</li>
<li><p>select substr(ename, 0, 3) from emp;</p>
</li>
<li><p>– 显示所有员工的姓名，并用’a’替换所有’A’</p>
</li>
<li><p>select replace(ename, ‘A’, ‘a’) from emp;</p>
</li>
<li><p>– 显示满30年服务年限的员工姓名和受雇日期</p>
</li>
<li><p>select * from emp where (sysdate - hiredate)/365 &gt; 30;</p>
</li>
<li><p>– 显示员工的详细资料，按姓名由大到小排序</p>
</li>
<li><p>select * from emp order by ename desc;</p>
</li>
<li><p>– 显示员工的姓名和受雇日期，根据其服务年限，将最老的员工排在最前面</p>
</li>
<li><p>select ename, hiredate from emp order by hiredate asc;</p>
</li>
<li><p>– 显示所有员工的姓名，工作和薪金，按工作降序排列，若工作相同则按薪金升序排序</p>
</li>
<li>select ename, job, sal from emp order by job desc, sal asc;</li>
<li><p>select ename, job, sal from emp order by 2 desc, 3;</p>
</li>
<li><p>– 显示所有员工的姓名，加入公司的年份和月份，按受雇日期所在的月排序，若月份相同，则将最早年份排在最前面</p>
</li>
<li><p>select ename, to_number(to_char(hiredate, ‘yyyy’)) Year, to_number(to_char(hiredate, ‘mm’)) from emp order by 3 desc, 2 asc;</p>
</li>
<li><p>– 显示一个月为30天的情况所员工的日薪金，忽略余数</p>
</li>
<li><p>select round(sal/30) 日薪 from emp;</p>
</li>
<li><p>– 找出在(任何年份)2月受聘的所有员工</p>
</li>
<li><p>select * from emp where to_number(to_char(hiredate, ‘mm’)）= 2;</p>
</li>
<li><p>– 对每个员工，显示其加入公司的天数</p>
</li>
<li><p>select ename, round(sysdate - hiredate) Days from emp;</p>
</li>
<li><p>– 显示姓名中任意位置包含“A”的所有员工姓名</p>
</li>
<li><p>select * from emp where upper(ename) like ‘%A%’;</p>
</li>
<li><p>– 以年月日方式显示所有员工的服务年限</p>
</li>
<li>select ename, hiredate,</li>
<li>trunc(months_between(sysdate, hiredate) /12)  year  ,</li>
<li>trunc(mod(months_between(sysdate, hiredate) ,  12 ) ) months  ,</li>
<li>trunc(sysdate - add_months(hiredate,months_between(sysdate, hiredate))) day</li>
<li>from emp ;</li>
</ol>

            
            <p class="more">
                <a href="/2015/06/04/2019030500040/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2015/06/04/2019030500040/" title="简单查询部分sql练习题">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/4.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/MySQL/">MySQL</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2015/06/02/2019030500173/">
    		win7 64位安装mysql
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2015-06-02T07:37:32.000Z">2015-06-02</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/MySQL/" title="MySQL">MySQL</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <blockquote>
<p>版本：mysql官网，下载win7-64位的mysql服务端安装包。 解压：C:\Program Files\mysql\mysql-5.6.25-winx64。 配置环境变量：MYSQL_HOME=C:\Program Files\mysql\mysql-5.6.25-winx64，添加到Path中：%MYSQL_HOME%/bin 配置：更改my-default.ini文件名为my.ini，在[mysqld]下面添加一行编码：character-set-server = gbk 添加3个服务启动参数： basedir = C:/Program Files/mysql/mysql-5.6.25-winx64/ datadir = C:/Program Files/mysql/mysql-5.6.25-winx64/data/ tmpdir = C:/Program Files/mysql/mysql-5.6.25-winx64/temp/ user=mysql 此时安装mysql，命令：mysqld –install MySQL –defaults-file=”my.ini” 启动mysql，命令：net start MySQL 会发现报错“无法启动 发生系统错误2”，是因为免安装，系统不知道配置文件加载路径，系统默认加载了一个不存在的路径， 所以需要更改路径，进到注册表： HKEY_LOCAL_MACHINE-SYSTEM-CurrentControlSet-services-mysql(服务名)-ImagePath 讲值改为：”C:\Program Files\mysql\mysql-5.6.25-winx64\bin\mysqld” –defaults-file=”C:\Program Files\mysql\mysql-5.6.25-winx64\my.ini” MySQL 再次执行命令：net start MySQL，如果参数都配置正确，切tmpdir路径已经存在，则启动成功； 反之报错，修改参数，重新启动即可。 注意：datadir位安装包解压出来的data目录，tmpdir目录必须存在，mysql启动时会检查目录是否存在，不会自动创建。</p>
<h3 id="MySQL服务的启动、停止与卸载"><a href="#MySQL服务的启动、停止与卸载" class="headerlink" title="MySQL服务的启动、停止与卸载"></a>MySQL服务的启动、停止与卸载</h3><p>在 Windows 命令提示符下运行: <strong>启动:</strong> net start MySQL <strong>停止:</strong> net stop MySQL <strong>卸载:</strong> sc delete MySQL</p>
</blockquote>

            
            <p class="more">
                <a href="/2015/06/02/2019030500173/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2015/06/02/2019030500173/" title="win7 64位安装mysql">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/2.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/MySQL/">MySQL</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2015/06/02/2019030500079/">
    		mysql存储过程事务回滚
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2015-06-02T04:58:26.000Z">2015-06-02</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/MySQL/" title="MySQL">MySQL</a> / 
    
        <a href="/tags/事务/" title="事务">事务</a> / 
    
        <a href="/tags/存储过程/" title="存储过程">存储过程</a> / 
    
        <a href="/tags/回滚/" title="回滚">回滚</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <blockquote>
<p>SQL过程代码：</p>
<p><strong>[sql]</strong></p>
<ol>
<li><p>DELIMITER $$</p>
</li>
<li><p>CREATE DEFINER=`root`@`localhost` PROCEDURE `test_procedure`()</p>
</li>
<li>BEGIN</li>
<li>DECLARE errno int;</li>
<li>declare continue HANDLER for sqlexception</li>
<li>begin</li>
<li>rollback;</li>
<li>set errno=1;</li>
<li>end;</li>
<li>start transaction;</li>
<li>set errno=0;</li>
<li>insert into test(name) values (‘kaka’);</li>
<li>insert into test(id, name) values(1,’papa’);</li>
<li>commit;</li>
<li>select errno;</li>
<li>END</li>
</ol>
<p>过程说明： 1、首先表中已经存在一条记录(1,’baby’)； 2、调用测试存储过程； 3、该过程首先声明error变量，和一个SQL异常处理handler，该handler触发时会回滚事务，并将error置为1； 事务开始，将error置为0，插入一条数据name为‘kaka’，再插入一条数据(1,’papa’)，然后提交； 但第二次插入数据时，主键id已存在，此处会报异常触发我们的SQL异常处理handler。实现回滚并将error置为1； 查看error值； 4、调用存储过程之后查看测试表中的数据是否回滚； 调用前： <img src="http://img.blog.csdn.net/20150601213911848?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc29tZV90aW1lcw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt> 调用中: <img src="http://img.blog.csdn.net/20150601213920210?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc29tZV90aW1lcw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt> 调用后： <img src="http://img.blog.csdn.net/20150601213927885?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc29tZV90aW1lcw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt> 建库SQL：</p>
<p><strong>[sql]</strong></p>
<ol>
<li>CREATE DATABASE  IF NOT EXISTS `test`;</li>
<li>USE `test`;</li>
<li>DROP TABLE IF EXISTS `test`;</li>
<li>CREATE TABLE `test` (</li>
<li>`id` int(11) NOT NULL AUTO_INCREMENT,</li>
<li><code>name</code> varchar(45) DEFAULT NULL,</li>
<li>PRIMARY KEY (`id`)</li>
<li>) ENGINE=InnoDB AUTO_INCREMENT=5 DEFAULT CHARSET=utf8;</li>
</ol>
<p>综上，可以通过在存储过程中声明异常处理handler使得我们的事物达到回滚效果。</p>
</blockquote>

            
            <p class="more">
                <a href="/2015/06/02/2019030500079/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2015/06/02/2019030500079/" title="mysql存储过程事务回滚">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/2.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/SQL-Server/">SQL Server</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2015/06/02/2019030500167/">
    		sqlserver CAST 和 CONVERT函数
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2015-06-02T04:55:40.000Z">2015-06-02</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/sqlserver/" title="sqlserver">sqlserver</a> / 
    
        <a href="/tags/CAST/" title="CAST">CAST</a> / 
    
        <a href="/tags/CONVERT/" title="CONVERT">CONVERT</a> / 
    
        <a href="/tags/函数/" title="函数">函数</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <blockquote>
<p>1.sqlserver CAST 和 CONVERT函数将某种数据类型的表达式显式转换为另一种数据类型。CAST 和 CONVERT 提供相似的功能。 语法 使用 CAST： CAST ( expression AS data_type ) 使用 CONVERT： CONVERT (data_type[(length)], expression [, style]) 参数 expression 是任何有效的 Microsoft SQL Server” 表达式。有关更多信息，请参见表达式。 data_type 目标系统所提供的数据类型，包括 bigint 和 sql_variant。不能使用用户定义的数据类型。有关可用的数据类型的更多信息，请参见数据类型。 length nchar、nvarchar、char、varchar、binary 或 varbinary 数据类型的可选参数。 style 日期格式样式，借以将 datetime 或 smalldatetime 数据转换为字符数据（nchar、nvarchar、char、varchar、nchar 或 nvarchar 数据类型）；或者字符串格式样式，借以将 float、real、money 或 smallmoney 数据转换为字符数据（nchar、nvarchar、char、varchar、nchar 或 nvarchar 数据类型）。 将某种数据类型的表达式显式转换为另一种数据类型。有关可用的数据类型的更多信息，请参见数据类型。日期格式样式，借以将 datetime 或 smalldatetime 数据转换为字符数据（nchar、nvarchar、char、varchar、nchar 或 nvarchar 数据类型）；或者字符串格式样式，借以将 float、real、money 或 smallmoney 数据转换为字符数据（nchar、nvarchar、char、varchar、nchar 或 nvarchar 数据类型）。当转换为字符数据时输出。 隐性转换对于用户是不可见的。 SQL Server 自动将数据从一种数据类型转换成另一种数据类型。例如，如果一个 smallint 变量和一个 int 变量相比较，这个 smallint 变量在比较前即被隐性转换成 int 变量。 显式转换使用 CAST 或 CONVERT 函数。 CAST 和 CONVERT 函数将数值从一个数据类型（局部变量、列或其它表达式）转换到另一个数据类型。例如，下面的 CAST 函数将数值 $157.27 转换成字符串 ‘’$157.27’’：CAST ( $157.27 AS VARCHAR(10) )CAST 函数基于 SQL-92 标准并且优先于 CONVERT。 当从一个 SQL Server 对象的数据类型向另一个转换时，一些隐性和显式数据类型转换是不支持的。例如，nchar 数值根本就不能被转换成 image 数值。nchar 只能显式地转换成 binary，隐性地转换到 binary 是不支持的。nchar 可以显式地或者隐性地转换成 nvarchar。 当处理 sql_variant 数据类型时，SQL Server 支持将具有其它数据类型的对象隐性转换成 sql_variant 类型。然而，SQL Server 并不支持从 sql_variant 数据隐性地转换到其它数据类型的对象。</p>
</blockquote>

            
            <p class="more">
                <a href="/2015/06/02/2019030500167/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2015/06/02/2019030500167/" title="sqlserver CAST 和 CONVERT函数">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/2.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/Oracle/">Oracle</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2015/06/02/2019030500002/">
    		61
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2015-06-02T04:53:59.000Z">2015-06-02</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/sqlplus/" title="sqlplus">sqlplus</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <h1 id="1-sqlplus交互界面存在的问题"><a href="#1-sqlplus交互界面存在的问题" class="headerlink" title="1 sqlplus交互界面存在的问题"></a>1 sqlplus交互界面存在的问题</h1><p>sqlplus是ORACLE数据库的最重要的官方命令行客户端软件，是DBA的必备工具，使用它可以完成几乎全部的管理任务。然而，sqlplus的交互界面并不是非常友好，输入命令时不具有历史命令记录功能；默认的输出结果更是不堪入目。在易用性方面，sqlplus确实比mysql客户端差了不少。 既然sqlplus交互模式存在这么多的不便，那么不如干脆直接使用非交互模式使用它，再借助操作系统提供的shell工具集来协助完成更复杂的任务。sqlplus本身就是支持非交互式使用的，而且支持的非常好，符合一般的Unix设计哲学：<strong>从标准输入读取命令，把结果写到标准输出</strong>。</p>
<h1 id="2-sqlplus的两种非交互式使用方式"><a href="#2-sqlplus的两种非交互式使用方式" class="headerlink" title="2 sqlplus的两种非交互式使用方式"></a>2 sqlplus的两种非交互式使用方式</h1><p>sqlplus在非交互模式下，可以从两个地方为其提供sql命令：一是通过外部文件，而是通过标准输入。</p>
<h2 id="2-1-通过外部命令文件"><a href="#2-1-通过外部命令文件" class="headerlink" title="2.1 通过外部命令文件"></a>2.1 通过外部命令文件</h2><pre><code>sqlplus 用户名/密码@服务器IP/侦听服务名 @命令文件名
</code></pre><p>下面举一个例子。 命令文件名为 1.sql，内容如下：</p>
<pre><code>select count(*) from dba_objects;
exit;
</code></pre><ul>
<li>1</li>
<li>2</li>
</ul>
<p>执行命令为：</p>
<pre><code>sqlplus sys/***@172.16.2.190/xgdb.db001.xigang @1.sql
</code></pre><p>此时执行完毕会把结果输出。 这种外部命令文件的方式，需要建立单独的物理文件来存储命令，适合经常使用的大批量管理任务。</p>
<h2 id="2-2-通过标准输入"><a href="#2-2-通过标准输入" class="headerlink" title="2.2 通过标准输入"></a>2.2 通过标准输入</h2><p>既然sqlplus从标准输入来读取命令，那么就可以利用管道把命令发送给它。</p>
<pre><code>echo 命令 | sqlplus 用户名/密码@服务器IP/侦听服务名
</code></pre><p>这种方式不需要在命令中包含 exit；,因为sqlplus执行后自动退出。下面是个例子：</p>
<pre><code>echo &apos;select count(*) from dba_objects;&apos; | sqlplus sys/***@172.16.2.190/xgdb.db001.xigang as sysdba
</code></pre><p>这样执行后结果输出到屏幕，由于sql语句是bash命令的参数，而整个命令行可以通过bash方便的历史记录来重复调用。又可以方便的使用上下箭头来重复使用执行过的sql语句了。</p>
<h1 id="3-利用管道做后续处理"><a href="#3-利用管道做后续处理" class="headerlink" title="3 利用管道做后续处理"></a>3 利用管道做后续处理</h1><p>既然sqlplus把结果输出到了标准输出，那么就可以借助管道，使用sed,awk等文字处理工具来得到想要的输出。</p>
<pre><code>echo -e &apos;set pagesize 0\nselect table_name,owner from dba_tables;&apos; | sqlplus -S sys/***@172.16.2.190/xgdb.db001.xigang as sysdba | awk &apos;{printf(&quot;%-10d%-30s%-20s\n&quot;,NR,$1,$2);}&apos;
</code></pre><h1 id="4-需要注意的地方"><a href="#4-需要注意的地方" class="headerlink" title="4 需要注意的地方"></a>4 需要注意的地方</h1><p>使用外部文件时，文件中的命令与交互式使用完全相同，无需担心。</p>
<ul>
<li><p>使用echo + 管道输入时，要避免 bash 元字符的干扰。一定要把sql命令使用单引号或双引号保护起来。当sql命令中有单引号时，应选择使用双引号保护。如</p>
<pre><code>echo  &quot;insert into t1(name) values(&apos;奥巴马&apos;);&quot; | sqlplus ...
</code></pre></li>
</ul>
<ul>
<li><p>由于$在双引号里也会被当成元字符，所以需要对其进行转义</p>
<pre><code>echo &quot;select * from v\$nls_valid_values where parameter=&apos;LANGUAGE&apos;;&quot; | sqlplus ...
</code></pre></li>
</ul>
<ul>
<li><p>另外，sqlplus不允许把sqlplus指令和sql命令混合在一行使用。而且sql命令必须以;结尾。这样必须使用echo -e 选项来开启把”\n”解释成换行符。例如</p>
<pre><code>echo -e &apos;set pagesize 0\nset linesize 100\nselect * from dba_objects;&apos; | sqlplus ...
</code></pre></li>
</ul>
<h1 id="5-一个简单的脚本"><a href="#5-一个简单的脚本" class="headerlink" title="5 一个简单的脚本"></a>5 一个简单的脚本</h1><p>上述命令行方式虽然可以方便的通过bash的历史记录功能调用执行过的sql语句，但是命令行中除了sql语句还有大量的其他内容，显得繁琐。所以，写一个小脚本（文件名为sql）会让调用起来非常方便，如下：</p>
<pre><code>#!/bin/bash -
if [ $# -ne 1 ]
then
    echo &quot;Usage: $0 &apos;SQL statement&apos;&quot;
else
    SQL=&quot;set pagesize 0\nset linesize 300\n$1&quot;
    echo -e &quot;$SQL&quot;
    echo -e &quot;$SQL&quot; | sqlplus -S sys/***@172.16.2.190/xgdb.db001.xigang as sysdba
fi
</code></pre><ul>
<li>1</li>
<li>2</li>
<li>3</li>
<li>4</li>
<li>5</li>
<li>6</li>
<li>7</li>
<li>8</li>
<li>9</li>
<li>10</li>
</ul>
<p>这样调用起来就像下面一样。</p>
<pre><code>sql &apos;select * from dba_objects;&apos;
</code></pre><p>这样显得非常干净利落，而且也不会在历史命令中记下ORACLE的账户信息，相对也安全。</p>

            
            <p class="more">
                <a href="/2015/06/02/2019030500002/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2015/06/02/2019030500002/" title="61">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/2.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    

    
    <nav class="page-navigator">
        <a class="extend prev" rel="prev" href="/archives/2015/page/11/">前一页</a><a class="page-number" href="/archives/2015/">1</a><span class="space">&hellip;</span><a class="page-number" href="/archives/2015/page/10/">10</a><a class="page-number" href="/archives/2015/page/11/">11</a><span class="page-number current">12</span><a class="page-number" href="/archives/2015/page/13/">13</a><a class="page-number" href="/archives/2015/page/14/">14</a><a class="extend next" rel="next" href="/archives/2015/page/13/">后一页</a>
    </nav>
    


            </div>

        </section>
        <!-- 侧栏部分 -->
<aside class="sidebar">
    <section class="widget">
        <h3 class="widget-hd"><strong>文章分类</strong></h3>
        <!-- 文章分类 -->
<ul class="widget-bd">
    
    <li>
        <a href="/categories/MySQL/">MySQL</a>
        <span class="badge">(92)</span>
    </li>
    
    <li>
        <a href="/categories/开发语言/">开发语言</a>
        <span class="badge">(7)</span>
    </li>
    
    <li>
        <a href="/categories/Oracle/">Oracle</a>
        <span class="badge">(40)</span>
    </li>
    
    <li>
        <a href="/categories/NOSQL/">NOSQL</a>
        <span class="badge">(17)</span>
    </li>
    
    <li>
        <a href="/categories/其他数据库/">其他数据库</a>
        <span class="badge">(4)</span>
    </li>
    
    <li>
        <a href="/categories/SQL-Server/">SQL Server</a>
        <span class="badge">(13)</span>
    </li>
    
    <li>
        <a href="/categories/MySQL/Oracle/">Oracle</a>
        <span class="badge">(3)</span>
    </li>
    
    <li>
        <a href="/categories/MySQL/Oracle/SQL-Server/">SQL Server</a>
        <span class="badge">(1)</span>
    </li>
    
    <li>
        <a href="/categories/NOSQL/开发语言/">开发语言</a>
        <span class="badge">(1)</span>
    </li>
    
</ul>
    </section>

    
    <section class="widget">
        <h3 class="widget-hd"><strong>热门标签</strong></h3>
        <!-- 文章标签 -->
<div class="widget-bd tag-wrap">
  
    <a class="tag-item" href="/tags/MySQL/" title="MySQL">MySQL (71)</a>
  
    <a class="tag-item" href="/tags/位运算/" title="位运算">位运算 (0)</a>
  
    <a class="tag-item" href="/tags/allow/" title="allow">allow (1)</a>
  
    <a class="tag-item" href="/tags/Apache/" title="Apache">Apache (1)</a>
  
    <a class="tag-item" href="/tags/deny/" title="deny">deny (1)</a>
  
    <a class="tag-item" href="/tags/sqlplus/" title="sqlplus">sqlplus (1)</a>
  
    <a class="tag-item" href="/tags/CentOS/" title="CentOS">CentOS (2)</a>
  
    <a class="tag-item" href="/tags/redis/" title="redis">redis (6)</a>
  
    <a class="tag-item" href="/tags/druid/" title="druid">druid (1)</a>
  
    <a class="tag-item" href="/tags/心跳/" title="心跳">心跳 (1)</a>
  
    <a class="tag-item" href="/tags/事务/" title="事务">事务 (5)</a>
  
    <a class="tag-item" href="/tags/分布式/" title="分布式">分布式 (1)</a>
  
    <a class="tag-item" href="/tags/消息/" title="消息">消息 (1)</a>
  
    <a class="tag-item" href="/tags/Oracle/" title="Oracle">Oracle (30)</a>
  
    <a class="tag-item" href="/tags/schedule-job/" title="schedule job">schedule job (1)</a>
  
    <a class="tag-item" href="/tags/KeepAlived/" title="KeepAlived">KeepAlived (1)</a>
  
    <a class="tag-item" href="/tags/分库/" title="分库">分库 (1)</a>
  
    <a class="tag-item" href="/tags/分库分表/" title="分库分表">分库分表 (1)</a>
  
    <a class="tag-item" href="/tags/分表/" title="分表">分表 (1)</a>
  
    <a class="tag-item" href="/tags/数据库/" title="数据库">数据库 (7)</a>
  
    <a class="tag-item" href="/tags/结构同步/" title="结构同步">结构同步 (1)</a>
  
    <a class="tag-item" href="/tags/truncate/" title="truncate">truncate (1)</a>
  
    <a class="tag-item" href="/tags/SQL/" title="SQL">SQL (17)</a>
  
    <a class="tag-item" href="/tags/批量/" title="批量">批量 (1)</a>
  
    <a class="tag-item" href="/tags/Excel/" title="Excel">Excel (1)</a>
  
    <a class="tag-item" href="/tags/Sqlite/" title="Sqlite">Sqlite (1)</a>
  
    <a class="tag-item" href="/tags/FineReport/" title="FineReport">FineReport (1)</a>
  
    <a class="tag-item" href="/tags/报表/" title="报表">报表 (1)</a>
  
    <a class="tag-item" href="/tags/数据集/" title="数据集">数据集 (1)</a>
  
    <a class="tag-item" href="/tags/Hash索引/" title="Hash索引">Hash索引 (1)</a>
  
    <a class="tag-item" href="/tags/InnoDB/" title="InnoDB">InnoDB (3)</a>
  
    <a class="tag-item" href="/tags/MyISAM/" title="MyISAM">MyISAM (3)</a>
  
    <a class="tag-item" href="/tags/索引优化/" title="索引优化">索引优化 (1)</a>
  
    <a class="tag-item" href="/tags/Linux/" title="Linux">Linux (2)</a>
  
    <a class="tag-item" href="/tags/Character-set/" title="Character set">Character set (1)</a>
  
    <a class="tag-item" href="/tags/NLS-LANG/" title="NLS_LANG">NLS_LANG (1)</a>
  
    <a class="tag-item" href="/tags/rowid/" title="rowid">rowid (2)</a>
  
    <a class="tag-item" href="/tags/重复/" title="重复">重复 (1)</a>
  
    <a class="tag-item" href="/tags/mysqldump/" title="mysqldump">mysqldump (2)</a>
  
</div>
    </section>
    

    

    
    <!-- 友情链接 -->
    <section class="widget">
        <h3 class="widget-hd"><strong>友情链接</strong></h3>
        <!-- 文章分类 -->
<ul class="widget-bd">
    
        <li>
            <a href="http://www.devba.com" target="_blank" title="软件开发吧">软件开发吧</a>
        </li>
    
        <li>
            <a href="https://www.sqlyun.cn" target="_blank" title="SQL云笔记">SQL云</a>
        </li>
    
</ul>
    </section>
    
</aside>
<!-- / 侧栏部分 -->
    </div>

    <!-- 博客底部 -->
    <footer class="footer">
    &copy;
    
        2016-2019
    

    <a href="/">Jelon Loves You</a>
</footer>
<div class="back-to-top" id="JELON__backToTop" title="返回顶部">返回顶部</div>

    <!--博客js脚本 -->
    <!-- 这里放网站js脚本 -->
<script src="/js/main.js"></script>
</body>
</html>