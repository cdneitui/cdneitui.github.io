<!doctype html>
<html lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=11,IE=10,IE=9,IE=8">
    <meta name="baidu-site-verification" content="dIcXMeY8Ya">
    
    <title>`SQL`标签下的文章 | 软件开发吧</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
    <meta name="keywords" content="SQL云,SQL云开发,SQL笔记,SQL开发,云开发,MySQL,Oralce,数据库,数据库云,数据库开发,数据库云开发,SQL教程,数据库教程,开发笔记,MySQL笔记,MySQL教程">
    <meta name="description" content="为满足广大程序猿兄弟对日常工作中学习数据库、使用使用数据库资料查询需求，SQL云开发免费将自己整理的各种数据库技术资料分享出来，并希望与广大猿兄一起讨论学习与进步,致力于一起更方便、快捷资料学习查询,实现更安全、高效的数据存储.">

    
    <link rel="alternative" href="/atom.xml" title="软件开发吧" type="application/atom+xml">
    
    
    <link rel="shortcut icon" href="/favicon.ico">
    
    <link rel="stylesheet" href="/css/style.css">
    <!--[if lt IE 9]>
    <script src="/js/html5.js"></script>
    <![endif]-->
    
<script>
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "//hm.baidu.com/hm.js?fd459238242776d173cdc64918fb32f2";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>


</head>
</html>
<body class="home">
    <!--[if lt IE 9]>
    <div class="browsehappy">
        当前网页 <strong>不支持</strong>
        你正在使用的浏览器. 为了正常的访问, 请 <a href="http://browsehappy.com/">升级你的浏览器</a>.
    </div>
    <![endif]-->

    <!-- 博客头部 -->
    <header class="header">
    <section class="container header-main">
        <div class="logo">
            <a href="/">
                <div class="cover">
                    <span class="name">软件开发吧</span>
                    <span class="description"></span>
                </div>
            </a>
        </div>
        <div class="dropnav icon-paragraph-justify" id="JELON__btnDropNav"></div>
        <ul class="menu hidden" id="JELON__menu">
            
            <li rel="/tags/SQL/page/2/index.html" class="item ">
                <a href="/" title="首页" class="icon-home">&nbsp;首页</a>
            </li>
            
            <li rel="/tags/SQL/page/2/index.html" class="item ">
                <a href="/lab/" title="实验室" class="icon-lab">&nbsp;实验室</a>
            </li>
            
            <li rel="/tags/SQL/page/2/index.html" class="item ">
                <a href="/about/" title="关于" class="icon-about">&nbsp;关于</a>
            </li>
            
            <li rel="/tags/SQL/page/2/index.html" class="item ">
                <a href="/comment/" title="留言" class="icon-comment">&nbsp;留言</a>
            </li>
            
        </ul>
        <div class="profile clearfix">
            <div class="feeds fl">
                
                
                <p class="links">
                    
                        <a href="https://github.com/sxyyhj" target="_blank">Github</a>
                        |
                    
                        <a href="https://pages.coding.me" target="_blank">Hosted by Coding Pages</a>
                        
                    
                </p>
                <p class="sns">
                    
                    <a href="javascript: void(0);" class="wechat">
                        <b>■</b>
                        公众号
                        <span class="popover">
                            <img src="/img/wechat_mp.jpg" width="120" height="120" alt="我的微信订阅号">
                            <i class="arrow"></i>
                        </span>
                    </a>
                </p>
                
            </div>
            <div class="avatar fr">
                <img src="/img/jelon.jpg" alt="avatar" title="Jelon">
            </div>
        </div>
    </section>
</header>


    <!-- 博客正文 -->
    <div class="container body clearfix">
        <section class="content">
            <div class="content-main widget">
                <!-- 按标签分类 -->

    <h3 class="widget-hd">
        <strong>
            
                `SQL`标签下的文章
            
        </strong>
    </h3>
    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/Oracle/">Oracle</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2015/08/24/2019030500160/">
    		SQL-PL/SQL基础操作知识
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2015-08-24T04:58:11.000Z">2015-08-24</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/SQL/" title="SQL">SQL</a> / 
    
        <a href="/tags/SQL-PL/" title="SQL-PL">SQL-PL</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <p>SQL的4GL，对流程控制的支持不够，Oracle的PL/SQL是3GL，添加了流程控制、变量等支持可以在数据库层面上进行程序的设计。</p>
<ul>
<li>PL/SQL的特点 1.支持事务控制和SQL. 2.数据类型在SQL的基础上进行了扩展。 3.PL/SQL可存储在Oracle数据库上。 4.可以对PL/SQL进行权限控制。</li>
<li>PL/SQL的优势 1.可以提高横向的运行性能。 2.可以使程序模块化。 3.可以采用逻辑控制语句来控制程序的结构。 4.利用运行时的错误信息，做日志记录。 5.良好的移植性。</li>
<li><p>PL/SQL的结构 pl/sql的基本单位是块，分为三部分：声明部分，执行部分和异常处理部分。 以declare作为开始标记，执行部分用begin作为标志，异常处理部分以exception作为标志，其中执行部分是必须有的。</p>
<p>[declare]<br>….<br>begin</p>
<pre><code>...
</code></pre><p>[exception]</p>
<pre><code>...
</code></pre><p>end;</p>
</li>
</ul>
<p>例如： 只包含执行体</p>
<pre><code>begin
    dbms.output.put_lin(&apos;执行体...&apos;);
end;
</code></pre><p>注意，在使用dbms_output之前要打开控制器输出开关:set serveroutput on; 包含声明和执行体两部分：</p>
<pre><code>declare
     v_result number(8,2);
begin
     v_result = 100 / 6;
     dbms_output.put_line(&apos;结果是：&apos;||v_result);
end;
</code></pre><p>包含声明、执行体和异常处理三部分</p>
<pre><code>declare
     v_ename varchar2(20);
begin
     select ename into v_ename from emp where empno=7369;
     dbms_output.put_line(&apos;姓名：&apos;||v_ename);
exception
     when no_data_found then
          dbms_output.put_line(&apos;没有该员工&apos;);
     when too_many_rows_exeption then
          dbms_output.put_line(&apos;数据过多&apos;);
end；
</code></pre><ul>
<li><p>PL/SQL中变量的使用 1.声明变量的语法结构</p>
<p>variable_name datatype[ [not null] {:=|default} expression];</p>
</li>
</ul>
<p>2.常量声明</p>
<pre><code>constant_name constant datatype
[not null]
{:=default} expression;
</code></pre><p>常量的datatype有以下三种： 1）标量类型：单一类型，不存在组合 2）复合类型：由几种单一类型组成 3）引用类型：使用其他数据项的引用 标量类型： 数值 number(pression,scade) binary_integer pls_integer simple_integer 字符 char varchar2 nvarchar long 布尔类型 true/false/null 日期类型 date/datestamp 复合类型（先定义后声明变量） 记录类型声明语法</p>
<pre><code>type type_name is recode
(
     field_name datatype
     [ [not null] {:=|default} expression]
     [,field_name datatype
       [not null]
       {:=|default} expression
     ]
);
</code></pre><p>VARRAY变长数组：它是一个存储有序元素的集合，适合较少的数据使用。 声明语法：</p>
<pre><code>type type_name is {varray} (size_limit) of element_type [not null]
</code></pre><ul>
<li>PL/SQL中的结构控制语句</li>
</ul>
<p>1.IF条件语句 ①</p>
<pre><code>IF condition THEN
     statement;
END IF;
</code></pre><p>②</p>
<pre><code>IF condition THEN
    statement;
ELSE
    statement;
ENDF IF;
</code></pre><p>③</p>
<pre><code>IF condition THEN
     statement;
ELSE IF condition THEN
     statement;
ELSE
     statement;
END IF;
</code></pre><p>2.CASE语句 ①简单case</p>
<pre><code>[&lt;&lt;label_name&gt;&gt;]

CASE case_operate
WHEN condition THEN
     statement;
[WHEN condition THEN
     statement;]
[ELSE 
     statement;]     

END CASE[&lt;&lt;label_name&gt;&gt;]
</code></pre><p>②搜索case</p>
<pre><code>[&lt;&lt;label_name&gt;&gt;]
CASE
  WHEN boolean_exp THEN statement;
  [WHEN boolean_exp THEN statement;]
  ...
  [ELSE statement;]

END CASE[&lt;&lt;label_name&gt;&gt;]
</code></pre><ul>
<li><p>LOOP循环控制语句 1.基本LOOP</p>
<p>[&lt;&lt;label_name&gt;&gt;]<br>LOOP</p>
<pre><code>statement;
</code></pre><p>END LOOP [&lt;&lt;label_name&gt;&gt;];</p>
</li>
</ul>
<p>基本loop语句通常和exit连用，否则会出现死循环</p>
<pre><code>[&lt;&lt;label_name&gt;&gt;]
loop
     ....
     exit when ...
     | if ... exit;
</code></pre><p>2.WHILE..LOOP</p>
<pre><code>[&lt;&lt;label_name&gt;&gt;]
when boolean_exp
loop
     statement;
end loop[&lt;&lt;label_name&gt;&gt;]
</code></pre><p>3.FOR…LOOP</p>
<pre><code>[&lt;&lt;label_name&gt;&gt;]
for index_name in 
[REVERSE]  //反向
lower_bound, upper_bound
loop
    statement;
end loop[&lt;&lt;label_name&gt;&gt;]
</code></pre>
            
            <p class="more">
                <a href="/2015/08/24/2019030500160/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2015/08/24/2019030500160/" title="SQL-PL/SQL基础操作知识">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/4.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/MySQL/">MySQL</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2015/07/28/2019030500157/">
    		sql 事务-事务是一种机制、是一种操作序列
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2015-07-28T07:00:38.000Z">2015-07-28</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/事务/" title="事务">事务</a> / 
    
        <a href="/tags/SQL/" title="SQL">SQL</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <p>事务是一种机制、是一种操作序列，它包含了一组数据库操作命令，这组命令要么全部执行，要么全部不执行. 事务的四大属性： 1   原子性(Atomicity):事务是一个完整的操作。 2   一致性（Consistency）：当事务完成时，数据必须处于一致状态。 3   隔离性(Isolation):对数据进行修改的所有并发事务是彼此隔离的。 4   持久性(Durability):事务完成后，它对于系统的影响是永久性的。 三、创建事务 T-SQL中管理事务的语句： 1 开始事务:begin transaction 2 提交事务：committransaction 3 回滚事务:rollback transaction 事务分类: 1 显式事务:用begin transaction明确指定事务的开始。 2 隐性事务：打开隐性事务：set implicit_transactions on，当以隐性事务模式操作时，SQL Servler将在提交或回滚事务后自动启动新事务。无法描述事务的开始，只需要提交或回滚事务。 3 自动提交事务：SQLServer的默认模式，它将每条单独的T-SQL语句视为一个事务。如果成功执行，则自动提交，否则回滚。 示例：张三转800元到李四帐户上。 use stuDB go –创建帐户表bank– if exists(select<em> from sysobjects where name=’bank’) drop table bank create table bank ( customerName char(10),    –顾客姓名 currentMoney money       –当前余额 ) go /**//</em>–添加约束，帐户不能少于元–<em>/ alter table bank add constraint CK_currentMoneycheck(currentMoney&gt;=1) /**//</em>–插入测试数据–<em>/ insert into bank(customerName,currentMoney) select ‘张三’,1000union select ‘李四’,1 select </em> from bank go /<strong>//<em>–使用事务–</em>/ use stuDB go –恢复原来的数据 –update bank set currentMoney=currentMoney-1000 where customerName=’李’ set nocount on    –不显示受影响的行数 print ‘查看转帐事务前的余额’ select * from bank go /</strong>//<em>–开始事务–</em>/ begin transaction declare @errorSum int    –定义变量，用于累计事务执行过程中的错误 /<strong>//<em>–转帐–</em>/ update bank set currentMoney=currentMoney-800 where customerName=’张三’ set @errorSum=@errorSum+@@error    –累计是否有错误 update bank set currentMoney=currentMoney+800 where customerName=’李四’ set @errorSum=@errorSum+@@error –累计是否有错误 print ‘查看转帐事务过程中的余额’ select * from bank /</strong>//<em>–根据是否有错误，确定事务是提交还是回滚–</em>/ if @errorSum&gt;0 begin print ‘交易失败，回滚事务.’ rollback transaction end else begin print ‘交易成功，提交事务，写入硬盘，永久保存！’ commit transaction end go print ‘查看转帐后的余额’ select * from bank go</p>

            
            <p class="more">
                <a href="/2015/07/28/2019030500157/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2015/07/28/2019030500157/" title="sql 事务-事务是一种机制、是一种操作序列">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/8.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/MySQL/">MySQL</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2015/06/19/2019030500031/">
    		数据库资源消耗高时快速找出可能问题原因的SQL语句
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2015-06-19T05:37:21.000Z">2015-06-19</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/SQL/" title="SQL">SQL</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <p><strong>1、  查看正在执行的SQL语句</strong> （1）SQL语句：</p>
<p>selectdistinct s.sid,s.sql_id,s.event,s.program,s.MACHINE,q.sql_textfrom v$session s,v$sql q</p>
<p>where s.sql_id=q.sql_idand s.status=’ACTIVE’order by sql_text； （2）用途说明： 当数据库服务器负载高时，资源绝大部分的可能是被正在运行的SQL所消耗，查询到正在执行的SQL语句，是打开高消耗原因盒子的第一步。该语句重点关注的是正在执行的SQL语句、等待事件、发起程序、发起主机及SQL代码，并按SQL文本排序，在数据库服务器负载高时，可以用该语句，查到当前资源消耗高时系统正在运行什么语句，通过按文本的排序及显示SQL_ID，等待事件，可以从一定程序上判断出引发问题的SQL语句   <strong>2、  查看执行并发最多的SQL语句</strong> （1）SQL语句： select sql_id,count(*)from v$session groupby sql_id order by 2 desc （2）用途说明： 资源消耗高时必定有一定数量的SQL语句同时在运行所致，只是一条语句串行执行引发严重性能问题的可能性，在低配置系统上有可能发生，但是在高配置服务器上却不会引发较大影响，但是，同一条有问题的SQL语句高并发执行，再高配置的机器也会被拖垮，持续高并发，也能说明该SQL语句可能运行速度慢，资源消耗高，所以，通过查看正在运行的最多的是哪一条语句，可以客观上判断引发问题原因的SQL语句。</p>

            
            <p class="more">
                <a href="/2015/06/19/2019030500031/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2015/06/19/2019030500031/" title="数据库资源消耗高时快速找出可能问题原因的SQL语句">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/9.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/MySQL/">MySQL</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2015/06/12/2019030500158/">
    		SQL结构化查询语言
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2015-06-12T04:37:40.000Z">2015-06-12</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/SQL/" title="SQL">SQL</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <p><strong>SQL结构化查询语言</strong> 数据操作(管理)语言（DML，DataManipulationLanguage）（DQL+DML） DQL 查询：获得数据。 DML 管理：增加，删除，修改数据。 数据定义语言（DDL，DataDefinitionLanguage）对保存数据的格式进行定义。 数据库控制语言（DCL，DataBaseControlLanguage）针对数据库软件服务进行操作。 <img src="http://img.blog.csdn.net/20150611090734393" alt> SQL=DDL，DML(DQL+DML)，DCL</p>
<h3 id="数据库操作：DDL"><a href="#数据库操作：DDL" class="headerlink" title="数据库操作：DDL"></a><strong>数据库操作：</strong>DDL</h3><h4 id="创建数据库"><a href="#创建数据库" class="headerlink" title="创建数据库"></a><strong>创建数据库</strong></h4><pre><code>create database [if not exists]  数据库名 [数据库选项] ;
eg:
create database liguodong;
create database `1234`;    特殊字符串
create database `create`;  关键字

set names GBK;
create database `成都`;
</code></pre><p>数据库名：可以是任意字符（目录可以创建成功），但特殊的字符需要使用反引号包裹。标识符的大小写区别于操作系统的大小写特征。 If not exists 表示在数据库不存在时创建。 数据库选项中，可以设定数据库字符集（character set utf8)和校对集(collate utf8_general_ci)。 <strong>注：</strong> 语句要求要使用语句结束符 <code>;</code> 标识符（数据库）命名规则： 大小写取决于当前操作系统（认为是区分的） 见名知意。推荐使用下划线方式。 标识符的字符： 使用任意字符，数字，符号甚至是中文。但是一些特殊的组合，例如纯数字组合，特殊符号，包括mysql是内部关键字，应该使用标识符限定符来包裹。 限定符：反引号。 中文可以，但是不建议使用。（字符集编码要正确）<code>set names GBK;</code> 每当我们创建一个数据库，在mysql的数据目录，形成一个目录，目录名是数据库名（如果是特殊字符，则使用编码的形式保存）。目录内，存在一个文件，用于保存数据库的选项信息。<code>db.opt</code></p>
<h4 id="查询数据库"><a href="#查询数据库" class="headerlink" title="查询数据库"></a><strong>查询数据库</strong></h4><p>查询已经存在的数据库：</p>
<pre><code>show databases [like &apos;pattern&apos;]

show databases;
</code></pre><p><code>like pattern</code> 指的是显示符合哪些命名规则的。不存在指的是所有的数据库。 查询创建数据库的语句：<code>show create database db_name;</code> <img src="http://img.blog.csdn.net/20150611095924639" alt> <strong>注意：</strong>并不是只有用户可以创建数据库，还有mysql内部维护自己的数据库。</p>
<h4 id="删除数据库"><a href="#删除数据库" class="headerlink" title="删除数据库"></a><strong>删除数据库</strong></h4><pre><code>drop database [if exists] db_name;  慎用

drop database test;
</code></pre><p><code>If exists</code> 表示数据库存在才删除。 当删除一个数据库时，同时删除该数据库相关的目录及其目录内容。</p>
<h4 id="修改数据库"><a href="#修改数据库" class="headerlink" title="修改数据库"></a><strong>修改数据库</strong></h4><pre><code>alter database db_name [修改指令]

alter database test character set gbk；
</code></pre><p>指令：数据库属性的修改。 <strong>修改名字：</strong> 方式一、简单的可以直接修改目录名。（并不适用所用方式） 方式二、将数据库内容导出，新建一个数据库，将内容导入，删除旧数据库。</p>
<h3 id="表操作"><a href="#表操作" class="headerlink" title="表操作"></a><strong>表操作</strong></h3><p>数据库是表的容器。 表必须数据某个数据库。 可以通过<code>.</code>语法指明所属的数据库。eg: 库.表 database.table。如果任何的标识符，出现的特殊字符，需要使用反引号包裹。不同的标识符需要分别包裹。 进行表操作时，都会指定当前的默认数据库。 <code>use db_name;</code> <strong>注意：</strong>选择了默认的数据库，只会影响默认行为。可以操作任何的数据库。</p>
<h4 id="创建表"><a href="#创建表" class="headerlink" title="创建表"></a><strong>创建表</strong></h4><pre><code>create table [if not exists] tbl_name （列定义） [表选项] 
create table [if not exists] tbl_name like old_tbl_name; 
create table [if not exists] tbl_name select 语句; 

eg:
create table liguodong.classroom(
stu_id varchar(20),
stu_name  varchar(20),
stu_data  date
);
</code></pre><p><img src="http://img.blog.csdn.net/20150611103606154" alt> 每当创建一个表，会在数据目录创建对应的文件保存表信息。 先分析，需要保存的实体数据，拥有哪些属性，这些属性应该如何保存。 例如：学生信息 学号，姓名，出生日期 <strong>列定义：</strong> 列名：列的数据类型[列的属性 （约束）]</p>
<h4 id="查看表"><a href="#查看表" class="headerlink" title="查看表"></a><strong>查看表</strong></h4><pre><code>show tables [from db_name] [like ‘pattern’]; 
如果没有数据库名，则采用当前数据库，如果没有like，则获得所有表。
eg:
use liguodong;
show tables;

show tables from liguodong;
</code></pre><p><img src="http://img.blog.csdn.net/20150611151502876" alt> 表名前缀： 为了区分<strong>相同逻辑表名</strong>的<strong>不同应用</strong>，给逻辑表名，增加前缀，形成真实表名。</p>
<pre><code>/*学生管理系统*/
create table info_student(
stu_name varchar(20),
stu_no varchar(20)
);
/*在线考试系统*/
create table exam_student(
stu_name varchar(20),
stu_no varchar(20)
);
</code></pre><p><img src="http://img.blog.csdn.net/20150611152216853" alt></p>
<pre><code>show tables like &apos;exam_%&apos;;
%称之为通配符，表示任意字符的任意个数的组合。
</code></pre><p><img src="http://img.blog.csdn.net/20150611152434885" alt></p>
<pre><code>show create table exam_student;
</code></pre><p><img src="http://img.blog.csdn.net/20150611155358616" alt> 当一个数据非常多的时候，可以使用\G作为语句结束符。 <img src="http://img.blog.csdn.net/20150611155716294" alt></p>
<pre><code>describe liguodong.exam_student;
</code></pre><p><img src="http://img.blog.csdn.net/20150611161139279" alt> 数据库对应目录，而数据库中的内容对应<strong>目录的内容，文件</strong>。 <img src="http://img.blog.csdn.net/20150611171559589" alt></p>
<h4 id="删除表"><a href="#删除表" class="headerlink" title="删除表"></a><strong>删除表</strong></h4><pre><code>drop table [if exists] tbl_name;

eg:
drop table exam_student;
表不存在，不能删除，会报告错误。
drop table if exists exam_student;
不会报错，因为已经做了一次判断。
</code></pre><h4 id="修改表"><a href="#修改表" class="headerlink" title="修改表"></a><strong>修改表</strong></h4><p>重命名表名：<code>rename table tbl_name to new_tbl_name;</code> 。可以<strong>同时针对多个表进行重命名，甚至可以跨数据库。</strong> 修改表结构：<code>alter table</code>。可以提供对表选项和列定义的修改。</p>
<pre><code>重名名相当于剪切操作
eg:
rename table classroom to stu_class;

支持同时修改多个表名。
rename table classroom to stu_class,info_student to exam_user;
支持跨数据库重命名。
rename table exam_user to `1234`.user;

重命名数据库（数据库不支持rename）
创建一个新的数据库，就的数据库内的表，都rename到新的数据库内，删除旧的数据库。
</code></pre><p>修改列定义：</p>
<pre><code>add     增加  可以同时增加多个列，使用括号括起来多个列的定义。
modify  修改
change  重命名
drop    删除
</code></pre><p>修改表结构：</p>
<pre><code>alter table exam [add|drop|change|modify]

eg:
添加:
alter table info_student add age int;
desc info_student; 
删除:
alter table info_student drop age;
desc info_student;
修改:
alter table info_student modify stu_no varchar(40);
desc info_student;
重命名:
alter table info_student change age stu_age int;
desc info_student;
</code></pre><p><img src="http://img.blog.csdn.net/20150611193800787" alt> <img src="http://img.blog.csdn.net/20150611194805231" alt> 修改表选项</p>
<pre><code>alter table info_student character set gbk;
</code></pre><p><img src="http://img.blog.csdn.net/20150611195529208" alt></p>

            
            <p class="more">
                <a href="/2015/06/12/2019030500158/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2015/06/12/2019030500158/" title="SQL结构化查询语言">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/2.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/MySQL/">MySQL</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2015/06/04/2019030500040/">
    		简单查询部分sql练习题
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2015-06-04T05:30:59.000Z">2015-06-04</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/SQL/" title="SQL">SQL</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <p>简单查询部分sql练习题:</p>
<ol>
<li>– 选择部门30中的所有职工</li>
<li><p>select * from emp where deptno = 30;</p>
</li>
<li><p>– 列出所有业务员(CLERK)的姓名，编号，和部门编号</p>
</li>
<li><p>select e.ename, e.empno, e.deptno from emp e where e.job = ‘CLERK’;</p>
</li>
<li><p>– 找出奖金高于薪金的员工</p>
</li>
<li><p>select * from emp where comm &gt; sal;</p>
</li>
<li><p>– 找出奖金高于薪金的60%的员工</p>
</li>
<li><p>select <em> from emp where comm &gt; sal </em> 0.6;</p>
</li>
<li><p>– 找出部门10中所有经理(MANAGER)和部门20中所有业务员(CLERK)的详细资料</p>
</li>
<li>select * from emp e</li>
<li>where e.deptno = 10 and e.job = ‘MANAGER’</li>
<li><p>or e.deptno = 20 and e.job = ‘CLERK’;</p>
</li>
<li><p>select * from emp e</p>
</li>
<li>where (e.deptno = 10 and e.job = ‘MANAGER’)</li>
<li><p>or (e.deptno = 20 and e.job = ‘CLERK’);</p>
</li>
<li><p>select * from emp e where e.deptno = 10 and e.job = ‘MANAGER’</p>
</li>
<li>union</li>
<li><p>select * from emp e where e.deptno = 20 and e.job = ‘CLERK’;</p>
</li>
<li><p>– 找出部门10中所有经理(MANAGER),部门20中所有业务员(CLERK),既不是经理又不是业务员但其薪水大于等于2000的所有员工的详细资料</p>
</li>
<li>select * from emp e where e.deptno = 10 and e.job = ‘MANAGER’</li>
<li>union</li>
<li>select * from emp e where e.deptno = 20 and e.job = ‘CLERK’</li>
<li>union</li>
<li><p>select * from emp e where e.sal &gt; 2000 and e.job not in(‘MANAGER’, ‘CLERK’);</p>
</li>
<li><p>– 找出收取奖金的员工的不同工作</p>
</li>
<li><p>select distinct e.job from emp e;</p>
</li>
<li><p>– 找出不收取奖金或收取的奖金低于100的员工</p>
</li>
<li><p>select * from emp e where e.comm is null or e.comm &lt; 100;</p>
</li>
<li><p>– 找出各月倒数第3天受雇的所有员工</p>
</li>
<li><p>select * from emp e where e.hiredate between last_day(hiredate)-3 and last_day(hiredate);</p>
</li>
<li><p>– 找出早于30年前受雇的员工</p>
</li>
<li><p>select * from emp e where (sysdate - e.hiredate)/365 &gt; 30;</p>
</li>
<li><p>– 以首字母大写的方式显示所有员工的姓名</p>
</li>
<li><p>select initcap(ename) from emp;</p>
</li>
<li><p>– 显示正好为5个字符的员工姓名</p>
</li>
<li><p>select * from emp where length(ename) = 5;</p>
</li>
<li><p>– 显示不带有”R”的员工姓名</p>
</li>
<li><p>select * from emp where ename not like ‘%K%’;</p>
</li>
<li><p>– 显示所有员工姓名的前三个字符</p>
</li>
<li><p>select substr(ename, 0, 3) from emp;</p>
</li>
<li><p>– 显示所有员工的姓名，并用’a’替换所有’A’</p>
</li>
<li><p>select replace(ename, ‘A’, ‘a’) from emp;</p>
</li>
<li><p>– 显示满30年服务年限的员工姓名和受雇日期</p>
</li>
<li><p>select * from emp where (sysdate - hiredate)/365 &gt; 30;</p>
</li>
<li><p>– 显示员工的详细资料，按姓名由大到小排序</p>
</li>
<li><p>select * from emp order by ename desc;</p>
</li>
<li><p>– 显示员工的姓名和受雇日期，根据其服务年限，将最老的员工排在最前面</p>
</li>
<li><p>select ename, hiredate from emp order by hiredate asc;</p>
</li>
<li><p>– 显示所有员工的姓名，工作和薪金，按工作降序排列，若工作相同则按薪金升序排序</p>
</li>
<li>select ename, job, sal from emp order by job desc, sal asc;</li>
<li><p>select ename, job, sal from emp order by 2 desc, 3;</p>
</li>
<li><p>– 显示所有员工的姓名，加入公司的年份和月份，按受雇日期所在的月排序，若月份相同，则将最早年份排在最前面</p>
</li>
<li><p>select ename, to_number(to_char(hiredate, ‘yyyy’)) Year, to_number(to_char(hiredate, ‘mm’)) from emp order by 3 desc, 2 asc;</p>
</li>
<li><p>– 显示一个月为30天的情况所员工的日薪金，忽略余数</p>
</li>
<li><p>select round(sal/30) 日薪 from emp;</p>
</li>
<li><p>– 找出在(任何年份)2月受聘的所有员工</p>
</li>
<li><p>select * from emp where to_number(to_char(hiredate, ‘mm’)）= 2;</p>
</li>
<li><p>– 对每个员工，显示其加入公司的天数</p>
</li>
<li><p>select ename, round(sysdate - hiredate) Days from emp;</p>
</li>
<li><p>– 显示姓名中任意位置包含“A”的所有员工姓名</p>
</li>
<li><p>select * from emp where upper(ename) like ‘%A%’;</p>
</li>
<li><p>– 以年月日方式显示所有员工的服务年限</p>
</li>
<li>select ename, hiredate,</li>
<li>trunc(months_between(sysdate, hiredate) /12)  year  ,</li>
<li>trunc(mod(months_between(sysdate, hiredate) ,  12 ) ) months  ,</li>
<li>trunc(sysdate - add_months(hiredate,months_between(sysdate, hiredate))) day</li>
<li>from emp ;</li>
</ol>

            
            <p class="more">
                <a href="/2015/06/04/2019030500040/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2015/06/04/2019030500040/" title="简单查询部分sql练习题">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/4.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/MySQL/">MySQL</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2015/05/28/2019030500001/">
    		50条SQL查询技巧
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2015-05-28T07:03:17.000Z">2015-05-28</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/SQL/" title="SQL">SQL</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <ol>
<li>Student(S#,Sname,Sage,Ssex) 学生表</li>
<li>Course(C#,Cname,T#) 课程表</li>
<li>SC(S#,C#,score) 成绩表</li>
<li><p>Teacher(T#,Tname) 教师表</p>
</li>
<li><p>问题：</p>
</li>
<li>1、查询“001”课程比“002”课程成绩高的所有学生的学号；</li>
<li>select a.S# from (select s#,score from SC where C#=’001’) a,(select s#,score</li>
<li>from SC where C#=’002’) b</li>
<li>where a.score&gt;b.score and a.s#=b.s#;</li>
<li>2、查询平均成绩大于60分的同学的学号和平均成绩；</li>
<li>select S#,avg(score)</li>
<li>from sc</li>
<li>group by S# having avg(score) &gt;60;</li>
<li>3、查询所有同学的学号、姓名、选课数、总成绩；</li>
<li>select Student.S#,Student.Sname,count(SC.C#),sum(score)</li>
<li>from Student left Outer join SC on Student.S#=SC.S#</li>
<li>group by Student.S#,Sname</li>
<li>4、查询姓“李”的老师的个数；</li>
<li>select count(distinct(Tname))</li>
<li>from Teacher</li>
<li>where Tname like ‘李%’;</li>
<li>5、查询没学过“叶平”老师课的同学的学号、姓名；</li>
<li>select Student.S#,Student.Sname</li>
<li>from Student</li>
<li>where S# not in (select distinct( SC.S#) from SC,Course,Teacher where SC.C#=Course.C# and Teacher.T#=Course.T# and Teacher.Tname=’叶平’);</li>
<li>6、查询学过“001”并且也学过编号“002”课程的同学的学号、姓名；</li>
<li>select Student.S#,Student.Sname from Student,SC where Student.S#=SC.S# and SC.C#=’001’and exists( Select * from SC as SC_2 where SC_2.S#=SC.S# and SC_2.C#=’002’);</li>
<li>7、查询学过“叶平”老师所教的所有课的同学的学号、姓名；</li>
<li>select S#,Sname</li>
<li>from Student</li>
<li>where S# in (select S# from SC ,Course ,Teacher where SC.C#=Course.C# and Teacher.T#=Course.T# and Teacher.Tname=’叶平’ group by S# having count(SC.C#)=(select count(C#) from Course,Teacher where Teacher.T#=Course.T# and Tname=’叶平’));</li>
<li>8、查询课程编号“002”的成绩比课程编号“001”课程低的所有同学的学号、姓名；</li>
<li>Select S#,Sname from (select Student.S#,Student.Sname,score ,(select score from SC SC_2 where SC_2.S#=Student.S# and SC_2.C#=’002’) score2</li>
<li>from Student,SC where Student.S#=SC.S# and C#=’001’) S_2 where score2 &lt;score;</li>
<li>9、查询所有课程成绩小于60分的同学的学号、姓名；</li>
<li>select S#,Sname</li>
<li>from Student</li>
<li>where S# not in (select Student.S# from Student,SC where S.S#=SC.S# and score&gt;60);</li>
<li>10、查询没有学全所有课的同学的学号、姓名；</li>
<li>select Student.S#,Student.Sname</li>
<li>from Student,SC</li>
<li><p>where Student.S#=SC.S# group by Student.S#,Student.Sname having count(C#) &lt;(select count(C#) from Course);</p>
</li>
<li><p>11、查询至少有一门课与学号为“1001”的同学所学相同的同学的学号和姓名；</p>
</li>
<li>select S#,Sname from Student,SC where Student.S#=SC.S# and C# in select C# from SC where S#=’1001’;</li>
<li>12、查询至少学过学号为“001”同学所有一门课的其他同学学号和姓名；</li>
<li>select distinct SC.S#,Sname</li>
<li>from Student,SC</li>
<li>where Student.S#=SC.S# and C# in (select C# from SC where S#=’001’);</li>
<li>13、把“SC”表中“叶平”老师教的课的成绩都更改为此课程的平均成绩；</li>
<li>update SC set score=(select avg(SC_2.score)</li>
<li>from SC SC_2</li>
<li>where SC_2.C#=SC.C# ) from Course,Teacher where Course.C#=SC.C# and Course.T#=Teacher.T# and Teacher.Tname=’叶平’);</li>
<li>14、查询和“1002”号的同学学习的课程完全相同的其他同学学号和姓名；</li>
<li>select S# from SC where C# in (select C# from SC where S#=’1002’)</li>
<li>group by S# having count(<em>)=(select count(</em>) from SC where S#=’1002’);</li>
<li>15、删除学习“叶平”老师课的SC表记录；</li>
<li>Delect SC</li>
<li>from course ,Teacher</li>
<li>where Course.C#=SC.C# and Course.T#= Teacher.T# and Tname=’叶平’;</li>
<li>16、向SC表中插入一些记录，这些记录要求符合以下条件：没有上过编号“003”课程的同学学号、2、</li>
<li>号课的平均成绩；</li>
<li>Insert SC select S#,’002’,(Select avg(score)</li>
<li>from SC where C#=’002’) from Student where S# not in (Select S# from SC where C#=’002’);</li>
<li>17、按平均成绩从高到低显示所有学生的“数据库”、“企业管理”、“英语”三门的课程成绩，按如下形式显示： 学生ID,,数据库,企业管理,英语,有效课程数,有效平均分</li>
<li>SELECT S# as 学生ID</li>
<li>,(SELECT score FROM SC WHERE SC.S#=t.S# AND C#=’004’) AS 数据库</li>
<li>,(SELECT score FROM SC WHERE SC.S#=t.S# AND C#=’001’) AS 企业管理</li>
<li>,(SELECT score FROM SC WHERE SC.S#=t.S# AND C#=’006’) AS 英语</li>
<li>,COUNT(*) AS 有效课程数, AVG(t.score) AS 平均成绩</li>
<li>FROM SC AS t</li>
<li>GROUP BY S#</li>
<li>ORDER BY avg(t.score)</li>
<li>18、查询各科成绩最高和最低的分：以如下形式显示：课程ID，最高分，最低分</li>
<li>SELECT L.C# As 课程ID,L.score AS 最高分,R.score AS 最低分</li>
<li>FROM SC L ,SC AS R</li>
<li>WHERE L.C# = R.C# and</li>
<li>L.score = (SELECT MAX(IL.score)</li>
<li>FROM SC AS IL,Student AS IM</li>
<li>WHERE L.C# = IL.C# and IM.S#=IL.S#</li>
<li>GROUP BY IL.C#)</li>
<li>AND</li>
<li>R.Score = (SELECT MIN(IR.score)</li>
<li>FROM SC AS IR</li>
<li>WHERE R.C# = IR.C#</li>
<li>GROUP BY IR.C#</li>
<li>);</li>
<li>19、按各科平均成绩从低到高和及格率的百分数从高到低顺序</li>
<li>SELECT t.C# AS 课程号,max(course.Cname)AS 课程名,isnull(AVG(score),0) AS 平均成绩</li>
<li>,100 <em> SUM(CASE WHEN isnull(score,0)&gt;=60 THEN 1 ELSE 0 END)/COUNT(</em>) AS 及格百分数</li>
<li>FROM SC T,Course</li>
<li>where t.C#=course.C#</li>
<li>GROUP BY t.C#</li>
<li>ORDER BY 100 <em> SUM(CASE WHEN isnull(score,0)&gt;=60 THEN 1 ELSE 0 END)/COUNT(</em>) DESC</li>
<li>20、查询如下课程平均成绩和及格率的百分数(用”1行”显示): 企业管理（001），马克思（002），OO&amp;UML （003），数据库（004）</li>
<li>SELECT SUM(CASE WHEN C# =’001’ THEN score ELSE 0 END)/SUM(CASE C# WHEN ‘001’ THEN 1 ELSE 0 END) AS 企业管理平均分</li>
<li>,100 * SUM(CASE WHEN C# = ‘001’ AND score &gt;= 60 THEN 1 ELSE 0 END)/SUM(CASE WHEN C# = ‘001’ THEN 1 ELSE 0 END) AS 企业管理及格百分数</li>
<li>,SUM(CASE WHEN C# = ‘002’ THEN score ELSE 0 END)/SUM(CASE C# WHEN ‘002’ THEN 1 ELSE 0 END) AS 马克思平均分</li>
<li>,100 * SUM(CASE WHEN C# = ‘002’ AND score &gt;= 60 THEN 1 ELSE 0 END)/SUM(CASE WHEN C# = ‘002’ THEN 1 ELSE 0 END) AS 马克思及格百分数</li>
<li>,SUM(CASE WHEN C# = ‘003’ THEN score ELSE 0 END)/SUM(CASE C# WHEN ‘003’ THEN 1 ELSE 0 END) AS UML平均分</li>
<li>,100 * SUM(CASE WHEN C# = ‘003’ AND score &gt;= 60 THEN 1 ELSE 0 END)/SUM(CASE WHEN C# = ‘003’ THEN 1 ELSE 0 END) AS UML及格百分数</li>
<li>,SUM(CASE WHEN C# = ‘004’ THEN score ELSE 0 END)/SUM(CASE C# WHEN ‘004’ THEN 1 ELSE 0 END) AS 数据库平均分</li>
<li>,100 * SUM(CASE WHEN C# = ‘004’ AND score &gt;= 60 THEN 1 ELSE 0 END)/SUM(CASE WHEN C# = ‘004’ THEN 1 ELSE 0 END) AS 数据库及格百分数</li>
<li><p>FROM SC</p>
</li>
<li><p>21、查询不同老师所教不同课程平均分从高到低显示</p>
</li>
<li>SELECT max(Z.T#) AS 教师ID,MAX(Z.Tname) AS 教师姓名,C.C# AS 课程ＩＤ,MAX(C.Cname) AS 课程名称,AVG(Score) AS 平均成绩</li>
<li>FROM SC AS T,Course AS C ,Teacher AS Z</li>
<li>where T.C#=C.C# and C.T#=Z.T#</li>
<li>GROUP BY C.C#</li>
<li>ORDER BY AVG(Score) DESC</li>
<li>22、查询如下课程成绩第 3 名到第 6 名的学生成绩单：企业管理（001），马克思（002），UML （003），数据库（004）</li>
<li>[学生ID],[学生姓名],企业管理,马克思,UML,数据库,平均成绩</li>
<li>SELECT DISTINCT top 3</li>
<li>SC.S# As 学生学号,</li>
<li>Student.Sname AS 学生姓名 ,</li>
<li>T1.score AS 企业管理,</li>
<li>T2.score AS 马克思,</li>
<li>T3.score AS UML,</li>
<li>T4.score AS 数据库,</li>
<li>ISNULL(T1.score,0) + ISNULL(T2.score,0) + ISNULL(T3.score,0) + ISNULL(T4.score,0) as 总分</li>
<li>FROM Student,SC LEFT JOIN SC AS T1</li>
<li>ON SC.S# = T1.S# AND T1.C# = ‘001’</li>
<li>LEFT JOIN SC AS T2</li>
<li>ON SC.S# = T2.S# AND T2.C# = ‘002’</li>
<li>LEFT JOIN SC AS T3</li>
<li>ON SC.S# = T3.S# AND T3.C# = ‘003’</li>
<li>LEFT JOIN SC AS T4</li>
<li>ON SC.S# = T4.S# AND T4.C# = ‘004’</li>
<li>WHERE student.S#=SC.S# and</li>
<li>ISNULL(T1.score,0) + ISNULL(T2.score,0) + ISNULL(T3.score,0) + ISNULL(T4.score,0)</li>
<li>NOT IN</li>
<li>(SELECT</li>
<li>DISTINCT</li>
<li>TOP 15 WITH TIES</li>
<li>ISNULL(T1.score,0) + ISNULL(T2.score,0) + ISNULL(T3.score,0) + ISNULL(T4.score,0)</li>
<li>FROM sc</li>
<li>LEFT JOIN sc AS T1</li>
<li>ON sc.S# = T1.S# AND T1.C# = ‘k1’</li>
<li>LEFT JOIN sc AS T2</li>
<li>ON sc.S# = T2.S# AND T2.C# = ‘k2’</li>
<li>LEFT JOIN sc AS T3</li>
<li>ON sc.S# = T3.S# AND T3.C# = ‘k3’</li>
<li>LEFT JOIN sc AS T4</li>
<li>ON sc.S# = T4.S# AND T4.C# = ‘k4’</li>
<li><p>ORDER BY ISNULL(T1.score,0) + ISNULL(T2.score,0) + ISNULL(T3.score,0) + ISNULL(T4.score,0) DESC);</p>
</li>
<li><p>23、统计列印各科成绩,各分数段人数:课程ID,课程名称,[100-85],[85-70],[70-60],[ &lt;60]</p>
</li>
<li>SELECT SC.C# as 课程ID, Cname as 课程名称</li>
<li>,SUM(CASE WHEN score BETWEEN 85 AND 100 THEN 1 ELSE 0 END) AS [100 - 85]</li>
<li>,SUM(CASE WHEN score BETWEEN 70 AND 85 THEN 1 ELSE 0 END) AS [85 - 70]</li>
<li>,SUM(CASE WHEN score BETWEEN 60 AND 70 THEN 1 ELSE 0 END) AS [70 - 60]</li>
<li>,SUM(CASE WHEN score &lt; 60 THEN 1 ELSE 0 END) AS [60 -]</li>
<li>FROM SC,Course</li>
<li>where SC.C#=Course.C#</li>
<li><p>GROUP BY SC.C#,Cname;</p>
</li>
<li><p>24、查询学生平均成绩及其名次</p>
</li>
<li>SELECT 1+(SELECT COUNT( distinct 平均成绩)</li>
<li>FROM (SELECT S#,AVG(score) AS 平均成绩</li>
<li>FROM SC</li>
<li>GROUP BY S#</li>
<li>) AS T1</li>
<li>WHERE 平均成绩 &gt; T2.平均成绩) as 名次,</li>
<li>S# as 学生学号,平均成绩</li>
<li>FROM (SELECT S#,AVG(score) 平均成绩</li>
<li>FROM SC</li>
<li>GROUP BY S#</li>
<li>) AS T2</li>
<li><p>ORDER BY 平均成绩 desc;</p>
</li>
<li><p>25、查询各科成绩前三名的记录:(不考虑成绩并列情况)</p>
</li>
<li>SELECT t1.S# as 学生ID,t1.C# as 课程ID,Score as 分数</li>
<li>FROM SC t1</li>
<li>WHERE score IN (SELECT TOP 3 score</li>
<li>FROM SC</li>
<li>WHERE t1.C#= C#</li>
<li>ORDER BY score DESC</li>
<li>)</li>
<li>ORDER BY t1.C#;</li>
<li>26、查询每门课程被选修的学生数</li>
<li>select c#,count(S#) from sc group by C#;</li>
<li>27、查询出只选修了一门课程的全部学生的学号和姓名</li>
<li>select SC.S#,Student.Sname,count(C#) AS 选课数</li>
<li>from SC ,Student</li>
<li>where SC.S#=Student.S# group by SC.S# ,Student.Sname having count(C#)=1;</li>
<li>28、查询男生、女生人数</li>
<li>Select count(Ssex) as 男生人数 from Student group by Ssex having Ssex=’男’;</li>
<li>Select count(Ssex) as 女生人数 from Student group by Ssex having Ssex=’女’；</li>
<li>29、查询姓“张”的学生名单</li>
<li>SELECT Sname FROM Student WHERE Sname like ‘张%’;</li>
<li>30、查询同名同性学生名单，并统计同名人数</li>
<li>select Sname,count(<em>) from Student group by Sname having count(</em>)&gt;1;</li>
<li>31、1981年出生的学生名单(注：Student表中Sage列的类型是datetime)</li>
<li>select Sname, CONVERT(char (11),DATEPART(year,Sage)) as age</li>
<li>from student</li>
<li>where CONVERT(char(11),DATEPART(year,Sage))=’1981’;</li>
<li>32、查询每门课程的平均成绩，结果按平均成绩升序排列，平均成绩相同时，按课程号降序排列</li>
<li>Select C#,Avg(score) from SC group by C# order by Avg(score),C# DESC ;</li>
<li>33、查询平均成绩大于85的所有学生的学号、姓名和平均成绩</li>
<li>select Sname,SC.S# ,avg(score)</li>
<li>from Student,SC</li>
<li>where Student.S#=SC.S# group by SC.S#,Sname having avg(score)&gt;85;</li>
<li>34、查询课程名称为“数据库”，且分数低于60的学生姓名和分数</li>
<li>Select Sname,isnull(score,0)</li>
<li>from Student,SC,Course</li>
<li>where SC.S#=Student.S# and SC.C#=Course.C# and Course.Cname=’数据库’and score &lt;60;</li>
<li>35、查询所有学生的选课情况；</li>
<li>SELECT SC.S#,SC.C#,Sname,Cname</li>
<li>FROM SC,Student,Course</li>
<li>where SC.S#=Student.S# and SC.C#=Course.C# ;</li>
<li>36、查询任何一门课程成绩在70分以上的姓名、课程名称和分数；</li>
<li>SELECT distinct student.S#,student.Sname,SC.C#,SC.score</li>
<li>FROM student,Sc</li>
<li>WHERE SC.score&gt;=70 AND SC.S#=student.S#;</li>
<li>37、查询不及格的课程，并按课程号从大到小排列</li>
<li>select c# from sc where scor e &lt;60 order by C# ;</li>
<li>38、查询课程编号为003且课程成绩在80分以上的学生的学号和姓名；</li>
<li>select SC.S#,Student.Sname from SC,Student where SC.S#=Student.S# and Score&gt;80 and C#=’003’;</li>
<li>39、求选了课程的学生人数</li>
<li>select count(*) from sc;</li>
<li>40、查询选修“叶平”老师所授课程的学生中，成绩最高的学生姓名及其成绩</li>
<li>select Student.Sname,score</li>
<li>from Student,SC,Course C,Teacher</li>
<li>where Student.S#=SC.S# and SC.C#=C.C# and C.T#=Teacher.T# and Teacher.Tname=’叶平’ and SC.score=(select max(score)from SC where C#=C.C# );</li>
<li>41、查询各个课程及相应的选修人数</li>
<li>select count(*) from sc group by C#;</li>
<li>42、查询不同课程成绩相同的学生的学号、课程号、学生成绩</li>
<li>select distinct A.S#,B.score from SC A ,SC B where A.Score=B.Score and A.C# &lt;&gt;B.C# ;</li>
<li>43、查询每门功成绩最好的前两名</li>
<li>SELECT t1.S# as 学生ID,t1.C# as 课程ID,Score as 分数</li>
<li>FROM SC t1</li>
<li>WHERE score IN (SELECT TOP 2 score</li>
<li>FROM SC</li>
<li>WHERE t1.C#= C#</li>
<li>ORDER BY score DESC</li>
<li>)</li>
<li>ORDER BY t1.C#;</li>
<li>44、统计每门课程的学生选修人数（超过10人的课程才统计）。要求输出课程号和选修人数，查询结果按人数降序排列，查询结果按人数降序排列，若人数相同，按课程号升序排列</li>
<li>select C# as 课程号,count(*) as 人数</li>
<li>from sc</li>
<li>group by C#</li>
<li>order by count(*) desc,c#</li>
<li>45、检索至少选修两门课程的学生学号</li>
<li>select S#</li>
<li>from sc</li>
<li>group by s#</li>
<li>having count(*) &gt; = 2</li>
<li>46、查询全部学生都选修的课程的课程号和课程名</li>
<li>select C#,Cname</li>
<li>from Course</li>
<li>where C# in (select c# from sc group by c#)</li>
<li>47、查询没学过“叶平”老师讲授的任一门课程的学生姓名</li>
<li>select Sname from Student where S# not in (select S# from Course,Teacher,SC where Course.T#=Teacher.T# and SC.C#=course.C# and Tname=’叶平’);</li>
<li>48、查询两门以上不及格课程的同学的学号及其平均成绩</li>
<li>select S#,avg(isnull(score,0)) from SC where S# in (select S# from SC where score <60 group by s# having count(*)>2)group by S#;</60></li>
<li>49、检索“004”课程分数小于60，按分数降序排列的同学学号</li>
<li>select S# from SC where C#=’004’and score &lt;60 order by score desc;</li>
<li>50、删除“002”同学的“001”课程的成绩</li>
<li>delete from Sc where S#=’001’and C#=’001’;</li>
</ol>

            
            <p class="more">
                <a href="/2015/05/28/2019030500001/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2015/05/28/2019030500001/" title="50条SQL查询技巧">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/8.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/SQL-Server/">SQL Server</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2015/05/25/2019030500161/">
    		SQL Server 2008 R2 为用户分配权限
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2015-05-25T06:44:44.000Z">2015-05-25</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/SQL/" title="SQL">SQL</a> / 
    
        <a href="/tags/Server/" title="Server">Server</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <blockquote>
<h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><p><strong>　　之前我们编写程序的时候都是直接对数据库进行访问，并没有设置什么权限之类的东西，但是在管理数据库的过程中，我们有时候需要控制某个用户访问数据库的权限，比如只能单独的看到属于其管理的某几张表，或者说是拥有CRUD(增加(Create)、读取(Retrieve)（重新得到数据）、更新(Update)和删除(Delete))权限，或者是更小的粒度的划分，总而言之，一切皆是为了系统的安全和操作的方便。</strong></p>
<h1 id="系统需求简介"><a href="#系统需求简介" class="headerlink" title=" 　 系统需求简介"></a> 　 系统需求简介</h1><p><strong>最近一直在做高校云平台这个项目，我们小组做的是其中的一个子系统是成绩管理系统，不同于之前的开发方式，本次我们采用的是分模块开发也就是将划分的粒度变得更加的小了，这样就有一个好处，就是各自负责各自的便于开发和调试。</strong> <strong>但是这样也带来一个问题，就是数据库是共同的，我们采用的是EF映射也就是从数据库生成的实体，如果都是用一个账号进行登陆的话，那么看到将是同样多的表，其实这样是很没有必要的，故而数据库为我们提供了更好的便利，那就是为各个用户分配不同的权限。</strong></p>
<h1 id="操作步骤"><a href="#操作步骤" class="headerlink" title="  　操作步骤"></a>  　操作步骤</h1><h2 id="O-数据库级别登录名建完的效果图如下图所示："><a href="#O-数据库级别登录名建完的效果图如下图所示：" class="headerlink" title="　　Ø  数据库级别登录名建完的效果图如下图所示："></a>　　Ø  数据库级别登录名建完的效果图如下图所示：</h2><p><img src="http://img.blog.csdn.net/20150525143504925?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMDk1NTg0Mw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt></p>
<h2 id="O-具体步骤"><a href="#O-具体步骤" class="headerlink" title="　　Ø  具体步骤"></a>　　Ø  具体步骤</h2><p><strong>　　进入数据库级别的安全性设置—-新建【登录名】，如图：</strong> <strong>　　第一步： 在常规选项卡的中填写：</strong> <strong><img src="http://img.blog.csdn.net/20150525143647770?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMDk1NTg0Mw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt> </strong> <strong>　　服务器角色的不用重新设置</strong> <strong>　　第二步：用户映射选项卡</strong> <img src="http://img.blog.csdn.net/20150525143517561?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMDk1NTg0Mw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt> <strong>　　安全对象不用设置</strong> <strong>　　第三步：状态选项卡</strong> <strong><img src="http://img.blog.csdn.net/20150525143525439?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMDk1NTg0Mw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt> </strong> <strong>　　此时已经设置好了，此时我们该设置这个用户的权限了</strong></p>
<h2 id="O-用户权限的分配"><a href="#O-用户权限的分配" class="headerlink" title="　　Ø  用户权限的分配"></a>　　Ø  用户权限的分配</h2><p><strong>　　选中其中的一张表，进行权限设置，必须是刚才设置时的数据库，否则是看不到的。</strong> <strong><img src="http://img.blog.csdn.net/20150525143534768?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMDk1NTg0Mw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt> 此时进行相应的权限设置即可</strong> <strong> <img src="http://img.blog.csdn.net/20150525143723182?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMDk1NTg0Mw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt></strong> <strong>　　至此已经完成，我们可以用我们设置的登录名和密码进入，此时看到只是我们分配的几张表。自己动手试试吧。</strong></p>
<h1 id="小结"><a href="#小结" class="headerlink" title="  　小结"></a>  　小结</h1><p><strong>　　这里只是做了一些最简单的数据库用户权限的设置，这是自己在开发过程中用到的，别的一些更加复杂的设置，在以后的过程中会逐步去应用和理解。</strong></p>
</blockquote>

            
            <p class="more">
                <a href="/2015/05/25/2019030500161/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2015/05/25/2019030500161/" title="SQL Server 2008 R2 为用户分配权限">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/5.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    

    
    <nav class="page-navigator">
        <a class="extend prev" rel="prev" href="/tags/SQL/">前一页</a><a class="page-number" href="/tags/SQL/">1</a><span class="page-number current">2</span>
    </nav>
    


            </div>

        </section>
        <!-- 侧栏部分 -->
<aside class="sidebar">
    <section class="widget">
        <h3 class="widget-hd"><strong>文章分类</strong></h3>
        <!-- 文章分类 -->
<ul class="widget-bd">
    
    <li>
        <a href="/categories/MySQL/">MySQL</a>
        <span class="badge">(92)</span>
    </li>
    
    <li>
        <a href="/categories/开发语言/">开发语言</a>
        <span class="badge">(7)</span>
    </li>
    
    <li>
        <a href="/categories/Oracle/">Oracle</a>
        <span class="badge">(40)</span>
    </li>
    
    <li>
        <a href="/categories/NOSQL/">NOSQL</a>
        <span class="badge">(17)</span>
    </li>
    
    <li>
        <a href="/categories/SQL-Server/">SQL Server</a>
        <span class="badge">(13)</span>
    </li>
    
    <li>
        <a href="/categories/其他数据库/">其他数据库</a>
        <span class="badge">(4)</span>
    </li>
    
    <li>
        <a href="/categories/MySQL/Oracle/">Oracle</a>
        <span class="badge">(3)</span>
    </li>
    
    <li>
        <a href="/categories/MySQL/Oracle/SQL-Server/">SQL Server</a>
        <span class="badge">(1)</span>
    </li>
    
    <li>
        <a href="/categories/NOSQL/开发语言/">开发语言</a>
        <span class="badge">(1)</span>
    </li>
    
</ul>
    </section>

    
    <section class="widget">
        <h3 class="widget-hd"><strong>热门标签</strong></h3>
        <!-- 文章标签 -->
<div class="widget-bd tag-wrap">
  
    <a class="tag-item" href="/tags/MySQL/" title="MySQL">MySQL (71)</a>
  
    <a class="tag-item" href="/tags/位运算/" title="位运算">位运算 (0)</a>
  
    <a class="tag-item" href="/tags/allow/" title="allow">allow (1)</a>
  
    <a class="tag-item" href="/tags/Apache/" title="Apache">Apache (1)</a>
  
    <a class="tag-item" href="/tags/deny/" title="deny">deny (1)</a>
  
    <a class="tag-item" href="/tags/sqlplus/" title="sqlplus">sqlplus (1)</a>
  
    <a class="tag-item" href="/tags/CentOS/" title="CentOS">CentOS (2)</a>
  
    <a class="tag-item" href="/tags/druid/" title="druid">druid (1)</a>
  
    <a class="tag-item" href="/tags/心跳/" title="心跳">心跳 (1)</a>
  
    <a class="tag-item" href="/tags/redis/" title="redis">redis (6)</a>
  
    <a class="tag-item" href="/tags/分库/" title="分库">分库 (1)</a>
  
    <a class="tag-item" href="/tags/分库分表/" title="分库分表">分库分表 (1)</a>
  
    <a class="tag-item" href="/tags/分表/" title="分表">分表 (1)</a>
  
    <a class="tag-item" href="/tags/Oracle/" title="Oracle">Oracle (30)</a>
  
    <a class="tag-item" href="/tags/schedule-job/" title="schedule job">schedule job (1)</a>
  
    <a class="tag-item" href="/tags/事务/" title="事务">事务 (5)</a>
  
    <a class="tag-item" href="/tags/分布式/" title="分布式">分布式 (1)</a>
  
    <a class="tag-item" href="/tags/消息/" title="消息">消息 (1)</a>
  
    <a class="tag-item" href="/tags/KeepAlived/" title="KeepAlived">KeepAlived (1)</a>
  
    <a class="tag-item" href="/tags/数据库/" title="数据库">数据库 (7)</a>
  
    <a class="tag-item" href="/tags/结构同步/" title="结构同步">结构同步 (1)</a>
  
    <a class="tag-item" href="/tags/truncate/" title="truncate">truncate (1)</a>
  
    <a class="tag-item" href="/tags/FineReport/" title="FineReport">FineReport (1)</a>
  
    <a class="tag-item" href="/tags/SQL/" title="SQL">SQL (17)</a>
  
    <a class="tag-item" href="/tags/报表/" title="报表">报表 (1)</a>
  
    <a class="tag-item" href="/tags/数据集/" title="数据集">数据集 (1)</a>
  
    <a class="tag-item" href="/tags/Excel/" title="Excel">Excel (1)</a>
  
    <a class="tag-item" href="/tags/Sqlite/" title="Sqlite">Sqlite (1)</a>
  
    <a class="tag-item" href="/tags/批量/" title="批量">批量 (1)</a>
  
    <a class="tag-item" href="/tags/Linux/" title="Linux">Linux (2)</a>
  
    <a class="tag-item" href="/tags/Character-set/" title="Character set">Character set (1)</a>
  
    <a class="tag-item" href="/tags/NLS-LANG/" title="NLS_LANG">NLS_LANG (1)</a>
  
    <a class="tag-item" href="/tags/rowid/" title="rowid">rowid (2)</a>
  
    <a class="tag-item" href="/tags/重复/" title="重复">重复 (1)</a>
  
    <a class="tag-item" href="/tags/Hash索引/" title="Hash索引">Hash索引 (1)</a>
  
    <a class="tag-item" href="/tags/InnoDB/" title="InnoDB">InnoDB (3)</a>
  
    <a class="tag-item" href="/tags/MyISAM/" title="MyISAM">MyISAM (3)</a>
  
    <a class="tag-item" href="/tags/索引优化/" title="索引优化">索引优化 (1)</a>
  
    <a class="tag-item" href="/tags/mysqldump/" title="mysqldump">mysqldump (2)</a>
  
</div>
    </section>
    

    

    
    <!-- 友情链接 -->
    <section class="widget">
        <h3 class="widget-hd"><strong>友情链接</strong></h3>
        <!-- 文章分类 -->
<ul class="widget-bd">
    
        <li>
            <a href="http://www.devba.com" target="_blank" title="软件开发吧">软件开发吧</a>
        </li>
    
        <li>
            <a href="https://www.sqlyun.cn" target="_blank" title="SQL云笔记">SQL云</a>
        </li>
    
</ul>
    </section>
    
</aside>
<!-- / 侧栏部分 -->
    </div>

    <!-- 博客底部 -->
    <footer class="footer">
    &copy;
    
        2016-2019
    

    <a href="/">Jelon Loves You</a>
</footer>
<div class="back-to-top" id="JELON__backToTop" title="返回顶部">返回顶部</div>

    <!--博客js脚本 -->
    <!-- 这里放网站js脚本 -->
<script src="/js/main.js"></script>
</body>
</html>