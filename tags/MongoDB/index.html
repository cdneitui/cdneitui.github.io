<!doctype html>
<html lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=11,IE=10,IE=9,IE=8">
    <meta name="baidu-site-verification" content="dIcXMeY8Ya">
    
    <title>`MongoDB`标签下的文章 | 软件开发吧</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
    <meta name="keywords" content="SQL云,SQL云开发,SQL笔记,SQL开发,云开发,MySQL,Oralce,数据库,数据库云,数据库开发,数据库云开发,SQL教程,数据库教程,开发笔记,MySQL笔记,MySQL教程">
    <meta name="description" content="为满足广大程序猿兄弟对日常工作中学习数据库、使用使用数据库资料查询需求，SQL云开发免费将自己整理的各种数据库技术资料分享出来，并希望与广大猿兄一起讨论学习与进步,致力于一起更方便、快捷资料学习查询,实现更安全、高效的数据存储.">

    
    <link rel="alternative" href="/atom.xml" title="软件开发吧" type="application/atom+xml">
    
    
    <link rel="shortcut icon" href="/favicon.ico">
    
    <link rel="stylesheet" href="/css/style.css">
    <!--[if lt IE 9]>
    <script src="/js/html5.js"></script>
    <![endif]-->
    
<script>
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "//hm.baidu.com/hm.js?fd459238242776d173cdc64918fb32f2";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>


</head>
</html>
<body class="home">
    <!--[if lt IE 9]>
    <div class="browsehappy">
        当前网页 <strong>不支持</strong>
        你正在使用的浏览器. 为了正常的访问, 请 <a href="http://browsehappy.com/">升级你的浏览器</a>.
    </div>
    <![endif]-->

    <!-- 博客头部 -->
    <header class="header">
    <section class="container header-main">
        <div class="logo">
            <a href="/">
                <div class="cover">
                    <span class="name">软件开发吧</span>
                    <span class="description"></span>
                </div>
            </a>
        </div>
        <div class="dropnav icon-paragraph-justify" id="JELON__btnDropNav"></div>
        <ul class="menu hidden" id="JELON__menu">
            
            <li rel="/tags/MongoDB/index.html" class="item ">
                <a href="/" title="首页" class="icon-home">&nbsp;首页</a>
            </li>
            
            <li rel="/tags/MongoDB/index.html" class="item ">
                <a href="/lab/" title="实验室" class="icon-lab">&nbsp;实验室</a>
            </li>
            
            <li rel="/tags/MongoDB/index.html" class="item ">
                <a href="/about/" title="关于" class="icon-about">&nbsp;关于</a>
            </li>
            
            <li rel="/tags/MongoDB/index.html" class="item ">
                <a href="/comment/" title="留言" class="icon-comment">&nbsp;留言</a>
            </li>
            
        </ul>
        <div class="profile clearfix">
            <div class="feeds fl">
                
                
                <p class="links">
                    
                        <a href="https://github.com/sxyyhj" target="_blank">Github</a>
                        |
                    
                        <a href="https://pages.coding.me" target="_blank">Hosted by Coding Pages</a>
                        
                    
                </p>
                <p class="sns">
                    
                    <a href="javascript: void(0);" class="wechat">
                        <b>■</b>
                        公众号
                        <span class="popover">
                            <img src="/img/wechat_mp.jpg" width="120" height="120" alt="我的微信订阅号">
                            <i class="arrow"></i>
                        </span>
                    </a>
                </p>
                
            </div>
            <div class="avatar fr">
                <img src="/img/jelon.jpg" alt="avatar" title="Jelon">
            </div>
        </div>
    </section>
</header>


    <!-- 博客正文 -->
    <div class="container body clearfix">
        <section class="content">
            <div class="content-main widget">
                <!-- 按标签分类 -->

    <h3 class="widget-hd">
        <strong>
            
                `MongoDB`标签下的文章
            
        </strong>
    </h3>
    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/NOSQL/">NOSQL</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2016/02/16/2019030500058/">
    		mongodb最新java驱动CRUD使用演示
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2016-02-16T06:08:35.000Z">2016-02-16</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/MongoDB/" title="MongoDB">MongoDB</a> / 
    
        <a href="/tags/Java/" title="Java">Java</a> / 
    
        <a href="/tags/CRUD/" title="CRUD">CRUD</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <p>今天使用java代码调用mongodb数据库，用maven引入了最新版的mongodb驱动，在网上找了demo结果发现将demo贴到eclipse上之后好多过期方法。所以猜想mongodb驱动版本肯定有很大的更新。 果不其然，mongodb的确有了最新版3.x。而网上几乎所有的demo都基于2.x版本。下面是在github上找的一些资料，再结合官方文档总结的3.x版本的CRUD操作。   以下演示源码地址：<a href="https://github.com/smallbug-vip/repo" target="_blank" rel="noopener">https://github.com/smallbug-vip/repo</a>   首先在pom.xml中配置引入jar包：</p>
<p>Xml代码</p>
<ol>
<li><dependency></dependency></li>
<li><groupid>org.mongodb</groupid></li>
<li><artifactid>mongo-java-driver</artifactid></li>
<li><version>3.2.1</version></li>
<li></li>
</ol>
<p>下面演示会使用到一些静态方法，eclipse中使用快捷键不能自动导包，可以手动添加：</p>
<p>Java代码</p>
<ol>
<li>import static com.mongodb.client.model.Filters.and;</li>
<li>import static com.mongodb.client.model.Filters.eq;</li>
<li>import static com.mongodb.client.model.Filters.exists;</li>
<li>import static com.mongodb.client.model.Filters.gt;</li>
<li>import static com.mongodb.client.model.Filters.gte;</li>
<li>import static com.mongodb.client.model.Filters.lt;</li>
<li>import static com.mongodb.client.model.Filters.lte;</li>
<li>import static com.mongodb.client.model.Projections.excludeId;</li>
<li>import static com.mongodb.client.model.Projections.include;</li>
<li>import static com.mongodb.client.model.Sorts.descending;</li>
</ol>
<p>准备工作：</p>
<p>Java代码</p>
<ol>
<li>MongoDatabase db = null;</li>
<li><p>MongoClient client = null;</p>
</li>
<li><p>@Before</p>
</li>
<li>public void before() {</li>
<li>client = new MongoClient(“192.168.88.132”, 27017);</li>
<li>db = client.getDatabase(“its”);</li>
<li><p>}</p>
</li>
<li><p>@After</p>
</li>
<li>public void after() {</li>
<li>if (client != null) {</li>
<li>client.close();</li>
<li>}</li>
<li>}</li>
</ol>
<p>获取连接：</p>
<p>Java代码</p>
<ol>
<li>@Test</li>
<li><p>public void testCollections() {</p>
</li>
<li><p>MongoIterable<string> collections = db.listCollectionNames();</string></p>
</li>
<li>MongoCursor<string> cu = collections.iterator();</string></li>
<li>for (; cu.hasNext();) {</li>
<li>System.out.println(cu.next());</li>
<li>}</li>
<li>}</li>
</ol>
<p>测试增加一个Document：</p>
<p>Java代码</p>
<ol>
<li>@Test</li>
<li>public void testAdd() {</li>
<li>MongoCollection<document> col = db.getCollection(“s1”);</document></li>
<li>Document doc = new Document(“name”, “MongoDB”)//</li>
<li>.append(“type”, “database”)//</li>
<li>.append(“count”, 1)//</li>
<li>.append(“info”, new Document(“x”, 203).append(“y”, 102));</li>
<li>col.insertOne(doc);</li>
<li>}</li>
</ol>
<p>测试增加多个Document：</p>
<p>Java代码</p>
<ol>
<li>@Test</li>
<li>public void testAddALL() {</li>
<li>MongoCollection<document> col = db.getCollection(“s1”);</document></li>
<li>List<document> dos = new ArrayList<document>();</document></document></li>
<li>for (int i = 0; i &lt; 100; i++) {</li>
<li>dos.add(new Document(“i”, i));</li>
<li>}</li>
<li>col.insertMany(dos);</li>
<li>}</li>
</ol>
<p>查看当前有多少记录：</p>
<p>Java代码</p>
<ol>
<li>@Test</li>
<li>public void testCount() {</li>
<li>MongoCollection<document> col = db.getCollection(“s1”);</document></li>
<li>System.out.println(col.count());</li>
<li>}</li>
</ol>
<p>获取第一条记录：</p>
<p>Java代码</p>
<ol>
<li>@Test</li>
<li>public void testFirst() {</li>
<li>MongoCollection<document> col = db.getCollection(“s1”);</document></li>
<li>Document myDoc = col.find().first();</li>
<li>System.out.println(myDoc.toJson());</li>
<li>}</li>
</ol>
<p>获取第所有记录：</p>
<p>Java代码</p>
<ol>
<li>@Test</li>
<li>public void testFindAll() {</li>
<li>MongoCollection<document> col = db.getCollection(“s1”);</document></li>
<li>/<strong><strong><strong><em>**</em></strong></strong></strong> 第一种方法 <strong><strong><strong><strong><strong>*</strong></strong></strong></strong></strong>/</li>
<li>// MongoCursor<document> cursor = col.find().iterator();</document></li>
<li>// while (cursor.hasNext()) {</li>
<li>// System.out.println(cursor.next().toJson());</li>
<li>// }</li>
<li>/<strong><strong><strong><em>**</em></strong></strong></strong> 第二种方法 <strong><strong><strong><strong><strong>*</strong></strong></strong></strong></strong>/</li>
<li>for (Document cur : col.find()) {</li>
<li>System.out.println(cur.toJson());</li>
<li>}</li>
<li>}</li>
</ol>
<p>分页：</p>
<p>Java代码</p>
<ol>
<li>@Test</li>
<li>public void testLimit() {</li>
<li>MongoCollection<document> col = db.getCollection(“s1”);</document></li>
<li>for (Document cur : col.find().skip(20).limit(10)) {</li>
<li>System.out.println(cur.toJson());</li>
<li>}</li>
<li>}</li>
</ol>
<p>条件查询：</p>
<p>Java代码</p>
<ol>
<li>@Test</li>
<li>public void testFilter() {</li>
<li>MongoCollection<document> col = db.getCollection(“s1”);</document></li>
<li>// eq为静态导入</li>
<li>Document myDoc = col.find(eq(“i”, 71)).first();</li>
<li>System.out.println(myDoc.toJson());</li>
<li>}</li>
</ol>
<p>获得子集：</p>
<p>Java代码</p>
<ol>
<li>@Test</li>
<li>public void testBlock() {</li>
<li>MongoCollection<document> col = db.getCollection(“s1”);</document></li>
<li>Block<document> printBlock = new Block<document>() {</document></document></li>
<li>@Override</li>
<li>public void apply(final Document document) {</li>
<li>System.out.println(document.toJson());</li>
<li>}</li>
<li>};</li>
<li>col.find(and(gt(“i”, 50), lte(“i”, 80))).forEach(printBlock);</li>
<li>}</li>
</ol>
<p>排序：</p>
<p>Java代码</p>
<ol>
<li>@Test</li>
<li>public void testSort() {</li>
<li>MongoCollection<document> col = db.getCollection(“s1”);</document></li>
<li>// 升序 ascending</li>
<li>FindIterable<document> it = col.find(exists(“i”)).sort(descending(“i”));</document></li>
<li>for (Document d : it) {</li>
<li>System.out.println(d.toJson());</li>
<li>}</li>
<li>}</li>
</ol>
<p>筛选字段：</p>
<p>Java代码</p>
<ol>
<li>@Test</li>
<li>public void testProjection() {</li>
<li>MongoCollection<document> col = db.getCollection(“s1”);</document></li>
<li>FindIterable<document> it = col.find()//</document></li>
<li>.projection(and(include(“name”), excludeId()));</li>
<li>for (Document d : it) {</li>
<li>System.out.println(d.toJson());</li>
<li>}</li>
<li>}</li>
</ol>
<p>更新一条Document：</p>
<p>Java代码</p>
<ol>
<li>@Test</li>
<li>public void testUpdateOne() {</li>
<li>MongoCollection<document> col = db.getCollection(“s1”);</document></li>
<li>col.updateOne(//</li>
<li>eq(“i”, 10), new Document(“$set”, new Document(“i”, 110)));</li>
<li>}</li>
</ol>
<p>更新多条记录：</p>
<p>Java代码</p>
<ol>
<li>@Test</li>
<li>public void testUpdateMany() {</li>
<li>MongoCollection<document> col = db.getCollection(“s1”);</document></li>
<li>// $inc 自增</li>
<li>UpdateResult updateResult = col.updateMany(lt(“i”, 10), new Document(“$inc”, new Document(“i”, 234)));</li>
<li>System.out.println(updateResult.getModifiedCount());</li>
<li>}</li>
</ol>
<p>测试删除一条Document：</p>
<p>Java代码</p>
<ol>
<li>@Test</li>
<li>public void testDeleteOne() {</li>
<li>MongoCollection<document> col = db.getCollection(“s1”);</document></li>
<li>DeleteResult re = col.deleteOne(eq(“i”, 234));</li>
<li>System.out.println(re.getDeletedCount());</li>
<li>}</li>
</ol>
<p>测试删除多条Document：</p>
<p>Java代码</p>
<ol>
<li>@Test</li>
<li>public void testDeleteMany() {</li>
<li>MongoCollection<document> col = db.getCollection(“s1”);</document></li>
<li>DeleteResult deleteResult = col.deleteMany(gte(“i”, 100));</li>
<li>System.out.println(deleteResult.getDeletedCount());</li>
<li>}</li>
</ol>

            
            <p class="more">
                <a href="/2016/02/16/2019030500058/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2016/02/16/2019030500058/" title="mongodb最新java驱动CRUD使用演示">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/6.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/NOSQL/">NOSQL</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2015/12/11/2019030500055/">
    		MongoDB基本操作以及JDBC连接
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2015-12-11T04:05:19.000Z">2015-12-11</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/MongoDB/" title="MongoDB">MongoDB</a> / 
    
        <a href="/tags/JDBC/" title="JDBC">JDBC</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <p><strong>MongoDB</strong> Mac上使用MongoDB的方法。 官网下载安装包，安装完毕后，如果是默认路径，就在根目录下<em>创建一个data文件夹</em>，存放数据库中的数据。 开启MongoDB服务：在terminal中，切换到bin目录下执行./mongod就开启了MongoDB服务 连接数据库：新创建一个terminal窗口，在bin目录下执行./mongo，这是默认链接到test 退出数据库：用control + c 或者“&gt;exit” 与数据库断开链接，这时服务器还是开启状态 关闭服务：首先切换到admin，然后执行db.shutdownServer()，这样就关闭了MongoDB服务 MongoDB是一种非关系型数据库，它的数据存储格式为Bson，和Json很相似，SQL语句是用于关系型数据库的，对于MongoDB数据库的操作更像是对象调用方法，这里简单列举几种重要操作： 1，创建数据库。在MongoDB中创建数据库和切换数据库时都用“use dbname”命令，例如use person；如果不存在名字为person的数据库，就创建一个名为person的数据库，如果已经存在就切换到这个数据库下。值得注意的是，当这个数据库不存在，我们执行use person后，这是person是个空的数据库，如果我们不向里面写数据，那么系统就会自动删除这个数据库，只有写了数据系统才会保存。 2，创建集合。创建集合的概念和创建一个数据库相似，例如当前是Person数据库，当我们想创建一个名为students的集合时，我们就采用db.students.insert({“name” : “XXX” });这时students集合就在Person数据库中建立了，集合里面保存了一条记录，里面包含一个字段是”name“。 3，查询操作 find。我们用db.students.find()可以查询students集合中所有的数据，如果用db.students.find({“name”: “xxx”})可以查找我们需要的特定数据。结果集中有一个字段是”_id“， 这个字段是数据库默认给我们加的GUID，目的就是保证数据的唯一性。 4，更新操作 update。db.students.update({“name” : “XXX”}, {“name”: “XX”}),当我们执行完成后，name将变为”XX“。 5，删除操作 remove。执行db.students.remove({“name” : “XX”})操作，就会在集合中删除名为”XX“的所有记录。 6，删除集合，db.students.drop() 7，删除数据库，首先进入要删除的数据库，然后执行db.dropDatabase()。 下面是用JDBC链接MongoDB数据库，并采用了Singleton的设计模式。</p>
<p>Java代码</p>
<ol>
<li>import com.mongodb.DB;</li>
<li><p>import com.mongodb.MongoClient;</p>
</li>
<li><p>public class Connection {</p>
</li>
<li>private String host = “localhost”;</li>
<li>private int port = 27017;</li>
<li><p>private String dbName = “mongo”;</p>
</li>
<li><p>private static Connection instance = null;</p>
</li>
<li><p>// singleton model</p>
</li>
<li>private Connection() {</li>
<li><p>}</p>
</li>
<li><p>public DB getConnection() {</p>
</li>
<li>DB db = null;</li>
<li>try {</li>
<li>MongoClient client = new MongoClient(host, port);</li>
<li>db = client.getDB(dbName);</li>
<li>} catch (UnknownHostException e) {</li>
<li>e.printStackTrace();</li>
<li>}</li>
<li>return db;</li>
<li><p>}</p>
</li>
<li><p>public static Connection getInstance() {</p>
</li>
<li>if (Connection.instance == null) {</li>
<li>Connection.instance = new Connection();</li>
<li>}</li>
<li>return Connection.instance;</li>
<li>}</li>
<li>}</li>
</ol>

            
            <p class="more">
                <a href="/2015/12/11/2019030500055/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2015/12/11/2019030500055/" title="MongoDB基本操作以及JDBC连接">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/1.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/NOSQL/">NOSQL</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2015/11/05/2019030500059/">
    		mongodb的安装和启动
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2015-11-05T11:57:53.000Z">2015-11-05</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/MongoDB/" title="MongoDB">MongoDB</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <p>1、安装 安装非常简单，在管网上下载mongodb-win32-x86_64-2008plus-2.6.3.zip安装包； 创建数据库文件存放目录； 2、启动 进入dos窗口，cd到安装bin目录下，然后操作命令启动mongodb服务：mongod –dbpath 你创建的数据库文件存放目录 mongodb默认连接端口27017，如果可以打开<a href="http://localhost:27017" target="_blank" rel="noopener">http://localhost:27017</a> 则表示启动成功 页面显示：It looks like you are trying to access MongoDB over HTTP on the native driver port. 3、设置自动启动 用记事本打开mongo.config输入： dbpath=你创建的数据库文件存放目录 logpath=你创建的数据库文件存放目录\log\mongo.log 用管理员身份打开cmd命令行，进入你创建的数据库文件存放目录，输入如下的命令： mongod –config 你创建的数据库文件存放目录\mongo.config</p>

            
            <p class="more">
                <a href="/2015/11/05/2019030500059/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2015/11/05/2019030500059/" title="mongodb的安装和启动">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/5.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/NOSQL/">NOSQL</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2015/10/28/2019030500052/">
    		Linux下快速安装MongoDB
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2015-10-28T04:54:47.000Z">2015-10-28</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/MongoDB/" title="MongoDB">MongoDB</a> / 
    
        <a href="/tags/Database/" title="Database">Database</a> / 
    
        <a href="/tags/dba/" title="dba">dba</a> / 
    
        <a href="/tags/NoSQL/" title="NoSQL">NoSQL</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <p>Mongo DB 是目前在IT行业非常流行的一种非关系型数据库(NoSql),其灵活的数据存储方式备受当前IT从业人员的青睐。Mongo DB很好的实现了面向对象的思想(OO思想),在Mongo DB中 每一条记录都是一个Document对象。Mongo DB最大的优势在于所有的数据持久操作都无需开发人员手动编写SQL语句,直接调用方法就可以轻松的实现CRUD操作。本文介绍了如何快速安装mongodb供大家参考。 一、安装配置mongodb Step 1: 设置系统环境及确保缺省端口27107可用 ###当前环境 # cat /etc/issue Red Hat Enterprise Linux Server release 6.5 (Santiago) # vi /etc/selinux/config SELINUX=disabled Step 2: 下载安装文件 下载地址： <a href="https://www.mongodb.org/downloads" target="_blank" rel="noopener">https://www.mongodb.org/downloads</a>. 或者直接在命令提示符下使用curl命令下载 curl -O <a href="https://fastdl.mongodb.org/linux/mongodb-linux-x86\_64-3.0.6.tgz" target="_blank" rel="noopener">https://fastdl.mongodb.org/linux/mongodb-linux-x86\_64-3.0.6.tgz</a> Step 3: 解压下载的文件 # pwd /usr/local/src # tar -xvf mongodb-linux-x86_64-rhel62-3.0.6.gz  ###注，本文直接从网站下载，所以文件为.gz Step 4: 复制解压文件到运行目录 # mkdir -p /var/lib/mongodb # cp -R -n /usr/local/src/mongodb-linux-x86_64-rhel62-3.0.6/. /var/lib/mongodb/ Step 5: 设置环境变量 e.g. export PATH=<mongodb-install-directory>/bin:$PATH # vi ~/.bash_profile export PATH=/var/lib/mongodb/bin:$PATH # source ~/.bash_profile Step 6: 创建数据目录 # mkdir -p /data/mongodata 二、启动及验证mongodb ###启动mongo # mongod –dbpath /data/mongodata ###以下内容为启动后输出的相关信息 2015-10-28T10:03:33.100+0800 I JOURNAL  [initandlisten] journal dir=/data/mongodata/journal 2015-10-28T10:03:33.101+0800 I JOURNAL  [initandlisten] recover : no journal files present, no recovery needed 2015-10-28T10:03:33.264+0800 I JOURNAL  [initandlisten] preallocateIsFaster=true 2.18 2015-10-28T10:03:33.398+0800 I JOURNAL  [durability] Durability thread started 2015-10-28T10:03:33.398+0800 I JOURNAL  [journal writer] Journal writer thread started 2015-10-28T10:03:33.401+0800 I CONTROL  [initandlisten] MongoDB starting : pid=10191 port=27017 dbpath=/data/mongodata 64-bit host=java_2 2015-10-28T10:03:33.401+0800 I CONTROL  [initandlisten] <strong> WARNING: You are running this process as the root user, which is not recommended. 2015-10-28T10:03:33.401+0800 I CONTROL  [initandlisten] 2015-10-28T10:03:33.402+0800 I CONTROL  [initandlisten] 2015-10-28T10:03:33.402+0800 I CONTROL  [initandlisten] </strong> WARNING: /sys/kernel/mm/transparent_hugepage/enabled is ‘always’. 2015-10-28T10:03:33.402+0800 I CONTROL  [initandlisten] <strong>        We suggest setting it to ‘never’ 2015-10-28T10:03:33.402+0800 I CONTROL  [initandlisten] 2015-10-28T10:03:33.402+0800 I CONTROL  [initandlisten] </strong> WARNING: /sys/kernel/mm/transparent_hugepage/defrag is ‘always’. 2015-10-28T10:03:33.402+0800 I CONTROL  [initandlisten] <strong>        We suggest setting it to ‘never’ 2015-10-28T10:03:33.402+0800 I CONTROL  [initandlisten] 2015-10-28T10:03:33.402+0800 I CONTROL  [initandlisten] db version v3.0.6 2015-10-28T10:03:33.402+0800 I CONTROL  [initandlisten] git version: 1ef45a23a4c5e3480ac919b28afcba3c615488f2 2015-10-28T10:03:33.402+0800 I CONTROL  [initandlisten] build info: Linux ip-10-67-194-123 2.6.32-220.el6.x86_64 #1 SMP Wed Nov 9 08:03:13 EST 2011 x86_64 BOOST_LIB_VERSION=1_49 2015-10-28T10:03:33.402+0800 I CONTROL  [initandlisten] allocator: tcmalloc 2015-10-28T10:03:33.402+0800 I CONTROL  [initandlisten] options: { storage: { dbPath: “/data/mongodata” } } 2015-10-28T10:03:33.404+0800 I INDEX    [initandlisten] allocating new ns file /data/mongodata/local.ns, filling with zeroes… 2015-10-28T10:03:33.491+0800 I STORAGE  [FileAllocator] allocating new datafile /data/mongodata/local.0, filling with zeroes… 2015-10-28T10:03:33.491+0800 I STORAGE  [FileAllocator] creating directory /data/mongodata/_tmp 2015-10-28T10:03:33.497+0800 I STORAGE  [FileAllocator] done allocating datafile /data/mongodata/local.0, size: 64MB,  took 0.001 secs 2015-10-28T10:03:33.511+0800 I NETWORK  [initandlisten] waiting for connections on port 27017 ###停止mongo，直接使用ctrl + c ^C2015-10-28T10:09:21.510+0800 I CONTROL  [signalProcessingThread] got signal 2 (Interrupt), will terminate after current cmd ends 2015-10-28T10:09:21.511+0800 I CONTROL  [signalProcessingThread] now exiting 2015-10-28T10:09:21.511+0800 I NETWORK  [signalProcessingThread] shutdown: going to close listening sockets… 2015-10-28T10:09:21.511+0800 I NETWORK  [signalProcessingThread] closing listening socket: 5 2015-10-28T10:09:21.511+0800 I NETWORK  [signalProcessingThread] closing listening socket: 6 2015-10-28T10:09:21.511+0800 I NETWORK  [signalProcessingThread] removing socket file: /tmp/mongodb-27017.sock 2015-10-28T10:09:21.511+0800 I NETWORK  [signalProcessingThread] shutdown: going to flush diaglog… 2015-10-28T10:09:21.511+0800 I NETWORK  [signalProcessingThread] shutdown: going to close sockets… 2015-10-28T10:09:21.512+0800 I STORAGE  [signalProcessingThread] shutdown: waiting for fs preallocator… 2015-10-28T10:09:21.512+0800 I STORAGE  [signalProcessingThread] shutdown: final commit… 2015-10-28T10:09:21.512+0800 I JOURNAL  [signalProcessingThread] journalCleanup… 2015-10-28T10:09:21.512+0800 I JOURNAL  [signalProcessingThread] removeJournalFiles 2015-10-28T10:09:21.515+0800 I JOURNAL  [signalProcessingThread] Terminating durability thread … 2015-10-28T10:09:21.615+0800 I JOURNAL  [journal writer] Journal writer thread stopped 2015-10-28T10:09:21.615+0800 I JOURNAL  [durability] Durability thread stopped 2015-10-28T10:09:21.615+0800 I STORAGE  [signalProcessingThread] shutdown: closing all files… 2015-10-28T10:09:21.618+0800 I STORAGE  [signalProcessingThread] closeAllFiles() finished 2015-10-28T10:09:21.618+0800 I STORAGE  [signalProcessingThread] shutdown: removing fs lock… 2015-10-28T10:09:21.618+0800 I CONTROL  [signalProcessingThread] dbexit:  rc: 0 ###修复启动过程中的两个警告，关于使用root用户启动mongo的警告先忽略 # echo “never” &gt; /sys/kernel/mm/transparent_hugepage/enabled # echo “never” &gt; /sys/kernel/mm/transparent_hugepage/defrag ###再次重启，后置于后台进程， # mongod –dbpath /data/mongodata &amp; ###查看启动后的进程 # ps -ef|grep mongo |grep -v grep root     11115 27956  0 10:11 pts/2    00:00:00 mongod –dbpath /data/mongodata # lsof -i:27017 COMMAND   PID USER   FD   TYPE   DEVICE SIZE/OFF NODE NAME mongod  11115 root    5u  IPv4 50567119      0t0  TCP *:27017 (LISTEN) ###使用mongo连接到mongod # mongo MongoDB shell version: 3.0.6 connecting to: test 2015-10-28T10:14:30.685+0800 I NETWORK  [initandlisten] connection accepted from 127.0.0.1:53907 #1 (1 connection now open) Server has startup warnings: 2015-10-28T10:11:49.217+0800 I CONTROL  [initandlisten] </strong> WARNING: You are running this process as the root user, which is not recommended. 2015-10-28T10:11:49.217+0800 I CONTROL  [initandlisten] &gt; help db.help()                    help on db methods db.mycoll.help()             help on collection methods sh.help()                    sharding helpers rs.help()                    replica set helpers help admin                   administrative help help connect                 connecting to a db help help keys                    key shortcuts help misc                    misc things to know help mr                      mapreduce show dbs                     show database names show collections             show collections in current database show users                   show users in current database show profile                 show most recent system.profile entries with time &gt;= 1ms show logs                    show the accessible logger names show log [name]              prints out the last segment of log in memory, ‘global’ is default use &lt;db_name&gt;                set current database db.foo.find()                list objects in collection foo db.foo.find( { a : 1 } )     list objects in foo where a == 1 it                           result of the last line evaluated; use to further iterate DBQuery.shellBatchSize = x   set default number of items to display on shell exit                         quit the mongo shell &gt; db.getCollection(“version”); test.version &gt; exit bye 三、mongodb相关工具 ###在安装文件下有README，描述了常用的mongodb相关命令行工具 # more /usr/local/mongodb/README MongoDB README Welcome to MongoDB! COMPONENTS bin/mongod - The database process. bin/mongos - Sharding controller. bin/mongo  - The database shell (uses interactive javascript). UTILITIES bin/mongodump         - MongoDB dump tool - for backups, snapshots, etc.. bin/mongorestore      - MongoDB restore a dump bin/mongoexport       - Export a single collection to test (JSON, CSV) bin/mongoimport       - Import from JSON or CSV bin/mongofiles        - Utility for putting and getting files from MongoDB GridFS bin/mongostat         - Show performance statistics RUNNING For command line options invoke: $ ./mongod –help To run a single server database: $ mkdir /data/db $ ./mongod $ $ # The mongo javascript shell connects to localhost and test database by default: $ ./mongo &gt; help DRIVERS Client drivers for most programming languages are available at mongodb.org.  Use the shell (“mongo”) for administrative tasks. ###获取单个命令用法 # <command> –help # mongod –help|more Options: General options: -h [ –help ]               show this usage information –version                   show version information # mongod –version db version v3.0.6 git version: 1ef45a23a4c5e3480ac919b28afcba3c615488f2</mongodb-install-directory></p>

            
            <p class="more">
                <a href="/2015/10/28/2019030500052/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2015/10/28/2019030500052/" title="Linux下快速安装MongoDB">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/8.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/NOSQL/">NOSQL</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2015/10/28/2019030500154/">
    		Spring集成MongoDB
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2015-10-28T04:50:04.000Z">2015-10-28</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/MongoDB/" title="MongoDB">MongoDB</a> / 
    
        <a href="/tags/Spring/" title="Spring">Spring</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <h2 id="开篇"><a href="#开篇" class="headerlink" title="开篇"></a>开篇</h2><pre><code>Spring提供了对非关系数据库的集成，Spring的spring-data包提供了对mongoDB和redis集成的工具包。此篇博客介绍一下Spring和MongoDB的集成。
</code></pre><h2 id="导入工具包"><a href="#导入工具包" class="headerlink" title="导入工具包"></a>导入工具包</h2><pre><code>需要的工具包有spring的jar包、spring-common的jar包以及spring-data的mongoDB的jar包。
其中，
spring的jar包有aop、asm、aspects、beans、context、core、expression、jdbc、transaction等。
spring-common的jar包有commons-beanutils、commons-codec、commons-collections、commons-io、commons-lang、commons-logging、commons-pool等。
spring-data的mongoDB的jar包有spring-data-commons-aspects、spring-data-commons-core、spring-data-document-core、spring-data-mongodb、spring-data-mongodb-cross-store、spring-data-mongodb-log4j等。
另外还有一个是mongo.jar
</code></pre><h2 id="工具包截图"><a href="#工具包截图" class="headerlink" title="工具包截图"></a>工具包截图</h2><p><img src="http://img.blog.csdn.net/20151028115904114" alt="这里写图片描述"></p>
<h2 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h2><pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;  
          xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;  
          xmlns:context=&quot;http://www.springframework.org/schema/context&quot;  
          xmlns:mongo=&quot;http://www.springframework.org/schema/data/mongo&quot;  
          xsi:schemaLocation=&quot;http://www.springframework.org/schema/context   
          http://www.springframework.org/schema/context/spring-context-3.0.xsd   
          http://www.springframework.org/schema/data/mongo   
          http://www.springframework.org/schema/data/mongo/spring-mongo-1.0.xsd   
          http://www.springframework.org/schema/beans   
          http://www.springframework.org/schema/beans/spring-beans-3.0.xsd&quot;&gt;   

        &lt;mongo:mongo host=&quot;192.168.0.138&quot; port=&quot;27017&quot;/&gt;



       &lt;bean id=&quot;mongoTemplate&quot; class=&quot;org.springframework.data.document.mongodb.MongoTemplate&quot;&gt;   
        &lt;constructor-arg ref=&quot;mongo&quot;/&gt;   
        &lt;constructor-arg name=&quot;databaseName&quot; value=&quot;db&quot;/&gt;   
        &lt;constructor-arg name=&quot;defaultCollectionName&quot; value=&quot;person&quot; /&gt;   
      &lt;/bean&gt;   

     &lt;bean id=&quot;personRepository&quot; class=&quot;com.mongo.dao.impl.PersonRepository&quot;&gt;   
        &lt;property name=&quot;mongoTemplate&quot; ref=&quot;mongoTemplate&quot;&gt;&lt;/property&gt;   
    &lt;/bean&gt;   

     &lt;context:annotation-config /&gt;

&lt;/beans&gt; 
</code></pre><h2 id="代码编写"><a href="#代码编写" class="headerlink" title="代码编写"></a>代码编写</h2><p>实体类：</p>
<pre><code>public class Person implements Serializable {

    /**
     * 
     */
    private static final long serialVersionUID = 3617931430808763429L;

    private String id;   
    private String name;   
    private int age;
    public Person() {
        super();
    }
    public Person(String id, String name, int age) {
        super();
        this.id = id;
        this.name = name;
        this.age = age;
    }
    /**
     * @return the id
     */
    public String getId() {
        return id;
    }
    /**
     * @param id the id to set
     */
    public void setId(String id) {
        this.id = id;
    }
    /**
     * @return the name
     */
    public String getName() {
        return name;
    }
    /**
     * @param name the name to set
     */
    public void setName(String name) {
        this.name = name;
    }
    /**
     * @return the age
     */
    public int getAge() {
        return age;
    }
    /**
     * @param age the age to set
     */
    public void setAge(int age) {
        this.age = age;
    }
    /**
     * 
     * @param name
     * @param age
     */
    public Person(String name, int age) {
        super();
        this.name = name;
        this.age = age;
    }   

     public String toString() {   
            return &quot;Person[id=&quot;+id+&quot;,name=&quot;+name+&quot;,age=&quot;+age+&quot;]&quot;;   
        }   


}
</code></pre><p>DAO层接口</p>
<pre><code>public interface AbstractRepository {


    public void insert(Person person); 


    public Person findOne(String id);   

    public List&lt;Person&gt; findAll();   

    public List&lt;Person&gt; findByRegex(String regex);

    public void removeOne(String id);   

    public void removeAll();   

    public void findAndModify(String id);   


}
</code></pre><p>DAO层接口实现</p>
<pre><code>public class PersonRepository implements AbstractRepository {

      private MongoTemplate mongoTemplate;   


    @Override
    public List&lt;Person&gt; findAll() {
        return getMongoTemplate().find(new Query(), Person.class);   

    }


    @Override
    public void findAndModify(String id) {

        getMongoTemplate().updateFirst(new Query(Criteria.where(&quot;id&quot;).is(id)), new Update().inc(&quot;age&quot;, 3));

    }


    @Override
    public List&lt;Person&gt; findByRegex(String regex) {
         Pattern pattern = Pattern.compile(regex,Pattern.CASE_INSENSITIVE);   
          Criteria criteria = new Criteria(&quot;name&quot;).regex(pattern.toString());   
            return getMongoTemplate().find(new Query(criteria), Person.class);   

    }


    @Override
    public Person findOne(String id) {
         return getMongoTemplate().findOne(new Query(Criteria.where(&quot;id&quot;).is(id)), Person.class);   

    }


    @Override
    public void insert(Person person) {
        getMongoTemplate().insert(person);   
    }


    @Override
    public void removeAll() {
        List&lt;Person&gt; list = this.findAll();   
        if(list != null){   
            for(Person person : list){   
                getMongoTemplate().remove(person);   
            }   
        }   

    }


    @Override
    public void removeOne(String id) {
        Criteria criteria = Criteria.where(&quot;id&quot;).in(id);   
        if(criteria == null){   
             Query query = new Query(criteria);   
             if(query != null &amp;&amp; getMongoTemplate().findOne(query, Person.class) != null)   
                 getMongoTemplate().remove(getMongoTemplate().findOne(query, Person.class));   
        }   

    }

    /**
     * @return the mongoTemplate
     */
    public MongoTemplate getMongoTemplate() {
        return mongoTemplate;
    }

    /**
     * @param mongoTemplate the mongoTemplate to set
     */
    public void setMongoTemplate(MongoTemplate mongoTemplate) {
        this.mongoTemplate = mongoTemplate;
    }

}
测试程序
public class MongoTest {

    private static Log log = LogFactory.getLog(MongoTest.class.getName());

    private  AbstractRepository pr=null;


    public void init(){

         ApplicationContext ctx = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;);
          pr= (PersonRepository)ctx.getBean(&quot;personRepository&quot;);



    }

    public void insert(){

        Person p=new Person(&quot;cuiran&quot;,27);
         pr.insert(p);
    }

    public void findOne(){
        String id=&quot;50c83cb552c2ceb0463177d6&quot;;
        Person p= pr.findOne(id);
        log.debug(p);
    }



    public void listAll(){

        List&lt;Person&gt; list=pr.findAll();

        for (Person p:list){
            log.debug(p.toString());
        }


    }


    public void start(){
        init();

        //insert();
        //listAll();

        findOne();
    }

    public static void main(String[] args) {
        MongoTest t=new MongoTest();
        t.start();
    }

}
</code></pre><h2 id="结束"><a href="#结束" class="headerlink" title="结束"></a>结束</h2><pre><code>通过Spring集成MongoDB的底层代码封装，项目中用到非关系型数据MongoDB存储就变得容易很多。
</code></pre>
            
            <p class="more">
                <a href="/2015/10/28/2019030500154/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2015/10/28/2019030500154/" title="Spring集成MongoDB">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/8.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/NOSQL/">NOSQL</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2015/09/06/2019030500056/">
    		mongodb常用命令
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2015-09-06T09:26:01.000Z">2015-09-06</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/MongoDB/" title="MongoDB">MongoDB</a> / 
    
        <a href="/tags/ubuntu/" title="ubuntu">ubuntu</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <p>mongodb由C＋＋写就，其名字来自hu<strong>mongo</strong>us这个单词的中间部分，从名字可见其野心所在就是海量数据的处理。关于它的一个最简洁描述为：scalable, high-performance, open source,  schema-free, document-oriented database。MongoDB的主要目标是在键/值存储方式（提供了高性能和高度伸缩性）以及传统的RDBMS系统（丰富的功能）架起一座桥梁，集两者的优势于一身。   <strong>安装及使用：</strong> 首先在Ubuntu上安装MongoDB。 <a href="http://www.mongodb.org/display/DOCS/Downloads" target="_blank" rel="noopener">下载MongoDB</a>, 现在最新的生产版本1.7.0</p>
<ol>
<li>解压文件.</li>
</ol>
<p>$ tar  -xvf mongodb-linux-i686-1.4.3.tgz</p>
<ol start="2">
<li>为MongoDB创建数据目录，默认情况下它将数据存储在/data/db</li>
</ol>
<p>$ sudo mkdir -p  /data/db/</p>
<p>$  sudo chown `id -u` /data/db</p>
<ol start="3">
<li>启动MongoDB服务.</li>
</ol>
<p>$ cd  mongodb-linux-i686-1.4.3/bin</p>
<p>$  ./mongod</p>
<ol start="4">
<li>打开另一个终端，并确保你在MongoDB的bin目录，输入如下命令.</li>
</ol>
<p>$  ./mongo</p>
<h3 id="一些概念"><a href="#一些概念" class="headerlink" title="一些概念"></a><strong>一些概念</strong></h3><p>一个mongod服务可以有建立多个数据库，每个数据库可以有多张表，这里的表名叫collection，每个collection可以存放多个文档（document），每个文档都以BSON（binary  json）的形式存放于硬盘中，因此可以存储比较复杂的数据类型。它是以单文档为单位存储的，你可以任意给一个或一批文档新增或删除字段，而不会对其它文档造成影响，这就是所谓的schema-free，这也是文档型数据库最主要的优点。跟一般的key-value数据库不一样的是，它的value中存储了结构信息，所以你又可以像关系型数据库那样对某些域进行读写、统计等操作。Mongo最大的特点是他支持的查询语言非常强大，其语法有点类似于面向对象的查询语言，几乎可以实现类似关系数据库单表查询的绝大部分功能，而且还支持对数据建立索引。Mongo还可以解决海量数据的查询效率，根据官方文档，当数据量达到50GB以上数据时，Mongo数据库访问速度是MySQL10  倍以上。</p>
<p><strong>BSON</strong> BSON是Binary JSON  的简称，是一个JSON文档对象的二进制编码格式。BSON同JSON一样支持往其它文档对象和数组中再插入文档对象和数组，同时扩展了JSON的数据类型。如：BSON有Date类型和BinDate类型。 BSON被比作二进制的交换格式，如同Protocol  Buffers，但BSON比它更“schema-less”，非常好的灵活性但空间占用稍微大一点。 BSON有以下三个特点： 1．   轻量级 2．   跨平台 3．   效率高 <strong>命名空间</strong> MongoDB存储BSON对象到collections,这一系列的数据库名和collection名被称为一个命名空间。如同：java.util.List;用来管理数据库中的数据。</p>
<h3 id="索引"><a href="#索引" class="headerlink" title="索引"></a><strong>索引</strong></h3><p>mongodb可以对某个字段建立索引，可以建立组合索引、唯一索引，也可以删除索引，建立索引就意味着增加空间开销。默认情况下每个表都会有一个唯一索引：_id，如果插入数据时没有指定_id，服务会自动生成一个_id，为了充分利用已有索引，减少空间开销，最好是自己指定一个unique的key为_id，通常用对象的ID比较合适，比如商品的ID。 <strong>shell操作数据库：</strong>   1.   超级用户相关： 1. #进入数据库admin use admin 2. #增加或修改用户密码 db.addUser(‘name’,’pwd’) 3. #查看用户列表 db.system.users.find() 4. #用户认证 db.auth(‘name’,’pwd’) 5. #删除用户 db.removeUser(‘name’) 6.  #查看所有用户 show users 7. #查看所有数据库 show dbs 8. #查看所有的collection show collections 9. #查看各collection的状态 db.printCollectionStats() 10. #查看主从复制状态 db.printReplicationInfo() 11. #修复数据库 db.repairDatabase() 12. #设置记录profiling，0=off 1=slow 2=all db.setProfilingLevel(1) 13. #查看profiling show profile 14. #拷贝数据库 db.copyDatabase(‘mail_addr’,’mail_addr_tmp’) 15. #删除collection db.mail_addr.drop() 16. #删除当前的数据库 db.dropDatabase()   2. 增删改 1.  #存储嵌套的对象 db.foo.save({‘name’:’ysz’,’address’:{‘city’:’beijing’,’post’:100096},’phone’:[138,139]})   2. #存储数组对象 db.user_addr.save({‘Uid’:<a href="mailto:&#39;yushunzhi@sohu.com">&#39;yushunzhi@sohu.com</a>‘,’Al’:[<a href="mailto:&#39;test-1@sohu.com">&#39;test-1@sohu.com</a>‘,<a href="mailto:&#39;test-2@sohu.com">&#39;test-2@sohu.com</a>‘]})   3. #根据query条件修改，如果不存在则插入，允许修改多条记录 db.foo.update({‘yy’:5},{‘$set’:{‘xx’:2}},upsert=true,multi=true) 4. #删除yy=5的记录 db.foo.remove({‘yy’:5}) 5. #删除所有的记录 db.foo.remove()   3. 索引 1. #增加索引：1(ascending),-1(descending) 2. db.foo.ensureIndex({firstname: 1, lastname:  1}, {unique: true}); 3. #索引子对象 4. db.user_addr.ensureIndex({‘Al.Em’:  1}) 5. #查看索引信息 6. db.foo.getIndexes() 7. db.foo.getIndexKeys() 8. #根据索引名删除索引 9. db.user_addr.dropIndex(‘Al.Em_1’)   4. 查询 1. #查找所有 2. db.foo.find() 3. #查找一条记录 4. db.foo.findOne() 5. #根据条件检索10条记录 6. db.foo.find({‘msg’:’Hello 1’}).limit(10) 7. #sort排序 8.  db.deliver_status.find({‘From’:<a href="mailto:&#39;ixigua@sina.com">&#39;ixigua@sina.com</a>‘}).sort({‘Dt’,-1}) 9.  db.deliver_status.find().sort({‘Ct’:-1}).limit(1) 10. #count操作 11. db.user_addr.count() 12. #distinct操作,查询指定列，去重复 13. db.foo.distinct(‘msg’) 14. #”&gt;=”操作 15. db.foo.find({“timestamp”: {“$gte” : 2}}) 16. #子对象的查找 17. db.foo.find({‘address.city’:’beijing’}) 5. 管理 1. #查看collection数据的大小 2. db.deliver_status.dataSize() 3. #查看colleciont状态 4. db.deliver_status.stats() 5. #查询所有索引的大小 6.  db.deliver_status.totalIndexSize()   5.  advanced queries:高级查询 条件操作符 $gt  : &gt; $lt : &lt; $gte: &gt;= $lte: &lt;= $ne :  !=、&lt;&gt; $in  : in $nin: not in $all: all $not: 反匹配(1.3.3及以上版本) 查询 name &lt;&gt; “bruce” and age &gt;= 18 的数据 db.users.find({name:  {$ne: “bruce”}, age: {$gte: 18}}); 查询 creation_date &gt; ‘2010-01-01’ and creation_date &lt;= ‘2010-12-31’  的数据 db.users.find({creation_date:{$gt:new  Date(2010,0,1), $lte:new Date(2010,11,31)}); 查询 age in (20,22,24,26) 的数据 db.users.find({age:  {$in: [20,22,24,26]}}); 查询 age取模10等于0  的数据 db.users.find(‘this.age  % 10 == 0’); 或者 db.users.find({age  : {$mod : [10, 0]}}); 匹配所有 db.users.find({favorite_number  : {$all : [6, 8]}}); 可以查询出{name:  ‘David’, age: 26, favorite_number: [ 6, 8, 9 ]  } 可以不查询出{name:  ‘David’, age: 26, favorite_number: [ 6, 7, 9 ]  } 查询不匹配name=B<em>带头的记录 db.users.find({name:  {$not: /^B.</em>/}}); 查询 age取模10不等于0  的数据 db.users.find({age  : {$not: {$mod : [10, 0]}}}); #返回部分字段 选择返回age和_id字段(_id字段总是会被返回) db.users.find({},  {age:1}); db.users.find({}, {age:3}); db.users.find({},  {age:true}); db.users.find({ name : “bruce” },  {age:1}); 0为false,  非0为true 选择返回age、address和_id字段 db.users.find({  name : “bruce” }, {age:1, address:1}); 排除返回age、address和_id字段 db.users.find({},  {age:0, address:false}); db.users.find({ name : “bruce” }, {age:0,  address:false}); 数组元素个数判断 对于{name:  ‘David’, age: 26, favorite_number: [ 6, 7, 9 ] }记录 匹配db.users.find({favorite_number:  {$size: 3}}); 不匹配db.users.find({favorite_number:  {$size: 2}}); $exists判断字段是否存在 查询所有存在name字段的记录 db.users.find({name:  {$exists: true}}); 查询所有不存在phone字段的记录 db.users.find({phone:  {$exists: false}}); $type判断字段类型 查询所有name字段是字符类型的 db.users.find({name:  {$type: 2}}); 查询所有age字段是整型的 db.users.find({age:  {$type: 16}}); 对于字符字段，可以使用正则表达式 查询以字母b或者B带头的所有记录 db.users.find({name:  /^b.<em>/i}); $elemMatch(1.3.1及以上版本) 为数组的字段中匹配其中某个元素 Javascript查询和$where查询 查询 age &gt; 18 的记录，以下查询都一样 db.users.find({age:  {$gt: 18}}); db.users.find({$where: “this.age &gt;  18”}); db.users.find(“this.age &gt; 18”); f = function() {return  this.age &gt; 18} db.users.find(f); 排序sort() 以年龄升序asc db.users.find().sort({age:  1}); 以年龄降序desc db.users.find().sort({age:  -1}); 限制返回记录数量limit() 返回5条记录 db.users.find().limit(5); 返回3条记录并打印信息 db.users.find().limit(3).forEach(function(user)  {print(‘my age is ‘ + user.age)}); 结果 my  age is 18 my age is 19 my age is  20 限制返回记录的开始点skip() 从第3条记录开始，返回5条记录(limit  3,  5) db.users.find().skip(3).limit(5); 查询记录条数count() db.users.find().count(); db.users.find({age:18}).count(); 以下返回的不是5，而是user表中所有的记录数量 db.users.find().skip(10).limit(5).count(); 如果要返回限制之后的记录数量，要使用count(true)或者count(非0) db.users.find().skip(10).limit(5).count(true); 分组group() 假设test表只有以下一条数据 {  domain: “<a href="http://www.mongodb.org&quot;" target="_blank" rel="noopener">www.mongodb.org&quot;</a> , invoked_at: {d:”2009-11-03”, t:”17:14:05”} ,  response_time: 0.05 , http_action: “GET  /display/DOCS/Aggregation” } 使用group统计test表11月份的数据count:count(</em>)、total_time:sum(response_time)、avg_time:total_time/count; db.test.group( {  cond: {“invoked_at.d”: {$gt: “2009-11”, $lt: “2009-12”}} , key:  {http_action: true} , initial: {count: 0, total_time:0} , reduce:  function(doc, out){ out.count++; out.total_time+=doc.response_time } ,  finalize: function(out){ out.avg_time = out.total_time / out.count } }  ); [ { “http_action” : “GET  /display/DOCS/Aggregation”, “count” : 1, “total_time” :  0.05, “avg_time” : 0.05 } ] </p>
<p><strong>Java  应用示例</strong></p>
<p>要使用Java操作MongoDB的话，要到官方网站下载一个驱动包，把包导入后，可以尝试来操作了（记得一定要开着服务器）</p>
<p>首先介绍一下比较常用的几个类</p>
<p><strong>Mongo</strong>：连接服务器，执行一些数据库操作的选项，如新建立一个数据库等</p>
<p><strong>DB</strong>：对应一个数据库，可以用来建立集合等操作</p>
<p><strong>DBCollection</strong>：对应一个集合（类似表），可能是我们用得最多的，可以添加删除记录等</p>
<p><strong>DBObjec</strong>：接口和BasicDBObject对象：表示一个具体的记录，BasicDBObject实现了DBObject，因为是key-value的数据结构，所以用起来其实和HashMap是基本一致的</p>
<p><strong>DBCursor</strong>：用来遍历取得的数据，实现了Iterable和Iterator</p>
<p>接下来实际的操作一下，代码如下：</p>
<ol>
<li><p>import java.net.UnknownHostException;</p>
</li>
<li><p>import java.util.List;</p>
</li>
<li><p>import java.util.Set;</p>
</li>
<li><p>import com.mongodb.BasicDBObject;</p>
</li>
<li><p>import com.mongodb.DB;</p>
</li>
<li><p>import com.mongodb.DBCollection;</p>
</li>
<li><p>import com.mongodb.DBCursor;</p>
</li>
<li><p>import com.mongodb.DBObject;</p>
</li>
<li><p>import com.mongodb.Mongo;</p>
</li>
<li><p>import com.mongodb.MongoException;</p>
</li>
<li><p>public class MongoDbTest {</p>
</li>
<li><p>public static void main(String[] args)  throws UnknownHostException, MongoException {</p>
</li>
<li><p>//Mongo m = new  Mongo(); </p>
</li>
<li><p>//Mongo m = new Mongo(“localhost”); </p>
</li>
<li><p>//获得数据库服务</p>
</li>
<li><p>Mongo m = new Mongo(“localhost”, 27017);</p>
</li>
<li><p>//得到数据库mytest</p>
</li>
<li><p>DB db = m.getDB(“mytest”);</p>
</li>
<li><p>//得到mytest数据库下所有表名</p>
</li>
<li><p>Set<string> colls =  db.getCollectionNames();</string></p>
</li>
<li><p>for (String s : colls) {</p>
</li>
<li><p>System.out.println(s);</p>
</li>
<li><p>}</p>
</li>
<li><p>//得到testCollection表</p>
</li>
<li><p>DBCollection coll = db.getCollection(“testCollection”);</p>
</li>
<li><p>//new 一个BasicDBObject对象doc</p>
</li>
<li><p>BasicDBObject doc = new BasicDBObject();</p>
</li>
<li><p>//赋值</p>
</li>
<li><p>doc.put(“name”, “MongoDB”);</p>
</li>
<li><p>doc.put(“type”, “database”);</p>
</li>
<li><p>doc.put(“count”, 1);</p>
</li>
<li><p>//又new  一个BasicDBObject对象info</p>
</li>
<li><p>BasicDBObject info = new BasicDBObject();</p>
</li>
<li><p>info.put(“x”, 203);</p>
</li>
<li><p>info.put(“y”, 102);</p>
</li>
<li><p>//把info放入doc</p>
</li>
<li><p>doc.put(“info”, info);</p>
</li>
<li><p>//向testCollection表中插入一条数据</p>
</li>
<li><p>coll.insert(doc);</p>
</li>
<li><p>//查询一条数据</p>
</li>
<li><p>DBObject myDoc = coll.findOne();</p>
</li>
<li><p>System.out.println(myDoc);</p>
</li>
<li><p>//循环插入100条数据到testCollection</p>
</li>
<li><p>for (int i=0; i &lt; 100; i++)  {</p>
</li>
<li><p>coll.insert(new BasicDBObject().append(“i”,  i));</p>
</li>
<li><p>}</p>
</li>
<li><p>//Counting Documents in  A Collection </p>
</li>
<li><p>System.out.println(coll.getCount());</p>
</li>
<li><p>//Using a Cursor to Get  All the Documents </p>
</li>
<li><p>DBCursor cur = coll.find();</p>
</li>
<li><p>while(cur.hasNext()) {</p>
</li>
<li>}</li>
</ol>

            
            <p class="more">
                <a href="/2015/09/06/2019030500056/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2015/09/06/2019030500056/" title="mongodb常用命令">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/6.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/NOSQL/">NOSQL</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2015/06/10/2019030500057/">
    		MongoDB常用命令
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2015-06-10T04:33:16.000Z">2015-06-10</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/MongoDB/" title="MongoDB">MongoDB</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <blockquote>
<p>首先我们先安装这个数据库，你可以使用windows或者linux，但推荐使用的是linux，我使用的是ubuntu12.04.在下方的网址中共可以下载，基本都是64位的系统。如果位linux系统也可以使用命令行安装，我就是使用sudo apt-get install mongodb。</p>
<p><strong>[cpp]</strong></p>
<ol>
<li><span style="font-size:14px;"><a href="https://www.mongodb.org/downloads" target="_blank" rel="noopener">https://www.mongodb.org/downloads</a></span></li>
</ol>
<p>MongoDB 由 databases 组成,databases 由 collections 组成,collections 由documents(相当于行)组成,而 documents 有 fields(相当于列)组成。 help 最开始应该介绍的就是help函数，学习一个东西最好的文档就是官方文档，下面我会给出几个指令的执行过程。最基本的形式就是db.help()，也可以在中间加上数据库的名称如db.douban.help()。</p>
<p><strong>[cpp]</strong></p>
<ol>
<li><blockquote>
<p>db.help()</p>
</blockquote>
</li>
<li>DB methods:</li>
<li>db.addUser(username, password[, readOnly=false])</li>
<li>db.auth(username, password)</li>
<li>db.cloneDatabase(fromhost)</li>
<li>db.commandHelp(name) returns the help for the command</li>
<li>db.copyDatabase(fromdb, todb, fromhost)</li>
<li>db.createCollection(name, { size : …, capped : …, max : … } )</li>
<li>db.currentOp() displays the current operation in the db</li>
<li>db.dropDatabase()</li>
<li>db.eval(func, args) run code server-side</li>
<li>db.getCollection(cname) same as db[‘cname’] or db.cname</li>
<li>db.getCollectionNames()</li>
<li>db.getLastError() - just returns the err msg string</li>
<li>db.getLastErrorObj() - return full status object</li>
<li>db.getMongo() get the server connection object</li>
<li>db.getMongo().setSlaveOk() allow this connection to read from the nonmaster member of a replica pair</li>
<li>db.getName()</li>
<li>db.getPrevError()</li>
<li>db.getProfilingLevel() - deprecated</li>
<li>db.getProfilingStatus() - returns if profiling is on and slow threshold</li>
<li>db.getReplicationInfo()</li>
<li>db.getSiblingDB(name) get the db at the same server as this one</li>
<li>db.isMaster() check replica primary status</li>
<li>db.killOp(opid) kills the current operation in the db</li>
<li>db.listCommands() lists all the db commands</li>
<li>db.logout()</li>
<li>db.printCollectionStats()</li>
<li>db.printReplicationInfo()</li>
<li>db.printSlaveReplicationInfo()</li>
<li>db.printShardingStatus()</li>
<li>db.removeUser(username)</li>
<li>db.repairDatabase()</li>
<li>db.resetError()</li>
<li>db.runCommand(cmdObj) run a database command.  if cmdObj is a string, turns it into { cmdObj : 1 }</li>
<li>db.serverStatus()</li>
<li>db.setProfilingLevel(level,<slowms>) 0=off 1=slow 2=all</slowms></li>
<li>db.shutdownServer()</li>
<li>db.stats()</li>
<li>db.version() current version of the server</li>
<li>db.getMongo().setSlaveOk() allow queries on a replication slave server</li>
<li>db.fsyncLock() flush data to disk and lock server for backups</li>
<li>db.fsyncUnock() unlocks server following a db.fsyncLock()</li>
</ol>
<p><strong>[cpp]</strong></p>
<ol>
<li><blockquote>
<p>db.douban.help()</p>
</blockquote>
</li>
<li>DBCollection help</li>
<li>db.douban.find().help() - show DBCursor help</li>
<li>db.douban.count()</li>
<li>db.douban.dataSize()</li>
<li>db.douban.distinct( key ) - eg. db.douban.distinct( ‘x’ )</li>
<li>db.douban.drop() drop the collection</li>
<li>db.douban.dropIndex(name)</li>
<li>db.douban.dropIndexes()</li>
<li>db.douban.ensureIndex(keypattern[,options]) - options is an object with these possible fields: name, unique, dropDups</li>
<li>db.douban.reIndex()</li>
<li>db.douban.find([query],[fields]) - query is an optional query filter. fields is optional set of fields to return.</li>
<li>e.g. db.douban.find( {x:77} , {name:1, x:1} )</li>
<li>db.douban.find(…).count()</li>
<li>db.douban.find(…).limit(n)</li>
<li>db.douban.find(…).skip(n)</li>
<li>db.douban.find(…).sort(…)</li>
<li>db.douban.findOne([query])</li>
<li>db.douban.findAndModify( { update : … , remove : bool [, query: {}, sort: {}, ‘new’: false] } )</li>
<li>db.douban.getDB() get DB object associated with collection</li>
<li>db.douban.getIndexes()</li>
<li>db.douban.group( { key : …, initial: …, reduce : …[, cond: …] } )</li>
<li>db.douban.mapReduce( mapFunction , reduceFunction , <optional params> )</optional></li>
<li>db.douban.remove(query)</li>
<li>db.douban.renameCollection( newName , <droptarget> ) renames the collection.</droptarget></li>
<li>db.douban.runCommand( name , <options> ) runs a db command with the given name where the first param is the collection name</options></li>
<li>db.douban.save(obj)</li>
<li>db.douban.stats()</li>
<li>db.douban.storageSize() - includes free space allocated to this collection</li>
<li>db.douban.totalIndexSize() - size in bytes of all the indexes</li>
<li>db.douban.totalSize() - storage allocated for all data and indexes</li>
<li>db.douban.update(query, object[, upsert_bool, multi_bool])</li>
<li>db.douban.validate( <full> ) - SLOW</full></li>
<li>db.douban.getShardVersion() - only for use with sharding</li>
<li>db.douban.getShardDistribution() - prints statistics about data distribution in the cluster</li>
</ol>
<p>use use deng可以用来创建 deng,不用担心 deng 不会创建,当创建第一个 collection 时,deng会自动创建。 insert         db.unicorns.insert({name: ‘demo’, sex: ‘m’, weight: 70})，插入一个数据 collection 为 unicorns，使 用 db.getCollectionNames() , 会 得 到 unicorns 和 system.indexes 。system.indexes 对每个 DB 都会有,用于记录 index。可以通过find函数查看是否插入成功。 find  db.unicorns.find()会看到 document。就相当于mysql中的select * from table; 查看集合中的所有内容。</p>
<p><strong>[cpp]</strong></p>
<ol>
<li><span style="font-size:14px;">使用查询</span></li>
<li><p><span style="font-size:14px;">db.unicorns.find({name: ‘Dunx’})</span></p>
</li>
<li><p>其他说明:</p>
</li>
<li>$lt, $lte, $gt, $gte and $ne 分别表示小于、小于等于、大于、大于等于、不等于</li>
<li><p>db.unicorns.find({gender: {$ne: ‘f’}, weight: {$gte: 701}})</p>
</li>
<li><p>$exists 用于表示 field 是否存在</p>
</li>
<li><p>db.unicorns.find({vampires: {$exists: false}})</p>
</li>
<li><p>or 和 and</p>
</li>
<li>db.unicorns.find({gender: ‘f’, $or: [{loves: ‘apple’}, {loves: ‘orange’}, {weight: {$lt: 500}}]})</li>
</ol>
<p>db.unicorns.find(null, {name: 1}) 只返回 name 这个 field,具体如下所示:</p>
<p><strong>[cpp]</strong></p>
<ol>
<li><blockquote>
<p>db.unicorns.find(null, {name: 1})</p>
</blockquote>
</li>
<li>{ “_id” : ObjectId(“4da6f22da8d5cd3b72081cf7”), “name” : “Aurora” }</li>
<li>{ “_id” : ObjectId(“4da6f22da8d5cd3b72081cf6”), “name” : “Horny” }</li>
<li>{ “_id” : ObjectId(“4da6f22da8d5cd3b72081cf8”), “name” : “Unicrom” }</li>
<li>{ “_id” : ObjectId(“4da6f22da8d5cd3b72081cf9”), “name” : “Roooooodles” }</li>
<li>{ “_id” : ObjectId(“4da6f22da8d5cd3b72081cfa”), “name” : “Solnara” }</li>
<li>{ “_id” : ObjectId(“4da6f22da8d5cd3b72081cfb”), “name” : “Ayna” }</li>
<li>{ “_id” : ObjectId(“4da6f22da8d5cd3b72081cfc”), “name” : “Kenny” }</li>
<li>{ “_id” : ObjectId(“4da6f22da8d5cd3b72081cfd”), “name” : “Raleigh” }</li>
<li>{ “_id” : ObjectId(“4da6f22da8d5cd3b72081cfe”), “name” : “Leia” }</li>
<li>{ “_id” : ObjectId(“4da6f22da8d5cd3b72081cff”), “name” : “Pilot” }</li>
<li>{ “_id” : ObjectId(“4da6f22da8d5cd3b72081d00”), “name” : “Nimue” }</li>
<li>{ “_id” : ObjectId(“4da6f231a8d5cd3b72081d01”), “name” : “Dunx” }</li>
<li><blockquote>
<p>db.unicorns.find(null, {name: 1,_id:0})</p>
</blockquote>
</li>
<li>{ “name” : “Aurora” }</li>
<li>{ “name” : “Horny” }</li>
<li>{ “name” : “Unicrom” }</li>
<li>{ “name” : “Roooooodles” }</li>
<li>{ “name” : “Solnara” }</li>
<li>{ “name” : “Ayna” }</li>
<li>{ “name” : “Kenny” }</li>
<li>{ “name” : “Raleigh” }</li>
<li>{ “name” : “Leia” }</li>
<li>{ “name” : “Pilot” }</li>
<li>{ “name” : “Nimue” }</li>
<li>{ “name” : “Dunx” }</li>
</ol>
<p>sort</p>
<p><strong>[cpp]</strong></p>
<ol>
<li>db.unicorns.find().sort({weight: -1})</li>
<li>db.unicorns.find().sort({name: 1, vampires: -1})</li>
<li><p>#1 表示升序,-1 表示降序</p>
</li>
<li><p><pre name="code" class="cpp">db.unicorns.find().sort({weight: -1}).limit(2).skip(1)</pre></p>
</li>
<li>#得到第二个和第三个，limit 规定查询个数,skip 规定忽略几个。</li>
</ol>
<p>count</p>
<p><strong>[cpp]</strong></p>
<ol>
<li>db.unicorns.count({vampires: {$gt: 50}})</li>
<li>#or</li>
<li>db.unicorns.find({vampires: {$gt: 50}}).count()</li>
</ol>
<p>remove</p>
<p><strong>[cpp]</strong></p>
<ol>
<li>db.unicorns.remove()</li>
<li>如下面所示。</li>
<li><blockquote>
<p>db.unicorns.remove()</p>
</blockquote>
</li>
<li><blockquote>
<p>db.unicorns.find()</p>
</blockquote>
</li>
<li><blockquote>
</blockquote>
</li>
</ol>
<p>update</p>
<p><strong>[cpp]</strong></p>
<ol>
<li><span style="font-size:14px;">db.unicorns.update({name: ‘jingdong’}, {weight: 590})</span></li>
</ol>
<p>注意:此语句执行后,先查询 name 是’jingdong’的所有数据,然后将 name是’jingdong’的整个 document 都替换为{weight: 590}。 即 db.unicorns.insert({name: ‘jingdong’, dob: new Date(1979, 7, 18, 18, 44),loves:[‘apple’], weight: 575, gender: ‘m’, vampires: 99});整个替换为{weight: 590}，最后只剩一个{weight: 590}。 执行$set，不会替换原有数据，因此正确的更新方式如下：</p>
<p><strong>[cpp]</strong></p>
<ol>
<li><span style="font-size:14px;">db.unicorns.update({name: ‘jingdong’}, {$set: {weight: 590}})</span></li>
</ol>
<p><strong>[cpp]</strong></p>
<ol>
<li>db.unicorns.update({name: ‘Pilot’}, {$inc: {<span style="font-size:14px;">weight: 500</span>}})</li>
<li><p>$inc 增加或减少数字 如果原来为500之后会变为1000，因为500+500 = 1000</p>
</li>
<li><p>db.unicorns.update({name: ‘Aurora’}, {$push: {loves: ‘sugar’}})</p>
</li>
<li>$push 增加数组元素</li>
<li>$pop 减少数组元素</li>
</ol>
<p><strong>[cpp]</strong></p>
<ol>
<li>若存在则更新,否则添加</li>
<li>db.hits.update({page: ‘unicorns’}, {$inc: {hits: 1}}, true);</li>
<li>db.hits.find();</li>
<li>使用第三个参数设置是否 true(upset)</li>
<li>,默认是 false</li>
</ol>
<p><strong>[cpp]</strong></p>
<ol>
<li>#批量更新</li>
<li>db.unicorns.update({}, {$set: {vaccinated: true }});</li>
<li>db.unicorns.find({vaccinated: true});</li>
<li>不会将所有的数据的 vaccinated 都更新为 true</li>
<li>若将所有的数据的 vaccinated 都更新为 true,则如下:</li>
<li>db.unicorns.update({}, {$set: {vaccinated: true }}, false, true);</li>
<li>db.unicorns.find({vaccinated: true});</li>
</ol>
<p>ensureIndex 创建索引的方式 db.unicorns.ensureIndex({name: 1}) 删除索引的方式 db.unicorns.dropIndex({name: 1}) 创建独立索引 db.unicorns.ensureIndex({name: 1}, {unique: true}) 创建联合索引 db.unicorns.dropIndex({name: 1, vampires: -1}) 使用 web 获得 mongoDB 的信息 使用 <a href="http://localhost:28017/" target="_blank" rel="noopener">http://localhost:28017/</a> 获得 MongoDB 的信息。 数据备份和恢复 使用 mongodump备份数据库 mongodump 使用 mongorestore恢复数据库 mongorestore</p>
</blockquote>

            
            <p class="more">
                <a href="/2015/06/10/2019030500057/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2015/06/10/2019030500057/" title="MongoDB常用命令">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/0.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/NOSQL/">NOSQL</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2015/06/09/2019030500036/">
    		方法说---mac下安装homebrew与mongodb
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2015-06-09T06:03:41.000Z">2015-06-09</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/homebrew/" title="homebrew">homebrew</a> / 
    
        <a href="/tags/mac/" title="mac">mac</a> / 
    
        <a href="/tags/MongoDB/" title="MongoDB">MongoDB</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <blockquote>
<p>由于mac是类unix系统，unix下的神器基本都可以使用。 在mac中 homebrew 就类似于linux的 apt-get install  或 yum 等工具 ，一行命令完成你所需要的工具安装。 就两个字 简单！ 所以 尽管 打开你的 mac终端吧 然后去homebrew的官网 与 mongodb的官网粘贴几条命令搞定吧！</p>
<p><img src="http://img.blog.csdn.net/20150609133327030?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZmFudjIwMTE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt></p>
</blockquote>

            
            <p class="more">
                <a href="/2015/06/09/2019030500036/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2015/06/09/2019030500036/" title="方法说---mac下安装homebrew与mongodb">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/9.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    
        <!-- 文章列表 item -->
<article class="post">
    <header>
        <!-- 标签这有且只能显示一个 -->
        
        <a class="cat-link" href="/categories/NOSQL/">NOSQL</a>
        
        <!-- 文章标题 -->
        
    <h3 class="post-title">
    	<a href="/2015/05/25/2019030500054/">
    		MongoDB介绍和安装
    	</a>
    </h3>

    </header>
    <p class="post-meta">
        Jelon 发表于
        <time datetime="2015-05-25T06:54:32.000Z">2015-05-25</time>
        &nbsp;&nbsp;
        <span class="post-tags">
            标签：
            
    
        <a href="/tags/MongoDB/" title="MongoDB">MongoDB</a>
    

        </span>
    </p>

    <div class="post-content">
        <div class="post-excerpt">
            
                <blockquote>
<p>Mongo DB 是目前在IT行业非常流行的一种非关系型数据库(NoSql)，以灵活的数据存储方式受到当前IT从业人员的青睐。现在就简单介绍下Mongo DB、Mongo DB的安装、以及与关系型数据库的区别。</p>
<h1 id="简单介绍："><a href="#简单介绍：" class="headerlink" title="简单介绍："></a>简单介绍：</h1><p>Mongo DB的数据被分组存储在数据集中，称之为一个集合（Collenction)。每个 集合在数据库中都有一个唯一的标识名，并且可以包含无限数目的文档。集合的概念类似关系型数据库里的table，不同的是它不需要定义任何schema。 MongoDB使用BSON（Binary JSON）这种数据结构来存储数据和进行网络数据交换，BSON不仅支持更多更复杂的数据类型，还具有schema-free(模式自由)的特性，所以说，我们无需定义任何结构，就可以把完全不同结构的Document对象存储到一个数据库中。 Document对象，是以键-值对的形式存在。键用于唯一标识一个文档，字符串类型，而值则可以是各中复杂的文件类型，比如说，一句话，一个图片，一个数组，一个集合等。 在操作的时候，Mongo DB不需要我们手动编写SQL语句，采用Shell命令进行CRUD，Shell命令的操作语法跟JavaScript很相似，可以说控制台底层的查询语句就是用JavaScript脚本完成操作的。 MongoDB服务端可以运行在Linux、Windows等平台，支持32位和64位应用，默认端口为27017。</p>
<h1 id="MongoDB的安装："><a href="#MongoDB的安装：" class="headerlink" title="MongoDB的安装："></a>MongoDB的安装：</h1><pre><code>1）我用的是mongodb-win32-x86_64-2008plus-2.6.6.zip，将其解压，创建文件路径：E:\\Program files\\mongodb-2.6.6，解压后的文件拷贝到文件夹中。

2）在mongodb文件夹下建立data文件夹，路径：E:\\Program files\\mongodb\\data

3）在data文件夹中建立两个文件夹分别为db、log，路径：E:\\Program files\\mongodb\\data\\db，E:\\Program files\\mongodb\\data\\log

4）运行cmd.exe，进入DOS操作环境

       进入bin目录：

                ![](http://img.blog.csdn.net/20150525094014847?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZGFuZGFuem1j/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)

5）创建log文件

            命令：mongod --logpath &quot;E:\\Program files\\mongodb\\data\\log\\log.txt&quot;

               ![](http://img.blog.csdn.net/20150525094959520?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZGFuZGFuem1j/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)

          log文件夹下出现log.txt文件

      ![](http://img.blog.csdn.net/20150525094930900?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZGFuZGFuem1j/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)

 6）建立db文件

          命令如下：mongod -dbpath &quot;E:\\Program files\\mongodb\\data\\db&quot;
</code></pre><p><img src="http://img.blog.csdn.net/20150525094227072?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZGFuZGFuem1j/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt> 打出以下信息后，表示你安装已经成功了，此时可以进入shell操作了，db文件夹下自动产生如下文件夹：<img src="http://img.blog.csdn.net/20150525094412029?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZGFuZGFuem1j/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt> 再次运行一个cmd.exe，进入DOS环境，输入命令：mongo.exe，链接成功后，collections:0会自动改为collections:1，如下： <img src="http://img.blog.csdn.net/20150525100935700?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZGFuZGFuem1j/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt> 这样就可以进行Shell操作了。</p>
<h1 id="与关系型数据库的区别："><a href="#与关系型数据库的区别：" class="headerlink" title="与关系型数据库的区别："></a>与关系型数据库的区别：</h1><p><img src="http://img.blog.csdn.net/20150525101115047?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZGFuZGFuem1j/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt></p>
<h1 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h1><p>Mongo DB很好的实现了面向对象的思想(OO思想)，在Mongo DB中每一条记录都是一个Document对象。Mongo DB所有的数据持久操作都无需开发人员手动编写SQL语句，直接调用方法就可以轻松的实现CRUD操作。</p>
</blockquote>

            
            <p class="more">
                <a href="/2015/05/25/2019030500054/">阅读剩下更多</a>
            </p>
        </div>
        <div class="post-thumbnail" data-img>
            <a href="/2015/05/25/2019030500054/" title="MongoDB介绍和安装">
                
                    <img class="thumbnail" src="/img/default.png" data-echo="/img/thumbnail/5.jpg" alt="默认配图">
                
            </a>
        </div>
    </div>
</article>

    

    
    <nav class="page-navigator">
        <span class="page-number current">1</span>
    </nav>
    


            </div>

        </section>
        <!-- 侧栏部分 -->
<aside class="sidebar">
    <section class="widget">
        <h3 class="widget-hd"><strong>文章分类</strong></h3>
        <!-- 文章分类 -->
<ul class="widget-bd">
    
    <li>
        <a href="/categories/MySQL/">MySQL</a>
        <span class="badge">(92)</span>
    </li>
    
    <li>
        <a href="/categories/开发语言/">开发语言</a>
        <span class="badge">(7)</span>
    </li>
    
    <li>
        <a href="/categories/Oracle/">Oracle</a>
        <span class="badge">(40)</span>
    </li>
    
    <li>
        <a href="/categories/NOSQL/">NOSQL</a>
        <span class="badge">(17)</span>
    </li>
    
    <li>
        <a href="/categories/SQL-Server/">SQL Server</a>
        <span class="badge">(13)</span>
    </li>
    
    <li>
        <a href="/categories/其他数据库/">其他数据库</a>
        <span class="badge">(4)</span>
    </li>
    
    <li>
        <a href="/categories/MySQL/Oracle/">Oracle</a>
        <span class="badge">(3)</span>
    </li>
    
    <li>
        <a href="/categories/MySQL/Oracle/SQL-Server/">SQL Server</a>
        <span class="badge">(1)</span>
    </li>
    
    <li>
        <a href="/categories/NOSQL/开发语言/">开发语言</a>
        <span class="badge">(1)</span>
    </li>
    
</ul>
    </section>

    
    <section class="widget">
        <h3 class="widget-hd"><strong>热门标签</strong></h3>
        <!-- 文章标签 -->
<div class="widget-bd tag-wrap">
  
    <a class="tag-item" href="/tags/MySQL/" title="MySQL">MySQL (71)</a>
  
    <a class="tag-item" href="/tags/位运算/" title="位运算">位运算 (0)</a>
  
    <a class="tag-item" href="/tags/allow/" title="allow">allow (1)</a>
  
    <a class="tag-item" href="/tags/Apache/" title="Apache">Apache (1)</a>
  
    <a class="tag-item" href="/tags/deny/" title="deny">deny (1)</a>
  
    <a class="tag-item" href="/tags/sqlplus/" title="sqlplus">sqlplus (1)</a>
  
    <a class="tag-item" href="/tags/CentOS/" title="CentOS">CentOS (2)</a>
  
    <a class="tag-item" href="/tags/druid/" title="druid">druid (1)</a>
  
    <a class="tag-item" href="/tags/心跳/" title="心跳">心跳 (1)</a>
  
    <a class="tag-item" href="/tags/redis/" title="redis">redis (6)</a>
  
    <a class="tag-item" href="/tags/分库/" title="分库">分库 (1)</a>
  
    <a class="tag-item" href="/tags/分库分表/" title="分库分表">分库分表 (1)</a>
  
    <a class="tag-item" href="/tags/分表/" title="分表">分表 (1)</a>
  
    <a class="tag-item" href="/tags/Oracle/" title="Oracle">Oracle (30)</a>
  
    <a class="tag-item" href="/tags/schedule-job/" title="schedule job">schedule job (1)</a>
  
    <a class="tag-item" href="/tags/事务/" title="事务">事务 (5)</a>
  
    <a class="tag-item" href="/tags/分布式/" title="分布式">分布式 (1)</a>
  
    <a class="tag-item" href="/tags/消息/" title="消息">消息 (1)</a>
  
    <a class="tag-item" href="/tags/KeepAlived/" title="KeepAlived">KeepAlived (1)</a>
  
    <a class="tag-item" href="/tags/数据库/" title="数据库">数据库 (7)</a>
  
    <a class="tag-item" href="/tags/结构同步/" title="结构同步">结构同步 (1)</a>
  
    <a class="tag-item" href="/tags/truncate/" title="truncate">truncate (1)</a>
  
    <a class="tag-item" href="/tags/FineReport/" title="FineReport">FineReport (1)</a>
  
    <a class="tag-item" href="/tags/SQL/" title="SQL">SQL (17)</a>
  
    <a class="tag-item" href="/tags/报表/" title="报表">报表 (1)</a>
  
    <a class="tag-item" href="/tags/数据集/" title="数据集">数据集 (1)</a>
  
    <a class="tag-item" href="/tags/Excel/" title="Excel">Excel (1)</a>
  
    <a class="tag-item" href="/tags/Sqlite/" title="Sqlite">Sqlite (1)</a>
  
    <a class="tag-item" href="/tags/批量/" title="批量">批量 (1)</a>
  
    <a class="tag-item" href="/tags/Linux/" title="Linux">Linux (2)</a>
  
    <a class="tag-item" href="/tags/Character-set/" title="Character set">Character set (1)</a>
  
    <a class="tag-item" href="/tags/NLS-LANG/" title="NLS_LANG">NLS_LANG (1)</a>
  
    <a class="tag-item" href="/tags/rowid/" title="rowid">rowid (2)</a>
  
    <a class="tag-item" href="/tags/重复/" title="重复">重复 (1)</a>
  
    <a class="tag-item" href="/tags/Hash索引/" title="Hash索引">Hash索引 (1)</a>
  
    <a class="tag-item" href="/tags/InnoDB/" title="InnoDB">InnoDB (3)</a>
  
    <a class="tag-item" href="/tags/MyISAM/" title="MyISAM">MyISAM (3)</a>
  
    <a class="tag-item" href="/tags/索引优化/" title="索引优化">索引优化 (1)</a>
  
    <a class="tag-item" href="/tags/mysqldump/" title="mysqldump">mysqldump (2)</a>
  
</div>
    </section>
    

    

    
    <!-- 友情链接 -->
    <section class="widget">
        <h3 class="widget-hd"><strong>友情链接</strong></h3>
        <!-- 文章分类 -->
<ul class="widget-bd">
    
        <li>
            <a href="http://www.devba.com" target="_blank" title="软件开发吧">软件开发吧</a>
        </li>
    
        <li>
            <a href="https://www.sqlyun.cn" target="_blank" title="SQL云笔记">SQL云</a>
        </li>
    
</ul>
    </section>
    
</aside>
<!-- / 侧栏部分 -->
    </div>

    <!-- 博客底部 -->
    <footer class="footer">
    &copy;
    
        2016-2019
    

    <a href="/">Jelon Loves You</a>
</footer>
<div class="back-to-top" id="JELON__backToTop" title="返回顶部">返回顶部</div>

    <!--博客js脚本 -->
    <!-- 这里放网站js脚本 -->
<script src="/js/main.js"></script>
</body>
</html>